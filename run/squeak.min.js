"use strict";window.module=function(t){if(""==t)return window;var i=t.split("."),r=i.pop(),n=module(i.join(".")),e=n[r];return e||(n[r]=e={loaded:!1,pending:[],requires:function(t){return{toRun:function(r){function i(){r(),e.loaded=!0,e.pending.forEach(function(e){e()})}t&&!module(t).loaded?module(t).pending.push(i):i()}}}}),e},Object.extend=function(t){for(var e=1;e<arguments.length;e++)if("object"==typeof arguments[e])for(name in arguments[e])t[name]=arguments[e][name]},Function.prototype.subclass=function(n){var e=function(){return this.initialize&&this.initialize.apply(this,arguments),this},i=function(){};i.prototype=this.prototype,e.prototype=new i;for(var t=1;t<arguments.length;t++)Object.extend(e.prototype,arguments[t]);var r=n.split("."),s=r.pop();return module(r.join("."))[s]=e,e},function(){var e=document.getElementsByTagName("script"),t=e[e.length-1],i=t.src.replace(/[^\/]*$/,"");t.src.match(/squeak\.min\.js$/)||["vm.js","jit.js","plugins/ADPCMCodecPlugin.js","plugins/B2DPlugin.js","plugins/BitBltPlugin.js","plugins/FFTPlugin.js","plugins/FloatArrayPlugin.js","plugins/GeniePlugin.js","plugins/JPEGReaderPlugin.js","plugins/KedamaPlugin.js","plugins/KedamaPlugin2.js","plugins/Klatt.js","plugins/LargeIntegers.js","plugins/Matrix2x3Plugin.js","plugins/MiscPrimitivePlugin.js","plugins/ScratchPlugin.js","plugins/SoundGenerationPlugin.js","plugins/StarSqueakPlugin.js","plugins/ZipPlugin.js","lib/lz-string.js"].forEach(function(t){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",i+t),document.getElementsByTagName("head")[0].appendChild(e)})}(),module("SqueakJS").requires("users.bert.SqueakJS.vm").toRun(function(){function p(i,l,e){function a(r){i.fullscreen=r,t.style.background=r?"black":"",e.header&&(e.header.style.display=r?"none":""),e.footer&&(e.footer.style.display=r?"none":""),e.fullscreenCheckbox&&(e.fullscreenCheckbox.checked=r),setTimeout(window.onresize,0)}var t=l.parentElement,o="fullscreenchange",n="fullscreenElement",u="fullscreenEnabled";t.requestFullscreen||[{req:t.webkitRequestFullscreen,exit:document.webkitExitFullscreen,evt:"webkitfullscreenchange",elem:"webkitFullscreenElement",enable:"webkitFullscreenEnabled"},{req:t.mozRequestFullScreen,exit:document.mozCancelFullScreen,evt:"mozfullscreenchange",elem:"mozFullScreenElement",enable:"mozFullScreenEnabled"},{req:t.msRequestFullscreen,exit:document.msExitFullscreen,evt:"MSFullscreenChange",elem:"msFullscreenElement",enable:"msFullscreenEnabled"}].forEach(function(e){e.req&&(t.requestFullscreen=e.req,document.exitFullscreen=e.exit,o=e.evt,n=e.elem,u=e.enable)});var r;if(t.requestFullscreen)document.addEventListener(o,function(){a(t==document[n])}),r=function(){document[u]&&t==document[n]!=i.fullscreen&&(i.fullscreen?t.requestFullscreen():document.exitFullscreen())};else{var s=!1;r=function(){(e.header||e.footer)&&s!=i.fullscreen&&(s=i.fullscreen,a(s))}}return e.fullscreenCheckbox&&(e.fullscreenCheckbox.onclick=function(){i.fullscreen=e.fullscreenCheckbox.checked,r()}),r}function l(e){if(e.swapCheckbox){var i=localStorage.squeakImageName||"default",t=JSON.parse(localStorage["squeakSettings:"+i]||"{}");"swapButtons"in t&&(e.swapButtons=t.swapButtons),e.swapCheckbox.checked=e.swapButtons,e.swapCheckbox.onclick=function(){e.swapButtons=e.swapCheckbox.checked,t.swapButtons=e.swapButtons,localStorage["squeakSettings:"+i]=JSON.stringify(t)}}}function i(e,t){var i=(e.shiftKey?Squeak.Keyboard_Shift:0)+(e.ctrlKey?Squeak.Keyboard_Ctrl:0)+(e.altKey||e.metaKey?Squeak.Keyboard_Cmd:0);return t.buttons=t.buttons&~Squeak.Keyboard_All|i,i}function o(i,t,e){e.cursorCanvas.style.left=i.pageX+e.cursorOffsetX+"px",e.cursorCanvas.style.top=i.pageY+e.cursorOffsetY+"px";var r=(i.pageX-t.offsetLeft)*(t.width/t.offsetWidth)|0,n=(i.pageY-t.offsetTop)*(t.height/t.offsetHeight)|0;e.mouseX=Math.max(0,Math.min(e.width,r)),e.mouseY=Math.max(0,Math.min(e.height,n))}function e(n,r,a,e,s,u){if("touchend"!=n&&o(r,a,e),e.vm){var t=e.buttons&Squeak.Mouse_All;switch(n){case"mousedown":case"touchstart":switch(r.button||0){case 0:t=Squeak.Mouse_Red;break;case 1:t=Squeak.Mouse_Yellow;break;case 2:t=Squeak.Mouse_Blue}u.swapButtons&&(t==Squeak.Mouse_Yellow?t=Squeak.Mouse_Blue:t==Squeak.Mouse_Blue&&(t=Squeak.Mouse_Yellow));break;case"mousemove":case"touchmove":break;case"mouseup":case"touchend":t=0}e.buttons=t|i(r,e),s&&(s.push([Squeak.EventTypeMouse,r.timeStamp,e.mouseX,e.mouseY,e.buttons&Squeak.Mouse_All,e.buttons>>3]),e.signalInputEvent&&e.signalInputEvent()),e.idle=0,"mouseup"==n?e.runFor&&e.runFor(100):e.runNow&&e.runNow()}}function r(t,n,e,i){if(e.vm){var r=e.buttons>>3<<8|t;r===e.vm.interruptKeycode?e.vm.interruptPending=!0:i?(i.push([Squeak.EventTypeKeyboard,n,t,Squeak.EventKeyChar,e.buttons>>3,t]),e.signalInputEvent&&e.signalInputEvent()):e.keys.push(r),e.idle=0,e.runNow&&e.runNow()}}function n(r,t,n,e,i){e.vm&&i&&(o(t,n,e),i.push([Squeak.EventTypeDragDropFiles,t.timeStamp,r,e.mouseX,e.mouseY,e.buttons>>3,e.droppedFiles.length]),e.signalInputEvent&&e.signalInputEvent())}function u(t,i,e,n){e.buttons&=~Squeak.Keyboard_All,e.buttons|=Squeak.Keyboard_Cmd|Squeak.Keyboard_Ctrl,e.keys=[],r(t,i,e,n)}function m(e,i,r){i[0]=e[0],i[1]=e[1]-r&Squeak.MillisecondClockMask;for(var t=2;t<e.length;t++)i[t]=e[t]}function d(s,a){function c(t){for(var e=0;e<t.dataTransfer.types.length;e++)if("Files"==t.dataTransfer.types[e])return!0;return!1}a=a||{},a.fullscreen&&(document.body.style.margin=0,document.body.style.backgroundColor="black",a.header&&(a.header.style.display="none"),a.footer&&(a.footer.style.display="none")),a.pixelated&&s.classList.add("pixelated");var t={context:s.getContext("2d"),fullscreen:!1,width:0,height:0,mouseX:0,mouseY:0,buttons:0,keys:[],clipboardString:"",clipboardStringChanged:!1,cursorCanvas:document.createElement("canvas"),cursorOffsetX:0,cursorOffsetY:0,droppedFiles:[],signalInputEvent:null};l(a);var o=null;t.reset=function(){o=null,t.signalInputEvent=null,t.lastTick=0,t.getNextEvent=function(e,i){o=[],o.push=function(e){o.offset=Date.now()-e[1],delete o.push,o.push(e)},t.getNextEvent=function(e,i){var t=o.shift();t?m(t,e,i-o.offset):e[0]=Squeak.EventTypeNone},t.getNextEvent(e,i)}},t.reset();var f=p(t,s,a);return t.fullscreenRequest=function(e,i){t.fullscreen!=e?(t.fullscreen=e,t.resizeTodo=i,t.resizeTodoTimeout=setTimeout(t.resizeDone,1e3),f()):i()},t.resizeDone=function(){clearTimeout(t.resizeTodoTimeout);var e=t.resizeTodo;e&&(t.resizeTodo=null,e())},t.clear=function(){s.width=s.width},t.showBanner=function(r,i){i=i||{};var e=t.context;e.clearRect(0,0,s.width,s.height),e.fillStyle=i.color||"#F90",e.font=i.font||"bold 48px sans-serif",e.textAlign="center",e.textBaseline="middle",e.fillText(r,s.width/2,s.height/2)},t.showProgress=function(u,i){i=i||{};var e=t.context,r=s.width/3|0,n=24,a=.5*s.width-r/2,o=.5*s.height+2*n;e.fillStyle=i.background||"#000",e.fillRect(a,o,r,n),e.lineWidth=2,e.strokeStyle=i.color||"#F90",e.strokeRect(a,o,r,n),e.fillStyle=i.color||"#F90",e.fillRect(a,o,r*u,n)},s.onmousedown=function(i){return f(),e("mousedown",i,s,t,o,a),i.preventDefault(),!1},s.onmouseup=function(i){e("mouseup",i,s,t,o,a),f(),i.preventDefault()},s.onmousemove=function(i){e("mousemove",i,s,t,o,a),i.preventDefault()},s.oncontextmenu=function(){return!1},s.ontouchstart=function(i){i.touches[0].timeStamp=i.timeStamp,e("touchstart",i.touches[0],s,t,o,a),t.runNow&&t.runNow(),i.preventDefault()},s.ontouchmove=function(i){i.touches[0].timeStamp=i.timeStamp,e("touchmove",i.touches[0],s,t,o,a),t.runNow&&t.runNow(),i.preventDefault()},s.ontouchend=function(i){e("touchend",i,s,t,o,a),t.runNow&&t.runNow(),i.preventDefault()},s.ontouchcancel=function(e){s.ontouchend(e)},t.cursorCanvas.style.display="block",t.cursorCanvas.style.position="absolute",t.cursorCanvas.style.cursor="none",t.cursorCanvas.style.background="transparent",["onmousedown","onmouseup","onmousemove","oncontextmenu","ontouchstart","ontouchmove","ontouchend","ontouchcancel"].forEach(function(e){t.cursorCanvas[e]=s[e]}),s.parentElement.appendChild(t.cursorCanvas),s.style.cursor="none",document.onkeypress=function(e){return t.vm?/[CXVR]/.test(String.fromCharCode(e.charCode+64))?!0:(i(e,t),r(e.charCode,e.timeStamp,t,o),void e.preventDefault()):!0},document.onkeydown=function(e){if(f(),!t.vm)return!0;i(e,t);var s={8:8,9:9,13:13,27:27,33:11,34:12,35:4,36:1,37:28,38:30,39:29,40:31,45:5,46:127}[e.keyCode];if(s)return r(s,e.timeStamp,t,o),e.preventDefault();if(e.metaKey||e.altKey){var n=e.key;if(!n&&e.keyIdentifier&&"U+"==e.keyIdentifier.slice(0,2)&&(n=String.fromCharCode(parseInt(e.keyIdentifier.slice(2),16))),n&&1==n.length){if(/[CXVR]/i.test(n))return!0;var a=n.charCodeAt(0);return/[A-Z]/.test(n)&&!e.shiftKey&&(a+=32),r(a,e.timeStamp,t,o),e.preventDefault()}}},document.onkeyup=function(e){return t.vm?void i(e,t):!0},document.oncopy=function(e,i){if(!t.vm)return!0;t.clipboardStringChanged=!1,u((i||"c").charCodeAt(0),e.timeStamp,t,o);for(var r=Date.now();!t.clipboardStringChanged&&Date.now()-r<500;)t.vm.interpret(20);if(t.clipboardStringChanged){try{e.clipboardData.setData("Text",t.clipboardString)}catch(n){alert("copy error "+n)}e.preventDefault()}},document.oncut=function(e){return t.vm?void document.oncopy(e,"x"):!0},document.onpaste=function(e){if(!t.vm)return!0;try{t.clipboardString=e.clipboardData.getData("Text"),u("v".charCodeAt(0),e.timeStamp,t,o)}catch(i){alert("paste error "+i)}e.preventDefault()},document.body.ondragover=function(e){return e.preventDefault(),c(e)?(e.dataTransfer.dropEffect="copy",n(Squeak.EventDragMove,e,s,t,o),!1):e.dataTransfer.dropEffect="none"},document.body.ondragenter=function(e){c(e)&&n(Squeak.EventDragEnter,e,s,t,o)},document.body.ondragleave=function(e){c(e)&&n(Squeak.EventDragLeave,e,s,t,o)},document.body.ondrop=function(e){if(e.preventDefault(),!c(e))return!1;var i,u=[].slice.call(e.dataTransfer.files),l=[],r=null;return t.droppedFiles=[],u.forEach(function(c){t.droppedFiles.push(c.name);var f=new FileReader;f.onload=function(){var f=this.result;Squeak.filePut(c.name,f),l.push(c.name),i||!/.*image$/.test(c.name)||t.vm&&!confirm("Run "+c.name+" now?\n(cancel to use as file)")||(i=f,r=c.name),l.length==u.length&&(i?(SqueakJS.appName=r.slice(0,-6),SqueakJS.runImage(i,r,t,a)):n(Squeak.EventDragDrop,e,s,t,o))},f.readAsArrayBuffer(c)}),!1},window.onresize=function(){var m=window.innerWidth,f=window.innerHeight;if(setTimeout(function(){m==window.innerWidth&&f==window.innerHeight&&t.resizeDone()},300),!(a.header&&a.footer||a.fullscreen))return t.width=s.width,void(t.height=s.height);var u=a.fullscreen||t.fullscreen,h=0,c=u?0:a.header.offsetTop+a.header.offsetHeight,i=window.innerWidth,e=u?window.innerHeight:Math.max(100,a.footer.offsetTop-c),o=0,n=0;if(a.fixedWidth){t.width=a.fixedWidth,t.height=a.fixedHeight;var r=t.width/t.height,p=i/e;p>r?o=i-Math.floor(e*r):n=e-Math.floor(i/r)}else t.width=i,t.height=e;if(s.style.left=h+Math.floor(o/2)+"px",s.style.top=c+Math.floor(n/2)+"px",s.style.width=i-o+"px",s.style.height=e-n+"px",s.width!=t.width||s.height!=t.height){var d=a.fixedWidth||!t.resizeTodo,l=d&&t.context.getImageData(0,0,s.width,s.height);s.width=t.width,s.height=t.height,l&&t.context.putImageData(l,0,0)}},window.onresize(),t}function c(t,i){var e=i.spinner;return e?(e.onmousedown=function(e){confirm(SqueakJS.appName+" is busy. Interrupt?")&&(t.interruptPending=!0)},e.style):null}function f(e,r,i,n){var s=0===r,o=i.lastTick-n.lastTick<500;!s||o?(e.display="none",t=0):0===t?t=i.lastTick:i.lastTick-t>1e3&&(e.display="block",a=(a+30)%360,e.webkitTransform=e.transform="rotate("+a+"deg)")}function h(e){var u=window.location.hash.slice(1),r=u&&u.split("&");if(r)for(var n=0;n<r.length;n++){var s=r[n].split("="),l=s[0],t=!0;if(s.length>1&&(t=decodeURIComponent(s.slice(1).join("=")),t.match(/^(true|false|null|[0-9"[{].*)$/)))try{t=JSON.parse(t)}catch(c){"["===t[0]&&(t=t.slice(1,-1).split(","))}e[l]=t}var i=Squeak.splitFilePath(e.root||"/").fullname;if(Squeak.dirCreate(i,!0),/\/$/.test(i)||(i+="/"),e.root=i,e.url&&e.files&&!e.image&&(e.image=e.url+"/"+e.files[0]),e.templates){if(e.templates.constructor===Array){var o={};e.templates.forEach(function(e){o[e]=e}),e.templates=o}for(var a in e.templates)Squeak.fetchTemplateDir(e.root+a,e.templates[a])}}var s,a=0,t=0;SqueakJS.runImage=function(r,i,e,t){window.onbeforeunload=function(){return SqueakJS.appName+" is still running"},window.clearTimeout(s),e.reset(),e.clear(),e.showBanner("Loading "+SqueakJS.appName),e.showProgress(0);var n=this;window.setTimeout(function(){var a=new Squeak.Image(i);a.readFromBuffer(r,function(){function o(){try{e.quitFlag?n.onQuit(r,e,t):r.interpret(50,function(t){"sleep"==t&&(t=200),u&&f(u,t,r,e),s=window.setTimeout(o,t)})}catch(i){console.error(i),alert(i)}}e.quitFlag=!1;var r=new Squeak.Interpreter(a,e);SqueakJS.vm=r,localStorage.squeakImageName=i,l(t),e.clear(),e.showBanner("Starting "+SqueakJS.appName);var u=c(r,t);e.runNow=function(){window.clearTimeout(s),o()},e.runFor=function(t){var i=Date.now()+t;do e.runNow();while(Date.now()<i)},o()},function(t){e.showProgress(t)})},0)},SqueakJS.runSqueak=function(t,u,e){function i(u){if(0===n.length)return u(a);var t=n.shift(),l=e.forceDownload||t.forceDownload;if(!l&&Squeak.fileExists(e.root+t.name))return void(t.name==r?Squeak.fileGet(e.root+t.name,function(e){a=e,i(u)},function(){Squeak.fileDelete(e.root+t.name),n.unshift(t),i(u)}):i(u));s.showBanner("Downloading "+t.name);var o=new XMLHttpRequest;o.open("GET",t.url),o.responseType="arraybuffer",o.onprogress=function(e){e.lengthComputable&&s.showProgress(e.loaded/e.total)},o.onload=function(n){200==o.status?(t.name==r&&(a=o.response),Squeak.filePut(e.root+t.name,o.response,function(){i(u)})):o.onerror(o.statusText)},o.onerror=function(e){alert("Failed to download:\n"+t.url)},o.send()}h(e),e.image?t=e.image:e.image=t,SqueakJS.options=e,SqueakJS.appName=e.appName||t.replace(/.*\//,"").replace(/\.image$/,""),Squeak.fsck();var s=d(u,e),r=Squeak.splitFilePath(t).basename,a=null,l=t.replace(/[^\/]*$/,""),n=[{url:t,name:r}];if(e.files&&e.files.forEach(function(e){e!==r&&n.push({url:l+e,name:e})}),e.document){var o=Squeak.splitFilePath(e.document).basename;n.push({url:e.document,name:o,forceDownload:!0}),s.documentName=e.root+o}i(function(t){SqueakJS.runImage(t,e.root+r,s,e)})},SqueakJS.quitSqueak=function(){SqueakJS.vm.quitFlag=!0},SqueakJS.onQuit=function(i,t,e){window.onbeforeunload=null,t.vm=null,e.spinner&&(e.spinner.style.display="none"),e.onQuit?e.onQuit(i,t,e):t.showBanner(SqueakJS.appName+" stopped.")}}),window.applicationCache&&applicationCache.addEventListener("updateready",function(){var e=window.SqueakJS&&SqueakJS.options&&SqueakJS.options.appName||"SqueakJS";confirm(e+" has been updated. Restart now?")&&(window.onbeforeunload=null,window.location.reload())}),module("users.bert.SqueakJS.vm").requires().toRun(function(){window.Squeak=users.bert.SqueakJS.vm,Object.extend(Squeak,"version",{vmVersion:"SqueakJS 0.7.9",vmBuild:"unknown",vmPath:"/",vmFile:"vm.js",platformName:"Web",platformSubtype:"unknown",osVersion:navigator.userAgent,windowSystem:"HTML"},"object header",{HeaderTypeMask:3,HeaderTypeSizeAndClass:0,HeaderTypeClass:1,HeaderTypeFree:2,HeaderTypeShort:3},"special objects",{splOb_NilObject:0,splOb_FalseObject:1,splOb_TrueObject:2,splOb_SchedulerAssociation:3,splOb_ClassBitmap:4,splOb_ClassInteger:5,splOb_ClassString:6,splOb_ClassArray:7,splOb_SmalltalkDictionary:8,splOb_ClassFloat:9,splOb_ClassMethodContext:10,splOb_ClassBlockContext:11,splOb_ClassPoint:12,splOb_ClassLargePositiveInteger:13,splOb_TheDisplay:14,splOb_ClassMessage:15,splOb_ClassCompiledMethod:16,splOb_TheLowSpaceSemaphore:17,splOb_ClassSemaphore:18,splOb_ClassCharacter:19,splOb_SelectorDoesNotUnderstand:20,splOb_SelectorCannotReturn:21,splOb_TheInputSemaphore:22,splOb_SpecialSelectors:23,splOb_CharacterTable:24,splOb_SelectorMustBeBoolean:25,splOb_ClassByteArray:26,splOb_ClassProcess:27,splOb_CompactClasses:28,splOb_TheTimerSemaphore:29,splOb_TheInterruptSemaphore:30,splOb_FloatProto:31,splOb_SelectorCannotInterpret:34,splOb_MethodContextProto:35,splOb_ClassBlockClosure:36,splOb_BlockContextProto:37,splOb_ExternalObjectsArray:38,splOb_ClassPseudoContext:39,splOb_ClassTranslatedMethod:40,splOb_TheFinalizationSemaphore:41,splOb_ClassLargeNegativeInteger:42,splOb_ClassExternalAddress:43,splOb_ClassExternalStructure:44,splOb_ClassExternalData:45,splOb_ClassExternalFunction:46,splOb_ClassExternalLibrary:47,splOb_SelectorAboutToReturn:48,splOb_SelectorRunWithIn:49,splOb_SelectorAttemptToAssign:50,splOb_PrimErrTableIndex:51,splOb_ClassAlien:52,splOb_InvokeCallbackSelector:53,splOb_ClassUnsafeAlien:54,splOb_ClassWeakFinalizer:55},"known classes",{Class_superclass:0,Class_mdict:1,Class_format:2,Class_instVars:null,Class_name:6,Context_sender:0,Context_instructionPointer:1,Context_stackPointer:2,Context_method:3,Context_closure:4,Context_receiver:5,Context_tempFrameStart:6,Context_smallFrameSize:17,Context_largeFrameSize:57,BlockContext_caller:0,BlockContext_argumentCount:3,BlockContext_initialIP:4,BlockContext_home:5,Closure_outerContext:0,Closure_startpc:1,Closure_numArgs:2,Closure_firstCopiedValue:3,Stream_array:0,Stream_position:1,Stream_limit:2,ProcSched_processLists:0,ProcSched_activeProcess:1,Link_nextLink:0,LinkedList_firstLink:0,LinkedList_lastLink:1,Semaphore_excessSignals:2,Proc_suspendedContext:1,Proc_priority:2,Proc_myList:3,Assn_key:0,Assn_value:1,MethodDict_array:1,MethodDict_selectorStart:2,Message_selector:0,Message_arguments:1,Message_lookupClass:2,Point_x:0,Point_y:1,LargeInteger_bytes:0,LargeInteger_neg:1,BitBlt_dest:0,BitBlt_source:1,BitBlt_halftone:2,BitBlt_combinationRule:3,BitBlt_destX:4,BitBlt_destY:5,BitBlt_width:6,BitBlt_height:7,BitBlt_sourceX:8,BitBlt_sourceY:9,BitBlt_clipX:10,BitBlt_clipY:11,BitBlt_clipW:12,BitBlt_clipH:13,BitBlt_colorMap:14,BitBlt_warpBase:15,Form_bits:0,Form_width:1,Form_height:2,Form_depth:3,Form_offset:4,WeakFinalizationList_first:0,WeakFinalizerItem_list:0,WeakFinalizerItem_next:1},"events",{Mouse_Blue:1,Mouse_Yellow:2,Mouse_Red:4,Keyboard_Shift:8,Keyboard_Ctrl:16,Keyboard_Alt:32,Keyboard_Cmd:64,Mouse_All:7,Keyboard_All:120,EventTypeNone:0,EventTypeMouse:1,EventTypeKeyboard:2,EventTypeDragDropFiles:3,EventKeyChar:0,EventKeyDown:1,EventKeyUp:2,EventDragEnter:1,EventDragMove:2,EventDragLeave:3,EventDragDrop:4},"constants",{MinSmallInt:-1073741824,MaxSmallInt:1073741823,NonSmallInt:-1342177280,MillisecondClockMask:536870911},"modules",{externalModules:Squeak.externalModules||{},registerExternalModule:function(e,t){this.externalModules[e]=t}},"files",{fsck:function(o,n,t,e){if(n=n||"",e=e||{dirs:0,files:0,bytes:0,deleted:0},!t){t={};for(var h in localStorage){var l=h.match(/squeak-file(\.lz)?:(.*)$/);l&&(t[l[2]]=!0)}if("undefined"!=typeof indexedDB)return this.dbTransaction("readonly","fsck cursor",function(r){var i=r.openCursor();i.onsuccess=function(r){var i=r.target.result;i?(t[i.key]=!0,i["continue"]()):Squeak.fsck(o,n,t,e)},i.onerror=function(e){console.error("fsck failed")}})}var a=Squeak.dirList(n);for(var u in a){var i=n+"/"+u,c=a[u][3];if(c){var f="squeak:"+i in localStorage;f?(Squeak.fsck(null,i,t,e),e.dirs++):(console.log("Deleting stale directory "+i),Squeak.dirDelete(i),e.deleted++)}else t[i]?(t[i]=!1,e.files++,e.bytes+=a[u][4]):(console.log("Deleting stale file entry "+i),Squeak.fileDelete(i,!0),e.deleted++)}if(""===n){console.log("squeak fsck: "+e.dirs+" directories, "+e.files+" files, "+(e.bytes/1e6).toFixed(1)+" MBytes");var r=[],p=0;for(var i in t)p++,t[i]&&r.push(i);if(r.length>0){for(var s=0;s<r.length;s++)console.log("Deleting orphaned file "+r[s]),delete localStorage["squeak-file:"+r[s]],delete localStorage["squeak-file.lz:"+r[s]],e.deleted++;"undefined"!=typeof indexedDB&&this.dbTransaction("readwrite","fsck delete",function(t){for(var e=0;e<r.length;e++)t["delete"](r[e])})}o&&o(e)}},dbTransaction:function(a,r,i,e){function n(){i(Squeak.dbFake()),e&&e()}if("undefined"==typeof indexedDB||null==indexedDB)return n();var s=function(){var t=SqueakDB.transaction("files",a),n=t.objectStore("files");t.oncomplete=function(t){e&&e()},t.onerror=function(e){console.error(e.target.error.name+": "+r)},t.onabort=function(t){console.error(t.target.error.name+": aborting "+r),i(Squeak.dbFake()),e&&e()},i(n)};if(window.SqueakDB)return s();var t=indexedDB.open("squeak");t.onsuccess=function(e){console.log("Opened files database."),window.SqueakDB=this.result,SqueakDB.onversionchange=function(e){delete window.SqueakDB,this.close()},SqueakDB.onerror=function(e){console.error("Error accessing database: "+e.target.error.name)},s()},t.onupgradeneeded=function(e){console.log("Creating files database");var t=e.target.result;t.createObjectStore("files")},t.onerror=function(e){console.error(e.target.error.name+": cannot open files database"),console.warn("Falling back to local storage"),n()},t.onblocked=function(e){alert("Database upgrade needed. Please close all other tabs with this site open!")}},dbFake:function(){return"undefined"==typeof SqueakDBFake&&("undefined"==typeof indexedDB&&console.warn("IndexedDB not supported by this browser, using localStorage"),window.SqueakDBFake={bigFiles:{},bigFileThreshold:1e5,get:function(r){var t=SqueakDBFake.bigFiles[r];if(!t){var i=localStorage["squeak-file:"+r];if(!i){var a=localStorage["squeak-file.lz:"+r];a&&("object"==typeof LZString?i=LZString.decompressFromUTF16(a):console.error("LZString not loaded: cannot decompress "+r))}if(i){for(var s=new Uint8Array(i.length),n=0;n<s.length;n++)s[n]=255&i.charCodeAt(n);t=s.buffer}}var e={result:t,error:"file not found"};return setTimeout(function(){t&&e.onsuccess&&e.onsuccess({target:e}),!t&&e.onerror&&e.onerror({target:e})},0),e},put:function(t,e){if(t.byteLength>SqueakDBFake.bigFileThreshold)SqueakDBFake.bigFiles[e]||console.log("File "+e+" ("+t.byteLength+" bytes) too large, storing in memory only"),SqueakDBFake.bigFiles[e]=t;else{var r=Squeak.bytesAsString(new Uint8Array(t));if("object"==typeof LZString){var n=LZString.compressToUTF16(r);localStorage["squeak-file.lz:"+e]=n,delete localStorage["squeak-file:"+e]}else localStorage["squeak-file:"+e]=r}var i={};return setTimeout(function(){i.onsuccess&&i.onsuccess()},0),i},"delete":function(e){delete localStorage["squeak-file:"+e],delete localStorage["squeak-file.lz:"+e],delete SqueakDBFake.bigFiles[e];var t={};return setTimeout(function(){t.onsuccess&&t.onsuccess()},0),t},openCursor:function(){var e={};return setTimeout(function(){e.onsuccess&&e.onsuccess({target:e})},0),e}}),SqueakDBFake},fileGet:function(r,i,t){t||(t=function(e){console.log(e)});var e=this.splitFilePath(r);return e.basename?window.SqueakDBFake&&SqueakDBFake.bigFiles[e.fullname]?i(SqueakDBFake.bigFiles[e.fullname]):void this.dbTransaction("readonly","get "+r,function(n){var r=n.get(e.fullname);r.onerror=function(e){t(e.target.error.name)},r.onsuccess=function(r){return void 0!==this.result?i(this.result):void Squeak.fetchTemplateFile(e.fullname,function(e){i(e)},function(){if("undefined"==typeof indexedDB)return t("file not found: "+e.fullname);var r=Squeak.dbFake().get(e.fullname);r.onerror=function(i){t("file not found: "+e.fullname)},r.onsuccess=function(e){i(this.result)}})}}):t("Invalid path: "+r)},filePut:function(n,r,s){var e=this.splitFilePath(n);if(!e.basename)return null;var i=this.dirList(e.dirname);if(!i)return null;var t=i[e.basename],a=this.totalSeconds();if(t){if(t[3])return null}else t=[e.basename,a,0,!1,0],i[e.basename]=t;return t[2]=a,t[4]=r.byteLength||r.length||0,localStorage["squeak:"+e.dirname]=JSON.stringify(i),this.dbTransaction("readwrite","put "+n,function(t){t.put(r,e.fullname)},function(){s&&s()}),t},fileDelete:function(i,n){var e=this.splitFilePath(i);if(!e.basename)return!1;var t=this.dirList(e.dirname);if(!t)return!1;var r=t[e.basename];return!r||r[3]?!1:(delete t[e.basename],localStorage["squeak:"+e.dirname]=JSON.stringify(t),n?!0:(this.dbTransaction("readwrite","delete "+i,function(t){t["delete"](e.fullname)}),!0))},fileRename:function(a,o){var e=this.splitFilePath(a);if(!e.basename)return!1;var t=this.splitFilePath(o);if(!t.basename)return!1;var i=this.dirList(e.dirname);if(!i)return!1;var r=i[e.basename];if(!r||r[3])return!1;var s=e.dirname==t.dirname,n=s?i:this.dirList(t.dirname);return n?n[t.basename]?!1:(delete i[e.basename],r[0]=t.basename,n[t.basename]=r,localStorage["squeak:"+t.dirname]=JSON.stringify(n),s||(localStorage["squeak:"+e.dirname]=JSON.stringify(i)),this.fileGet(e.fullname,function(i){this.dbTransaction("readwrite","rename "+e.fullname+" to "+t.fullname,function(r){r["delete"](e.fullname),r.put(i,t.fullname)})}.bind(this),function(e){console.log("File rename failed: "+e)}.bind(this)),!0):!1},fileExists:function(r){var e=this.splitFilePath(r);if(!e.basename)return!1;var t=this.dirList(e.dirname);if(!t)return!1;var i=t[e.basename];return!i||i[3]?!1:!0},dirCreate:function(r,n){var e=this.splitFilePath(r);if(!e.basename)return!1;n&&!localStorage["squeak:"+e.dirname]&&Squeak.dirCreate(e.dirname,!0);var t=this.dirList(e.dirname);if(!t)return!1;if(t[e.basename])return!1;var i=this.totalSeconds(),s=[e.basename,i,i,!0,0];return t[e.basename]=s,localStorage["squeak:"+e.fullname]=JSON.stringify({}),localStorage["squeak:"+e.dirname]=JSON.stringify(t),!0},dirDelete:function(r){var e=this.splitFilePath(r);if(!e.basename)return!1;var t=this.dirList(e.dirname);if(!t)return!1;if(!t[e.basename])return!1;var i=this.dirList(e.fullname);if(!i)return!1;for(var n in i)return!1;return delete t[e.basename],localStorage["squeak:"+e.dirname]=JSON.stringify(t),delete localStorage["squeak:"+e.fullname],!0},dirList:function(s,a){function n(r,e){for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];r[i[0]]=i}}var e=this.splitFilePath(s),t=localStorage["squeak:"+e.fullname],i=a&&localStorage["squeak-template:"+e.fullname];if(t||i){var r={};return i&&n(r,JSON.parse(i).entries),t&&n(r,JSON.parse(t)),r}return"/"==e.fullname?{}:null},splitFilePath:function(e){"/"!==e[0]&&(e="/"+e),e=e.replace(/\/\//gi,"/");var t=e.match(/(.*)\/(.*)/),i=t[1].length?t[1]:"/",r=t[2].length?t[2]:null;return{fullname:e,dirname:i,basename:r}},flushFile:function(e){if(e.modified){var t=e.contents.buffer;t.byteLength!==e.size&&(t=new ArrayBuffer(e.size),new Uint8Array(t).set(e.contents.subarray(0,e.size))),Squeak.filePut(e.name,t),e.modified=!1}},flushAllFiles:function(){if("undefined"!=typeof SqueakFiles)for(var e in SqueakFiles)this.flushFile(SqueakFiles[e])},closeAllFiles:function(){Squeak.flushAllFiles(),delete window.SqueakFiles},fetchTemplateDir:function(e,i){function r(t){var e=Squeak.splitFilePath(t);"/"!==e.dirname&&r(e.dirname);var t=JSON.parse(localStorage["squeak-template:"+e.dirname]||'{"entries": {}}');if(!t.entries[e.basename]){var i=Squeak.totalSeconds();t.entries[e.basename]=[e.basename,i,i,!0,0],localStorage["squeak-template:"+e.dirname]=JSON.stringify(t)}}function n(e,t){var i=JSON.parse(localStorage["squeak-template:"+e]);i.entries.forEach(function(i){i[3]&&Squeak.fetchTemplateDir(e+"/"+i[0],t+"/"+i[0])})}if(e=Squeak.splitFilePath(e).fullname,localStorage["squeak-template:"+e])n(e,i);else{var s=i+"/sqindex.json",t=new XMLHttpRequest;t.open("GET",s,!0),t.onload=function(s){200==t.status?(console.log("adding template "+e),r(e),localStorage["squeak-template:"+e]='{"url": '+JSON.stringify(i)+', "entries": '+t.response+"}",n(e,i)):t.onerror(t.statusText)},t.onerror=function(e){console.log("cannot load template index "+s)},t.send()}},fetchTemplateFile:function(e,s,r){e=Squeak.splitFilePath(e);var n=localStorage["squeak-template:"+e.dirname];if(!n)return r();var t=JSON.parse(n).url;if(!t)return r();t+="/"+e.basename;var i=new XMLHttpRequest;i.open("get",t,!0),i.responseType="arraybuffer",i.timeout=3e4,i.onreadystatechange=function(){if(this.readyState==this.DONE)if(200==this.status){var i=this.response;console.log("Got "+i.byteLength+" bytes from "+t),Squeak.dirCreate(e.dirname,!0),Squeak.filePut(e.fullname,i),s(i)}else alert("Download failed ("+this.status+") "+t),r()},console.log("Fetching "+t),i.send()}},"audio",{startAudioOut:function(){if(!this.audioOutContext){var e=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;this.audioOutContext=e&&new e}return this.audioOutContext},startAudioIn:function(e,t){return this.audioInContext?(this.audioInSource.disconnect(),e(this.audioInContext,this.audioInSource)):(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia?void navigator.getUserMedia({audio:!0,toString:function(){return"audio"}},function(i){var t=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;this.audioInContext=t&&new t,this.audioInSource=this.audioInContext.createMediaStreamSource(i),e(this.audioInContext,this.audioInSource)},function(){t("cannot access microphone")}):t("test: audio input not supported"))},stopAudio:function(){this.audioInSource&&this.audioInSource.disconnect()}},"time",{Epoch:Date.UTC(1901,0,1)+6e4*(new Date).getTimezoneOffset(),EpochUTC:Date.UTC(1901,0,1),totalSeconds:function(){return Math.floor((Date.now()-Squeak.Epoch)/1e3)}},"utils",{bytesAsString:function(t){for(var i=[],e=0;e<t.length;e++)i.push(String.fromCharCode(t[e]));return i.join("")}}),Object.subclass("Squeak.Image","about",{about:function(){}},"initializing",{initialize:function(e){this.totalMemory=1e8,this.name=e,this.gcCount=0,this.gcTenured=0,this.gcMilliseconds=0,this.allocationCount=0,this.oldSpaceCount=0,this.newSpaceCount=0,this.hasNewInstances={}},readFromBuffer:function(m,d,v){function A(){if(c){for(var e=f+(n.oldSpaceCount/10|0);c&&e>f;)c.installFromImage(s,j,x,o,M),c=c.nextObject,f++;return v&&v(f/n.oldSpaceCount),!0}return n.specialObjectsArray=k,n.decorateKnownObjects(),n.fixCompiledMethods(),n.fixCompactOops(),!1}function I(){A()?window.setTimeout(I,0):d&&d()}console.log("squeak: reading "+this.name+" ("+m.byteLength+" bytes)"),this.startupTime=Date.now();for(var V=new DataView(m),o=!1,i=0,e=function(){var e=V.getUint32(i,o);return i+=4,e},w=function(t,n){if(5>n){for(var r=[];r.length<t;)r.push(e());return r}var s=new Uint32Array(m,i,t);return i+=4*t,s},P=[6501,6502,6504,6505,68e3,68002,68003],r=0,h=0;;){if(o=!o,i=h,r=e(),P.indexOf(r)>=0)break;if(o||(h+=512),h>512)throw Error("bad image version")}this.version=r;var M=[6505,68003].indexOf(r)>=0;if(this.hasClosures=[6504,6505,68002,68003].indexOf(r)>=0,r>=68e3)throw Error("64 bit images not supported yet");var y=e(),O=e(),g=e(),q=e();this.lastHash=e();e(),e(),e();i+=y-36;for(var p,s={},b=h+y;b+O>i;){var l=0,u=0,t=e();switch(t&Squeak.HeaderTypeMask){case Squeak.HeaderTypeSizeAndClass:l=t>>2,u=e(),t=e();break;case Squeak.HeaderTypeClass:u=t-Squeak.HeaderTypeClass,t=e(),l=t>>2&63;break;case Squeak.HeaderTypeShort:l=t>>2&63,u=t>>12&31;break;case Squeak.HeaderTypeFree:throw Error("Unexpected free block")}l--;var S=i-4-b,F=t>>8&15,B=t>>17&4095,C=w(l,F),a=new Squeak.Object;a.initFromImage(S,u,F,B,C),32>u&&(a.hash|=268435456),p&&(p.nextObject=a),this.oldSpaceCount++,p=a,s[g+S]=a}this.firstOldObject=s[g+4],this.lastOldObject=p,this.oldSpaceBytes=O;var k=s[q],j=s[k.bits[Squeak.splOb_CompactClasses]].bits,x=s[k.bits[Squeak.splOb_ClassFloat]],c=this.firstOldObject,f=0,n=this;if(v)window.setTimeout(I,0);else{for(;A(););d&&d()}},decorateKnownObjects:function(){var e=this.specialObjectsArray.pointers;e[Squeak.splOb_NilObject].isNil=!0,e[Squeak.splOb_TrueObject].isTrue=!0,e[Squeak.splOb_FalseObject].isFalse=!0,e[Squeak.splOb_ClassFloat].isFloatClass=!0,this.compactClasses=this.specialObjectsArray.pointers[Squeak.splOb_CompactClasses].pointers;for(var t=0;t<this.compactClasses.length;t++)this.compactClasses[t].isNil||(this.compactClasses[t].isCompact=!0);Number.prototype.sqInstName||Object.defineProperty(Number.prototype,"sqInstName",{enumerable:!1,value:function(){return this.toString()}})},fixCompactOops:function(){for(var e=this.firstOldObject,t=0;e;){var i=e.hash>268435455,n=!!e.sqClass.isCompact;if(i!==n){var r=0===e.snapshotSize().header;
i!==r&&(t+=r?-4:4)}e.hash&=268435455,e.oop+=t,e=e.nextObject}this.oldSpaceBytes+=t},fixCompiledMethods:function(){if(!(this.version>=6502))for(var e=this.firstOldObject,t=this.specialObjectsArray.pointers[Squeak.splOb_ClassCompiledMethod];e;)e.format>=12&&(e.sqClass=t),e=e.nextObject}},"garbage collection",{partialGC:function(){return this.totalMemory-this.oldSpaceBytes},fullGC:function(t){this.vm.addMessage("fullGC: "+t);var i=Date.now(),e=this.markReachableObjects();return this.removeUnmarkedOldObjects(),this.appendToOldObjects(e),this.finalizeWeakReferences(),this.allocationCount+=this.newSpaceCount,this.newSpaceCount=0,this.hasNewInstances={},this.gcCount++,this.gcMilliseconds+=Date.now()-i,e.length>0?e[0]:null},markReachableObjects:function(){this.vm.storeContextRegisters();for(var r=[this.specialObjectsArray,this.vm.activeContext],s=[];r.length>0;){var e=r.pop();if(!e.mark){e.nextObject||e===this.lastOldObject||s.push(e),e.mark=!0,e.sqClass.mark||r.push(e.sqClass);var i=e.pointers;if(i){var n=i.length;if(this.vm.isContext(e)){n=e.contextSizeWithStack();for(var t=n;t<i.length;t++)i[t]=this.vm.nilObj}else e.sqClass.isWeak()&&(n=e.sqClass.classInstSize());for(var t=0;n>t;t++)"object"!=typeof i[t]||i[t].mark||r.push(i[t])}}}return s.sort(function(e,t){return t.oop-e.oop})},removeUnmarkedOldObjects:function(){var n=0,i=0,e=this.firstOldObject;for(e.mark=!1;;){var t=e.nextObject;if(!t)return this.lastOldObject=e,this.oldSpaceBytes-=i,void(this.oldSpaceCount-=n);if(t.mark)e=t,e.mark=!1,e.oop-=i;else{var r=t;e.nextObject=r.nextObject,r.oop=-++this.newSpaceCount,i+=r.totalBytes(),n++}}},appendToOldObjects:function(e){for(var i=this.lastOldObject,r=0;r<e.length;r++){var t=e[r];t.mark=!1,this.oldSpaceBytes=t.setAddr(this.oldSpaceBytes),i.nextObject=t,i=t}this.lastOldObject=i,this.oldSpaceCount+=e.length,this.gcTenured+=e.length},finalizeWeakReferences:function(){for(var e=this.firstOldObject;e;){if(e.sqClass.isWeak()){for(var i=e.pointers||[],n=e.sqClass.classInstSize(),s=!1,t=n;t<i.length;t++)i[t].oop<0&&(i[t]=this.vm.nilObj,s=!0);if(s&&(this.vm.pendingFinalizationSignals++,n>=2)){var r=e.pointers[Squeak.WeakFinalizerItem_list];if(r.sqClass==this.vm.specialObjects[Squeak.splOb_ClassWeakFinalizer]){var a=r.pointers[Squeak.WeakFinalizationList_first];e.pointers[Squeak.WeakFinalizerItem_next]=a,r.pointers[Squeak.WeakFinalizationList_first]=e}}}e=e.nextObject}this.vm.pendingFinalizationSignals>0&&this.vm.forceInterruptCheck()}},"creating",{registerObject:function(e){return e.oop=-++this.newSpaceCount,this.lastHash=13849+27181*this.lastHash&4294967295,4095&this.lastHash},instantiateClass:function(t,i,r){var e=new Squeak.Object,n=this.registerObject(e);return e.initInstanceOf(t,i,n,r),this.hasNewInstances[t.oop]=!0,e},clone:function(t){var e=new Squeak.Object,i=this.registerObject(e);return e.initAsClone(t,i),this.hasNewInstances[e.sqClass.oop]=!0,e}},"operations",{bulkBecome:function(n,r,c,l){if(!n)return!r;var a=n.length;if(a!==r.length)return!1;this.newSpaceCount>0?this.fullGC("become"):this.vm.storeContextRegisters();for(var i={},e=0;a>e;e++){var t=n[e];if(!t.sqClass)return!1;if(i[t.oop])return!1;i[t.oop]=r[e]}if(c)for(var e=0;a>e;e++){var t=r[e];if(!t.sqClass)return!1;if(i[t.oop])return!1;i[t.oop]=n[e]}if(l)for(var e=0;a>e;e++){var f=n[e].hash;n[e].hash=r[e].hash,r[e].hash=f}for(var t=this.firstOldObject;t;){var s=i[t.sqClass.oop];s&&(t.sqClass=s);var o=t.pointers;if(o)for(var u=0;u<o.length;u++)s=i[o[u].oop],s&&(o[u]=s);t=t.nextObject}return this.vm.flushMethodCacheAfterBecome(i),!0},objectAfter:function(e){return e.nextObject||this.newSpaceCount>0&&this.fullGC("nextObject")},someInstanceOf:function(t){for(var e=this.firstOldObject;;){if(e.sqClass===t)return e;if(e=e.nextObject||this.nextObjectWithGCFor(t),!e)return null}},nextInstanceAfter:function(e){for(var t=e.sqClass;;){if(e=e.nextObject||this.nextObjectWithGCFor(t),!e)return null;if(e.sqClass===t)return e}},nextObjectWithGCFor:function(e){return 0!==this.newSpaceCount&&this.hasNewInstances[e.oop]?this.fullGC("instance of "+e.className()):null},writeToBuffer:function(){var n=64,i=new DataView(new ArrayBuffer(n+this.oldSpaceBytes)),t=0,e=function(e){i.setUint32(t,e),t+=4};for(e(this.formatVersion()),e(n),e(this.oldSpaceBytes),e(this.firstOldObject.addr()),e(this.objectToOop(this.specialObjectsArray)),e(this.lastHash),e(52429400);n>t;)e(0);for(var r=this.firstOldObject,s=0;r;)t=r.writeTo(i,t,this),r=r.nextObject,s++;if(t!==i.byteLength)throw Error("wrong image size");if(s!==this.oldSpaceCount)throw Error("wrong object count");return i.buffer},objectToOop:function(e){if("number"==typeof e)return e<<1|1;if(e.oop<0)throw Error("temporary oop");return e.oop},bytesLeft:function(){return this.totalMemory-this.oldSpaceBytes},formatVersion:function(){return this.hasClosures?6504:6502},segmentVersion:function(){var e=this.specialObjectsArray.pointers[Squeak.splOb_SelectorDoesNotUnderstand],t=new Uint32Array(e.bytes.buffer,0,1);return this.formatVersion()|4278190080&t[0]},loadImageSegment:function(A,p){var l=new DataView(A.words.buffer),c=!1,O=!1,t=0,i=function(){var e=l.getUint32(t,c);return t+=4,e},S=function(e,n){if(5>n){for(var r=[];r.length<e;)r.push(i());return r}var s=new Uint32Array(l.buffer,t,e);return t+=4*e,s},a=i();if(a&!0&&(c=!0,t=0,a=i(),a&!0))return console.error("image segment format not supported"),null;if(a>>16!==this.vm.image.segmentVersion()>>16)return console.error("image segment format not supported"),null;for(var f=[],r={};t<l.byteLength;){var s=0,o=0,e=i();switch(e&Squeak.HeaderTypeMask){case Squeak.HeaderTypeSizeAndClass:s=e>>2,o=i(),e=i();break;case Squeak.HeaderTypeClass:o=e-Squeak.HeaderTypeClass,e=i(),s=e>>2&63;break;case Squeak.HeaderTypeShort:s=e>>2&63,o=e>>12&31;break;case Squeak.HeaderTypeFree:throw Error("Unexpected free block")}s--;var d=t,m=e>>8&15,b=e>>17&4095,g=S(s,m),u=new Squeak.Object;u.initFromImage(d,o,m,b,g),f.push(u),r[d]=u}for(var n=0;n<p.pointers.length;n++)r[2147483652+4*n]=p.pointers[n];for(var y=this.specialObjectsArray.pointers[Squeak.splOb_CompactClasses].pointers,v=0,F=y.map(function(e){return r[--v]=e,v}),h=r[8]||r[12]||r[16],I=this.specialObjectsArray.pointers[Squeak.splOb_ClassFloat],k=h,n=0;n<f.length;n++){var k=f[n];k.installFromImage(r,F,I,c,O),k.oop=-++this.newSpaceCount}return h}}),Object.subclass("Squeak.Object","initialization",{initInstanceOf:function(t,e,n,s){this.sqClass=t,this.hash=n;var i=t.pointers[Squeak.Class_format],r=(i>>1&63)+(i>>10&192)-1;this.format=i>>7&15,this.format<8?6!=this.format?r+e>0&&(this.pointers=this.fillArray(r+e,s)):e>0&&(t.isFloatClass?(this.isFloat=!0,this["float"]=0):this.words=new Uint32Array(e)):e>0&&(this.bytes=new Uint8Array(e))},initAsClone:function(e,t){this.sqClass=e.sqClass,this.hash=t,this.format=e.format,e.isFloat?(this.isFloat=e.isFloat,this["float"]=e["float"]):(e.pointers&&(this.pointers=e.pointers.slice(0)),e.words&&(this.words=new Uint32Array(e.words)),e.bytes&&(this.bytes=new Uint8Array(e.bytes)))},initFromImage:function(e,t,i,r,n){this.oop=e,this.sqClass=t,this.format=i,this.hash=r,this.bits=n},installFromImage:function(i,o,u,t,s){var r=this.sqClass;r>0&&32>r?this.sqClass=i[o[r-1]]:this.sqClass=i[r];var e=this.bits.length;if(this.format<5){if(e>0){var a=this.bits;this.pointers=this.decodePointers(e,a,i)}}else if(this.format>=12){var l=this.decodeWords(1,this.bits,t)[0],n=l>>10&255,a=this.decodeWords(n+1,this.bits,t);this.pointers=this.decodePointers(n+1,a,i),this.bytes=this.decodeBytes(e-(n+1),this.bits,n+1,3&this.format)}else if(this.format>=8)e>0&&(this.bytes=this.decodeBytes(e,this.bits,0,3&this.format));else if(this.sqClass==u){if(this.isFloat=!0,this["float"]=this.decodeFloat(this.bits,t,s),1.3797216632888e-310==this["float"])if(/noFloatDecodeWorkaround/.test(window.location.hash));else if(this.constructor.prototype.decodeFloat=this.decodeFloatDeoptimized,this["float"]=this.decodeFloat(this.bits,t,s),1.3797216632888e-310==this["float"])throw Error("Cannot deoptimize decodeFloat")}else e>0&&(this.words=this.decodeWords(e,this.bits,t));delete this.bits,this.mark=!1},decodePointers:function(r,n,s){for(var t=new Array(r),e=0;r>e;e++){var i=n[e];1===(1&i)?t[e]=i>>1:t[e]=s[i]||42424242}return t},decodeWords:function(t,i,n){for(var s=new DataView(i.buffer,i.byteOffset),r=new Uint32Array(t),e=0;t>e;e++)r[e]=s.getUint32(4*e,n);return r},decodeBytes:function(r,e,n,s){var t=4*r-s,a=new Uint8Array(e.buffer,e.byteOffset+4*n,t),i=new Uint8Array(t);return i.set(a),i},decodeFloat:function(i,r,n){var e=new DataView(i.buffer,i.byteOffset);if(!r)return e.getFloat64(0,!1);if(n)return e.getFloat64(0,!0);var s=new ArrayBuffer(8),t=new DataView(s);return t.setUint32(0,e.getUint32(4)),t.setUint32(4,e.getUint32(0)),t.getFloat64(0,!0)},decodeFloatDeoptimized:function(i,r,n){var e=new DataView(i.buffer,i.byteOffset);if(!r)return e.getFloat64(0,!1);if(n)return e.getFloat64(0,!0);var s=new ArrayBuffer(8),t=new DataView(s);return function(){t.setUint32(0,e.getUint32(4)),t.setUint32(4,e.getUint32(0))}(),t.getFloat64(0,!0)},fillArray:function(i,r){for(var t=[],e=0;i>e;e++)t[e]=r;return t}},"printing",{toString:function(){return this.sqInstName()},bytesAsString:function(){return this.bytes?Squeak.bytesAsString(this.bytes):""},bytesAsNumberString:function(s){if(!this.bytes)return"";for(var r="0123456789ABCDEF",i=[],t=0,e=this.bytes.length-1;e>=0;e--)i.push(r[this.bytes[e]>>4]),i.push(r[15&this.bytes[e]]),t=256*t+this.bytes[e];var n=s?"-":"",a=t>=9007199254740992?"â‰ˆ":"";return n+"16r"+i.join("")+" ("+a+n+t+"L)"},assnKeyAsString:function(){return this.pointers[Squeak.Assn_key].bytesAsString()},slotNameAt:function(e){var t=this.instSize();return t>=e?this.sqClass.allInstVarNames()[e-1]:(e-t).toString()},sqInstName:function(){if(this.isNil)return"nil";if(this.isTrue)return"true";if(this.isFalse)return"false";if(this.isFloat){var t=this["float"].toString();return/\./.test(t)||(t+=".0"),t}var e=this.sqClass.className();if(/ /.test(e))return"the "+e;switch(e){case"String":case"ByteString":return"'"+this.bytesAsString()+"'";case"Symbol":case"ByteSymbol":return"#"+this.bytesAsString();case"Point":return this.pointers.join("@");case"Rectangle":return this.pointers.join(" corner: ");case"Association":case"ReadOnlyVariableBinding":return this.pointers.join("->");case"LargePositiveInteger":return this.bytesAsNumberString(!1);case"LargeNegativeInteger":return this.bytesAsNumberString(!0);case"Character":return"$"+String.fromCharCode(this.pointers[0])+" ("+this.pointers[0].toString()+")"}return/^[aeiou]/i.test(e)?"an "+e:"a "+e}},"accessing",{isWords:function(){return 6===this.format},isBytes:function(){var e=this.format;return e>=8&&11>=e},isWordsOrBytes:function(){var e=this.format;return 6==e||e>=8&&11>=e},isPointers:function(){return this.format<=4},isMethod:function(){return this.format>=12},pointersSize:function(){return this.pointers?this.pointers.length:0},bytesSize:function(){return this.bytes?this.bytes.length:0},wordsSize:function(){return this.isFloat?2:this.words?this.words.length:0},instSize:function(){return this.format>4||2==this.format?0:this.format<2?this.pointersSize():this.sqClass.classInstSize()},floatData:function(){var t=new ArrayBuffer(8),e=new DataView(t);return e.setFloat64(0,this["float"],!1),e},wordsAsFloat32Array:function(){return this.float32Array||this.words&&(this.float32Array=new Float32Array(this.words.buffer))},wordsAsFloat64Array:function(){return this.float64Array||this.words&&(this.float64Array=new Float64Array(this.words.buffer))},wordsAsInt32Array:function(){return this.int32Array||this.words&&(this.int32Array=new Int32Array(this.words.buffer))},wordsAsInt16Array:function(){return this.int16Array||this.words&&(this.int16Array=new Int16Array(this.words.buffer))},wordsAsUint16Array:function(){return this.uint16Array||this.words&&(this.uint16Array=new Uint16Array(this.words.buffer))},wordsAsUint8Array:function(){return this.uint8Array||this.words&&(this.uint8Array=new Uint8Array(this.words.buffer))},wordsOrBytes:function(){return this.words?this.words:this.uint32Array?this.uint32Array:this.bytes?this.uint32Array=new Uint32Array(this.bytes.buffer,0,this.bytes.length>>2):null},setAddr:function(t){var e=this.snapshotSize();return this.oop=t+4*e.header,t+4*(e.header+e.body)},snapshotSize:function(){var e=this.isFloat?2:this.words?this.words.length:this.pointers?this.pointers.length:0;this.bytes&&(e+=this.bytes.length+3>>2),e++;var t=e>63?2:this.sqClass.isCompact?0:1;return{header:t,body:e}},addr:function(){return this.oop-4*this.snapshotSize().header},totalBytes:function(){var e=this.snapshotSize();return 4*(e.header+e.body)},writeTo:function(t,e,s){this.bytes&&(this.format|=3&-this.bytes.length);var a=e,r=this.snapshotSize(),n=(15&this.format)<<8|(4095&this.hash)<<17;switch(r.header){case 2:t.setUint32(e,r.body<<2|Squeak.HeaderTypeSizeAndClass),e+=4,t.setUint32(e,this.sqClass.oop|Squeak.HeaderTypeSizeAndClass),e+=4,t.setUint32(e,n|Squeak.HeaderTypeSizeAndClass),e+=4;break;case 1:t.setUint32(e,this.sqClass.oop|Squeak.HeaderTypeClass),e+=4,t.setUint32(e,n|r.body<<2|Squeak.HeaderTypeClass),e+=4;break;case 0:var o=s.compactClasses.indexOf(this.sqClass)+1;t.setUint32(e,n|o<<12|r.body<<2|Squeak.HeaderTypeShort),e+=4}if(this.isFloat)t.setFloat64(e,this["float"]),e+=8;else if(this.words)for(var i=0;i<this.words.length;i++)t.setUint32(e,this.words[i]),e+=4;else if(this.pointers)for(var i=0;i<this.pointers.length;i++)t.setUint32(e,s.objectToOop(this.pointers[i])),e+=4;if(this.bytes){for(var i=0;i<this.bytes.length;i++)t.setUint8(e++,this.bytes[i]);e+=3&-this.bytes.length}if(e!==a+this.totalBytes())throw Error("written size does not match");return e}},"as class",{classInstSize:function(){var e=this.pointers[Squeak.Class_format];return(e>>10&192)+(e>>1&63)-1},isWeak:function(){var e=this.pointers[Squeak.Class_format];return 4==(e>>7&15)},instVarNames:function(){var e=this.pointers.length>12?4:this.pointers.length>9?3:4;return(this.pointers[e].pointers||[]).map(function(e){return e.bytesAsString()})},allInstVarNames:function(){var e=this.superclass();return e.isNil?this.instVarNames():e.allInstVarNames().concat(this.instVarNames())},superclass:function(){return this.pointers[0]},className:function(){if(!this.pointers)return"_NOTACLASS_";var e=this.pointers[6];if(e&&e.bytes)return Squeak.bytesAsString(e.bytes);var e=this.pointers[7];if(e&&e.bytes)return Squeak.bytesAsString(e.bytes);for(var t=5;6>=t;t++)for(var i=6;7>=i;i++){var r=this.pointers[t];if(r.pointers){var e=r.pointers[i];if(e&&e.bytes)return Squeak.bytesAsString(e.bytes)+" class"}}return"_SOMECLASS_"}},"as method",{methodHeader:function(){return this.pointers[0]},methodNumLits:function(){return this.pointers.length-1},methodNumArgs:function(){return this.methodHeader()>>24&15},methodPrimitiveIndex:function(){var e=805306879&this.methodHeader();return e>511?(511&e)+(e>>19):e},methodClassForSuper:function(){var e=this.pointers[this.methodNumLits()];return e.pointers[Squeak.Assn_value]},methodNeedsLargeFrame:function(){return(131072&this.methodHeader())>0},methodAddPointers:function(e){this.pointers=e},methodTempCount:function(){return this.methodHeader()>>18&63},methodGetLiteral:function(e){return this.pointers[1+e]},methodGetSelector:function(e){return this.pointers[1+e]},methodSetLiteral:function(e,t){this.pointers[1+e]=t}},"as context",{contextHome:function(){return this.contextIsBlock()?this.pointers[Squeak.BlockContext_home]:this},contextIsBlock:function(){return"number"==typeof this.pointers[Squeak.BlockContext_argumentCount]},contextMethod:function(){return this.contextHome().pointers[Squeak.Context_method]},contextSender:function(){return this.pointers[Squeak.Context_sender]},contextSizeWithStack:function(e){if(e&&e.activeContext===this)return e.sp+1;var t=this.pointers[Squeak.Context_stackPointer];return Squeak.Context_tempFrameStart+("number"==typeof t?t:0)}}),Object.subclass("Squeak.Interpreter","initialization",{initialize:function(e,t){console.log("squeak: initializing interpreter "+Squeak.vmVersion),this.Squeak=Squeak,this.image=e,this.image.vm=this,this.primHandler=new Squeak.Primitives(this,t),this.loadImageState(),this.hackImage(),this.initVMState(),this.loadInitialContext(),this.initCompiler(),console.log("squeak: ready")},loadImageState:function(){this.specialObjects=this.image.specialObjectsArray.pointers,this.specialSelectors=this.specialObjects[Squeak.splOb_SpecialSelectors].pointers,this.nilObj=this.specialObjects[Squeak.splOb_NilObject],this.falseObj=this.specialObjects[Squeak.splOb_FalseObject],this.trueObj=this.specialObjects[Squeak.splOb_TrueObject],this.hasClosures=this.image.hasClosures,this.globals=this.findGlobals(),this.hasClosures||this.findMethod("UnixFileDirectory class>>pathNameDelimiter")||(this.primHandler.emulateMac=!0),6501==this.image.version&&(this.primHandler.reverseDisplay=!0)},initVMState:function(){this.byteCodeCount=0,this.sendCount=0,this.interruptCheckCounter=0,this.interruptCheckCounterFeedBackReset=1e3,this.interruptChecksEveryNms=3,this.nextPollTick=0,this.nextWakeupTick=0,this.lastTick=0,this.interruptKeycode=2094,this.interruptPending=!1,this.pendingFinalizationSignals=0,this.freeContexts=this.nilObj,this.freeLargeContexts=this.nilObj,this.reclaimableContextCount=0,this.nRecycledContexts=0,this.nAllocatedContexts=0,this.methodCacheSize=1024,this.methodCacheMask=this.methodCacheSize-1,this.methodCacheRandomish=0,this.methodCache=[];for(var e=0;e<this.methodCacheSize;e++)this.methodCache[e]={lkupClass:null,selector:null,method:null,primIndex:0,argCount:0,mClass:null};this.breakOutOfInterpreter=!1,this.breakOutTick=0,this.breakOnMethod=null,this.breakOnNewMethod=!1,this.breakOnContextChanged=!1,this.breakOnContextReturned=null,this.messages={},this.startupTime=Date.now()},loadInitialContext:function(){var e=this.specialObjects[Squeak.splOb_SchedulerAssociation],t=e.pointers[Squeak.Assn_value],i=t.pointers[Squeak.ProcSched_activeProcess];this.activeContext=i.pointers[Squeak.Proc_suspendedContext],this.fetchContextRegisters(this.activeContext),this.reclaimableContextCount=0},findGlobals:function(){var e=this.specialObjects[Squeak.splOb_SmalltalkDictionary],t=e.sqClass.className();if("Association"===t&&(e=e.pointers[1],t=e.sqClass.className()),"SystemDictionary"===t)return e.pointers[1].pointers;if("SmalltalkImage"===t){var i=e.pointers[0],r=i.sqClass.className();if("SystemDictionary"===r)return i.pointers[1].pointers;if("Environment"===r)return i.pointers[2].pointers[1].pointers}throw Error("cannot find global dict")},initCompiler:function(){if(!Squeak.Compiler)return console.warn("Squeak.Compiler not loaded, using interpreter only");try{if(42!==new Function("return 42")())return console.warn("function constructor not working, disabling JIT")}catch(e){return console.warn("disabling JIT: "+e)}var t=this.image.oldSpaceCount/(this.startupTime-this.image.startupTime);if(10>t)return console.warn("Slow machine detected (loaded "+(1e3*t|0)+" objects/sec), using interpreter only");try{console.log("squeak: initializing JIT compiler"),this.compiler=new Squeak.Compiler(this)}catch(e){console.warn("Compiler "+e)}},hackImage:function(){[].forEach(function(e){var t=this.findMethod(e.method);t&&(t.pointers[0]|=e.primitive,console.warn("Hacking "+e.method))},this)}},"interpreting",{interpretOne:function(r){if(this.method.compiled){if(r){if(!this.compiler.enableSingleStepping(this.method))return this.method.compiled=null,this.interpretOne(r);this.breakNow()}return void(this.byteCodeCount+=this.method.compiled(this))}var e,t,i=this.Squeak;if(this.byteCodeCount++,e=this.nextByte(),128>e)switch(e){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return void this.push(this.receiver.pointers[15&e]);case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:return void this.push(this.homeContext.pointers[i.Context_tempFrameStart+(15&e)]);case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:return void this.push(this.method.methodGetLiteral(31&e));case 64:case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 91:case 92:case 93:case 94:case 95:return void this.push(this.method.methodGetLiteral(31&e).pointers[i.Assn_value]);case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:return void(this.receiver.pointers[7&e]=this.pop());case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:return void(this.homeContext.pointers[i.Context_tempFrameStart+(7&e)]=this.pop());case 112:return void this.push(this.receiver);case 113:return void this.push(this.trueObj);case 114:return void this.push(this.falseObj);case 115:return void this.push(this.nilObj);case 116:return void this.push(-1);case 117:return void this.push(0);case 118:return void this.push(1);case 119:return void this.push(2);case 120:return void this.doReturn(this.receiver);case 121:return void this.doReturn(this.trueObj);case 122:return void this.doReturn(this.falseObj);case 123:return void this.doReturn(this.nilObj);case 124:return void this.doReturn(this.pop());case 125:return void this.doReturn(this.pop(),this.activeContext.pointers[i.BlockContext_caller]);case 126:return void this.nono();case 127:return void this.nono()}else switch(e){case 128:return void this.extendedPush(this.nextByte());case 129:return void this.extendedStore(this.nextByte());case 130:return void this.extendedStorePop(this.nextByte());case 131:return t=this.nextByte(),void this.send(this.method.methodGetSelector(31&t),t>>5,!1);case 132:return void this.doubleExtendedDoAnything(this.nextByte());case 133:return t=this.nextByte(),void this.send(this.method.methodGetSelector(31&t),t>>5,!0);case 134:return t=this.nextByte(),void this.send(this.method.methodGetSelector(63&t),t>>6,!1);case 135:return void this.pop();case 136:return void this.push(this.top());case 137:return void this.push(this.exportThisContext());case 138:return void this.pushNewArray(this.nextByte());case 139:return void this.nono();case 140:return t=this.nextByte(),void this.push(this.homeContext.pointers[i.Context_tempFrameStart+this.nextByte()].pointers[t]);case 141:return t=this.nextByte(),void(this.homeContext.pointers[i.Context_tempFrameStart+this.nextByte()].pointers[t]=this.top());case 142:return t=this.nextByte(),void(this.homeContext.pointers[i.Context_tempFrameStart+this.nextByte()].pointers[t]=this.pop());case 143:return void this.pushClosureCopy();case 144:case 145:case 146:case 147:case 148:case 149:case 150:case 151:return void(this.pc+=(7&e)+1);case 152:case 153:case 154:case 155:case 156:case 157:case 158:case 159:return void this.jumpIfFalse((7&e)+1);case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:return t=this.nextByte(),this.pc+=256*((7&e)-4)+t,void(4>(7&e)&&this.interruptCheckCounter--<=0&&this.checkForInterrupts());case 168:case 169:case 170:case 171:return void this.jumpIfTrue(256*(3&e)+this.nextByte());case 172:case 173:case 174:case 175:return void this.jumpIfFalse(256*(3&e)+this.nextByte());case 176:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)+this.stackIntOrFloat(0))||this.sendSpecial(15&e));case 177:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)-this.stackIntOrFloat(0))||this.sendSpecial(15&e));case 178:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)<this.stackIntOrFloat(0))||this.sendSpecial(15&e));case 179:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)>this.stackIntOrFloat(0))||this.sendSpecial(15&e));case 180:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)<=this.stackIntOrFloat(0))||this.sendSpecial(15&e));case 181:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)>=this.stackIntOrFloat(0))||this.sendSpecial(15&e));case 182:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)===this.stackIntOrFloat(0))||this.sendSpecial(15&e));case 183:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)!==this.stackIntOrFloat(0))||this.sendSpecial(15&e));case 184:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)*this.stackIntOrFloat(0))||this.sendSpecial(15&e));case 185:return this.success=!0,void(this.pop2AndPushIntResult(this.quickDivide(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&e));case 186:return this.success=!0,void(this.pop2AndPushIntResult(this.mod(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&e));case 187:return this.success=!0,void(this.primHandler.primitiveMakePoint(1,!0)||this.sendSpecial(15&e));case 188:return this.success=!0,void(this.pop2AndPushIntResult(this.safeShift(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&e));case 189:return this.success=!0,void(this.pop2AndPushIntResult(this.div(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&e));case 190:return this.success=!0,void(this.pop2AndPushIntResult(this.stackInteger(1)&this.stackInteger(0))||this.sendSpecial(15&e));case 191:return this.success=!0,void(this.pop2AndPushIntResult(this.stackInteger(1)|this.stackInteger(0))||this.sendSpecial(15&e));case 192:case 193:case 194:case 195:case 196:case 197:case 198:case 199:case 200:case 201:case 202:case 203:case 204:case 205:case 206:case 207:return void(this.primHandler.quickSendOther(this.receiver,15&e)||this.sendSpecial((15&e)+16));case 208:case 209:case 210:case 211:case 212:case 213:case 214:case 215:case 216:case 217:case 218:case 219:case 220:case 221:case 222:case 223:return void this.send(this.method.methodGetSelector(15&e),0,!1);case 224:case 225:case 226:case 227:case 228:case 229:case 230:case 231:case 232:case 233:case 234:case 235:case 236:case 237:case 238:case 239:return void this.send(this.method.methodGetSelector(15&e),1,!1);case 240:case 241:case 242:case 243:case 244:case 245:case 246:case 247:case 248:case 249:case 250:case 251:case 252:case 253:case 254:case 255:return void this.send(this.method.methodGetSelector(15&e),2,!1)}throw Error("not a bytecode: "+e)},interpret:function(i,e){if(this.frozen)return"frozen";for(this.isIdle=!1,this.breakOutOfInterpreter=!1,this.breakOutTick=this.primHandler.millisecondClockValue()+(i||500);this.breakOutOfInterpreter===!1;)this.method.compiled?this.byteCodeCount+=this.method.compiled(this):this.interpretOne();if("function"==typeof this.breakOutOfInterpreter)return this.breakOutOfInterpreter(e);var t="break"==this.breakOutOfInterpreter?"break":this.isIdle?this.nextWakeupTick?Math.max(1,this.nextWakeupTick-this.primHandler.millisecondClockValue()):"sleep":0;return e&&e(t),t},goIdle:function(){var e=0!==this.nextWakeupTick;this.forceInterruptCheck(),this.checkForInterrupts();var t=0!==this.nextWakeupTick;this.isIdle=t||!e,this.breakOut()},freeze:function(t){var e;this.frozen=!0,this.breakOutOfInterpreter=function(t){if(!t)throw Error("need function to restart interpreter");return e=t,"frozen"}.bind(this);var i=function(){if(this.frozen=!1,!e)throw Error("no continue function");e(0)}.bind(this);return t&&window.setTimeout(function(){t(i)},0),i},breakOut:function(){this.breakOutOfInterpreter=this.breakOutOfInterpreter||!0},nextByte:function(){return this.methodBytes[this.pc++]},nono:function(){throw Error("Oh No!")},forceInterruptCheck:function(){this.interruptCheckCounter=-1e3},checkForInterrupts:function(){var e=this.primHandler.millisecondClockValue();if(e<this.lastTick&&(this.nextPollTick=e+(this.nextPollTick-this.lastTick),this.breakOutTick=e+(this.breakOutTick-this.lastTick),0!==this.nextWakeupTick&&(this.nextWakeupTick=e+(this.nextWakeupTick-this.lastTick))),this.interruptCheckCounter>-100&&(e-this.lastTick<this.interruptChecksEveryNms?this.interruptCheckCounterFeedBackReset+=10:this.interruptCheckCounterFeedBackReset<=1e3?this.interruptCheckCounterFeedBackReset=1e3:this.interruptCheckCounterFeedBackReset-=12),this.interruptCheckCounter=this.interruptCheckCounterFeedBackReset,this.lastTick=e,this.interruptPending){this.interruptPending=!1;var t=this.specialObjects[Squeak.splOb_TheInterruptSemaphore];t.isNil||this.primHandler.synchronousSignal(t)}if(0!==this.nextWakeupTick&&e>=this.nextWakeupTick){this.nextWakeupTick=0;var t=this.specialObjects[Squeak.splOb_TheTimerSemaphore];t.isNil||this.primHandler.synchronousSignal(t)}if(this.pendingFinalizationSignals>0){var t=this.specialObjects[Squeak.splOb_TheFinalizationSemaphore];this.pendingFinalizationSignals=0,t.isNil||this.primHandler.synchronousSignal(t)}this.primHandler.semaphoresToSignal.length>0&&this.primHandler.signalExternalSemaphores(),!this.method.compiled&&this.compiler&&this.compiler.compile(this.method),e>=this.breakOutTick&&this.breakOut()},extendedPush:function(t){var e=63&t;switch(t>>6){case 0:this.push(this.receiver.pointers[e]);break;case 1:this.push(this.homeContext.pointers[Squeak.Context_tempFrameStart+e]);break;case 2:this.push(this.method.methodGetLiteral(e));break;case 3:this.push(this.method.methodGetLiteral(e).pointers[Squeak.Assn_value])}},extendedStore:function(t){var e=63&t;switch(t>>6){case 0:this.receiver.pointers[e]=this.top();break;case 1:this.homeContext.pointers[Squeak.Context_tempFrameStart+e]=this.top();break;case 2:this.nono();break;case 3:this.method.methodGetLiteral(e).pointers[Squeak.Assn_value]=this.top()}},extendedStorePop:function(t){var e=63&t;switch(t>>6){case 0:this.receiver.pointers[e]=this.pop();break;case 1:this.homeContext.pointers[Squeak.Context_tempFrameStart+e]=this.pop();break;case 2:this.nono();break;case 3:this.method.methodGetLiteral(e).pointers[Squeak.Assn_value]=this.pop()}},doubleExtendedDoAnything:function(t){var e=this.nextByte();switch(t>>5){case 0:this.send(this.method.methodGetSelector(e),31&t,!1);break;case 1:this.send(this.method.methodGetSelector(e),31&t,!0);break;case 2:this.push(this.receiver.pointers[e]);break;case 3:this.push(this.method.methodGetLiteral(e));break;case 4:this.push(this.method.methodGetLiteral(e).pointers[Squeak.Assn_value]);break;case 5:this.receiver.pointers[e]=this.top();break;case 6:this.receiver.pointers[e]=this.pop();break;case 7:this.method.methodGetLiteral(e).pointers[Squeak.Assn_value]=this.top()}},jumpIfTrue:function(t){var e=this.pop();return e.isTrue?void(this.pc+=t):void(e.isFalse||(this.push(e),this.send(this.specialObjects[Squeak.splOb_SelectorMustBeBoolean],0,!1)))},jumpIfFalse:function(t){var e=this.pop();return e.isFalse?void(this.pc+=t):void(e.isTrue||(this.push(e),this.send(this.specialObjects[Squeak.splOb_SelectorMustBeBoolean],0,!1)))},sendSpecial:function(e){this.send(this.specialSelectors[2*e],this.specialSelectors[2*e+1],!1)}},"closures",{pushNewArray:function(i){var n=i>127,e=127&i,r=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassArray],e);if(n){for(var t=0;e>t;t++)r.pointers[t]=this.stackValue(e-t-1);this.popN(e)}this.push(r)},pushClosureCopy:function(){var r=this.nextByte(),n=15&r,e=r>>4,s=this.nextByte(),a=256*s+this.nextByte(),o=this.encodeSqueakPC(this.pc,this.method),i=this.newClosure(n,o,e);if(i.pointers[Squeak.Closure_outerContext]=this.activeContext,this.reclaimableContextCount=0,e>0){for(var t=0;e>t;t++)i.pointers[Squeak.Closure_firstCopiedValue+t]=this.stackValue(e-t-1);this.popN(e)}this.pc+=a,this.push(i)},newClosure:function(t,i,r){var e=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassBlockClosure],r);return e.pointers[Squeak.Closure_startpc]=i,e.pointers[Squeak.Closure_numArgs]=t,e}},"sending",{send:function(i,r,s){var n=this.stackValue(r),e=this.getClass(n);s&&(e=this.method.methodClassForSuper(),
e=e.pointers[Squeak.Class_superclass]);var t=this.findSelectorInClass(i,r,e);t.primIndex&&(this.verifyAtSelector=i,this.verifyAtClass=e),this.executeNewMethod(n,t.method,t.argCount,t.primIndex,t.mClass,i)},sendAsPrimitiveFailure:function(e,t,i){this.executeNewMethod(e,t,i,0)},findSelectorInClass:function(r,n,i){var e=this.findMethodCacheEntry(r,i);if(e.method)return e;for(var a,t=i;!t.isNil;){if(a=t.pointers[Squeak.Class_mdict],a.isNil){var u=this.specialObjects[Squeak.splOb_SelectorCannotInterpret],l=this.createActualMessage(r,n,i);return this.popNandPush(n,l),this.findSelectorInClass(u,1,t.superclass())}var s=this.lookupSelectorInDict(a,r);if(!s.isNil)return this.currentSelector=r,this.currentLookupClass=i,e.method=s,e.primIndex=s.isMethod()?s.methodPrimitiveIndex():248,e.argCount=n,e.mClass=t,e;t=t.superclass()}var o=this.specialObjects[Squeak.splOb_SelectorDoesNotUnderstand];if(r===o)throw Error("Recursive not understood error encountered");var c=this.createActualMessage(r,n,i);return this.popNandPush(n,c),this.findSelectorInClass(o,1,i)},lookupSelectorInDict:function(t,i){for(var r=t.pointersSize(),a=r-Squeak.MethodDict_selectorStart-1,e=(a&i.hash)+Squeak.MethodDict_selectorStart,n=!1;;){var s=t.pointers[e];if(s===i){var o=t.pointers[Squeak.MethodDict_array];return o.pointers[e-Squeak.MethodDict_selectorStart]}if(s.isNil)return this.nilObj;if(++e===r){if(n)return this.nilObj;e=Squeak.MethodDict_selectorStart,n=!0}}},executeNewMethod:function(o,e,i,s,r,n){if(this.sendCount++,e===this.breakOnMethod&&this.breakNow("executing method "+this.printMethod(e,r,n)),this.logSends&&console.log(this.sendCount+" "+this.printMethod(e,r,n)),this.breakOnContextChanged&&(this.breakOnContextChanged=!1,this.breakNow()),!(s>0&&this.tryPrimitive(s,i,e))){var t=this.allocateOrRecycleContext(e.methodNeedsLargeFrame()),a=e.methodTempCount(),u=0,l=Squeak.Context_tempFrameStart+a-1;if(t.pointers[Squeak.Context_method]=e,t.pointers[Squeak.BlockContext_initialIP]=this.nilObj,t.pointers[Squeak.Context_sender]=this.activeContext,this.arrayCopy(this.activeContext.pointers,this.sp-i,t.pointers,Squeak.Context_tempFrameStart-1,i+1),this.arrayFill(t.pointers,Squeak.Context_tempFrameStart+i,Squeak.Context_tempFrameStart+a,this.nilObj),this.popN(i+1),this.reclaimableContextCount++,this.storeContextRegisters(),this.activeContext=t,this.homeContext=t,this.method=e,this.methodBytes=e.bytes,this.pc=u,this.sp=l,this.storeContextRegisters(),this.receiver=t.pointers[Squeak.Context_receiver],this.receiver!==o)throw Error("receivers don't match");!e.compiled&&this.compiler&&this.compiler.compile(e,r,n),this.interruptCheckCounter--<=0&&this.checkForInterrupts()}},doReturn:function(i,t){if(!t){var r=this.homeContext;if(this.hasClosures)for(var n;!(n=r.pointers[Squeak.Context_closure]).isNil;)r=n.pointers[Squeak.Closure_outerContext];t=r.pointers[Squeak.Context_sender]}if(t.isNil||t.pointers[Squeak.Context_instructionPointer].isNil)return this.cannotReturn(i);for(var e=this.activeContext.pointers[Squeak.Context_sender];e!==t;){if(e.isNil)return this.cannotReturn(i);if(this.isUnwindMarked(e))return this.aboutToReturnThrough(i,e);e=e.pointers[Squeak.Context_sender]}var s;for(e=this.activeContext;e!==t;)this.breakOnContextReturned===e&&(this.breakOnContextReturned=null,this.breakNow()),s=e.pointers[Squeak.Context_sender],e.pointers[Squeak.Context_sender]=this.nilObj,e.pointers[Squeak.Context_instructionPointer]=this.nilObj,this.reclaimableContextCount>0&&(this.reclaimableContextCount--,this.recycleIfPossible(e)),e=s;this.activeContext=e,this.fetchContextRegisters(this.activeContext),this.push(i),this.breakOnContextChanged&&(this.breakOnContextChanged=!1,this.breakNow())},aboutToReturnThrough:function(e,t){this.push(this.exportThisContext()),this.push(e),this.push(t);var i=this.specialObjects[Squeak.splOb_SelectorAboutToReturn];this.send(i,2)},cannotReturn:function(e){this.push(this.exportThisContext()),this.push(e);var t=this.specialObjects[Squeak.splOb_SelectorCannotReturn];this.send(t,1)},tryPrimitive:function(e,t,i){if(e>255&&520>e){if(e>=264)return this.popNandPush(1,this.top().pointers[e-264]),!0;switch(e){case 256:return!0;case 257:return this.popNandPush(1,this.trueObj),!0;case 258:return this.popNandPush(1,this.falseObj),!0;case 259:return this.popNandPush(1,this.nilObj),!0}return this.popNandPush(1,e-261),!0}var r=this.primHandler.doPrimitive(e,t,i);return r},createActualMessage:function(r,t,n){var e=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassMessage],0),i=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassArray],t);return this.arrayCopy(this.activeContext.pointers,this.sp-t+1,i.pointers,0,t),e.pointers[Squeak.Message_selector]=r,e.pointers[Squeak.Message_arguments]=i,e.pointers.length>Squeak.Message_lookupClass&&(e.pointers[Squeak.Message_lookupClass]=n),e},primitivePerform:function(t){var r=this.stackValue(t-1),n=this.stackValue(t),i=t-1,s=this.sp-i,a=this.activeContext.pointers;this.arrayCopy(a,s+1,a,s,i),this.sp--;var e=this.findSelectorInClass(r,i,this.getClass(n));return this.executeNewMethod(n,e.method,e.argCount,e.primIndex,e.mClass,r),!0},primitivePerformWithArgs:function(e,a){var r=this.stackValue(e),o=this.stackValue(e-1),n=this.stackValue(e-2);if(n.sqClass!==this.specialObjects[Squeak.splOb_ClassArray])return!1;var u=a?this.stackValue(e-3):this.getClass(r);if(a)for(var t=this.getClass(r);t!==u;)if(t=t.pointers[Squeak.Class_superclass],t.isNil)return!1;var s=n.pointersSize(),l=this.activeContext.pointers;this.arrayCopy(n.pointers,0,l,this.sp-1,s),this.sp+=s-e;var i=this.findSelectorInClass(o,s,u);return this.executeNewMethod(r,i.method,i.argCount,i.primIndex,i.mClass,o),!0},primitiveInvokeObjectAsMethod:function(e,r){for(var i=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassArray],e),t=0;e>t;t++)i.pointers[e-t-1]=this.pop();var n=this.pop(),s=this.currentSelector,a=this.specialObjects[Squeak.splOb_SelectorRunWithIn];return this.push(r),this.push(s),this.push(i),this.push(n),this.send(a,3,!1),!0},findMethodCacheEntry:function(t,r){var e;this.methodCacheRandomish=this.methodCacheRandomish+1&3;for(var n=(t.hash^r.hash)&this.methodCacheMask,i=n,s=0;4>s;s++){if(e=this.methodCache[i],e.selector===t&&e.lkupClass===r)return e;s===this.methodCacheRandomish&&(n=i),i=i+t.hash&this.methodCacheMask}return e=this.methodCache[n],e.lkupClass=r,e.selector=t,e.method=null,e},flushMethodCache:function(){for(var e=0;e<this.methodCacheSize;e++)this.methodCache[e].selector=null,this.methodCache[e].method=null;return!0},flushMethodCacheForSelector:function(t){for(var e=0;e<this.methodCacheSize;e++)this.methodCache[e].selector===t&&(this.methodCache[e].selector=null,this.methodCache[e].method=null);return!0},flushMethodCacheForMethod:function(t){for(var e=0;e<this.methodCacheSize;e++)this.methodCache[e].method===t&&(this.methodCache[e].selector=null,this.methodCache[e].method=null);return!0},flushMethodCacheAfterBecome:function(e){this.flushMethodCache()}},"contexts",{isUnwindMarked:function(e){if(!this.isMethodContext(e))return!1;var t=e.pointers[Squeak.Context_method];return 198==t.methodPrimitiveIndex()},newActiveContext:function(e){this.storeContextRegisters(),this.activeContext=e,this.fetchContextRegisters(e)},exportThisContext:function(){return this.storeContextRegisters(),this.reclaimableContextCount=0,this.activeContext},fetchContextRegisters:function(e){var t=e.pointers[Squeak.Context_method];this.isSmallInt(t)?(this.homeContext=e.pointers[Squeak.BlockContext_home],t=this.homeContext.pointers[Squeak.Context_method]):this.homeContext=e,this.receiver=this.homeContext.pointers[Squeak.Context_receiver],this.method=t,this.methodBytes=t.bytes,this.pc=this.decodeSqueakPC(e.pointers[Squeak.Context_instructionPointer],t),this.sp=this.decodeSqueakSP(e.pointers[Squeak.Context_stackPointer])},storeContextRegisters:function(){this.activeContext.pointers[Squeak.Context_instructionPointer]=this.encodeSqueakPC(this.pc,this.method),this.activeContext.pointers[Squeak.Context_stackPointer]=this.encodeSqueakSP(this.sp)},encodeSqueakPC:function(e,t){return e+4*t.pointers.length+1},decodeSqueakPC:function(e,t){return e-4*t.pointers.length-1},encodeSqueakSP:function(e){return e-(Squeak.Context_tempFrameStart-1)},decodeSqueakSP:function(e){return e+(Squeak.Context_tempFrameStart-1)},recycleIfPossible:function(e){if(this.isMethodContext(e))if(e.pointersSize()===Squeak.Context_tempFrameStart+Squeak.Context_smallFrameSize)e.pointers[0]=this.freeContexts,this.freeContexts=e;else{if(e.pointersSize()!==Squeak.Context_tempFrameStart+Squeak.Context_largeFrameSize)return;e.pointers[0]=this.freeLargeContexts,this.freeLargeContexts=e}},allocateOrRecycleContext:function(t){var e;return t?this.freeLargeContexts.isNil?(this.nAllocatedContexts++,this.instantiateClass(this.specialObjects[Squeak.splOb_ClassMethodContext],Squeak.Context_largeFrameSize)):(e=this.freeLargeContexts,this.freeLargeContexts=e.pointers[0],this.nRecycledContexts++,e):this.freeContexts.isNil?(this.nAllocatedContexts++,this.instantiateClass(this.specialObjects[Squeak.splOb_ClassMethodContext],Squeak.Context_smallFrameSize)):(e=this.freeContexts,this.freeContexts=e.pointers[0],this.nRecycledContexts++,e)}},"stack access",{pop:function(){return this.activeContext.pointers[this.sp--]},popN:function(e){this.sp-=e},push:function(e){this.activeContext.pointers[++this.sp]=e},popNandPush:function(e,t){this.activeContext.pointers[this.sp-=e-1]=t},top:function(){return this.activeContext.pointers[this.sp]},stackValue:function(e){return this.activeContext.pointers[this.sp-e]},stackInteger:function(e){return this.checkSmallInt(this.stackValue(e))},stackIntOrFloat:function(n){var e=this.stackValue(n);if("number"==typeof e)return e;if(e.isFloat)return this.resultIsFloat=!0,e["float"];var i=e.bytes;if(i&&4==i.length){for(var t=0,r=3;r>=0;r--)t=256*t+i[r];if(e.sqClass===this.specialObjects[Squeak.splOb_ClassLargePositiveInteger])return t;if(e.sqClass===this.specialObjects[Squeak.splOb_ClassLargeNegativeInteger])return-t}return this.success=!1,0},pop2AndPushIntResult:function(e){return this.success&&this.canBeSmallInt(e)?(this.popNandPush(2,e),!0):!1},pop2AndPushNumResult:function(e){if(this.success){if(this.resultIsFloat)return this.popNandPush(2,this.primHandler.makeFloat(e)),!0;if(e>=Squeak.MinSmallInt&&e<=Squeak.MaxSmallInt)return this.popNandPush(2,e),!0;if(e>=-4294967295&&4294967295>=e){var r=0>e,t=r?-e:e,s=r?Squeak.splOb_ClassLargeNegativeInteger:Squeak.splOb_ClassLargePositiveInteger,n=this.instantiateClass(this.specialObjects[s],4),i=n.bytes;return i[0]=255&t,i[1]=t>>8&255,i[2]=t>>16&255,i[3]=t>>24&255,this.popNandPush(2,n),!0}}return!1},pop2AndPushBoolResult:function(e){return this.success?(this.popNandPush(2,e?this.trueObj:this.falseObj),!0):!1}},"numbers",{getClass:function(e){return this.isSmallInt(e)?this.specialObjects[Squeak.splOb_ClassInteger]:e.sqClass},canBeSmallInt:function(e){return e>=Squeak.MinSmallInt&&e<=Squeak.MaxSmallInt},isSmallInt:function(e){return"number"==typeof e},checkSmallInt:function(e){return"number"==typeof e?e:(this.success=!1,1)},quickDivide:function(t,e){if(0===e)return Squeak.NonSmallInt;var i=t/e|0;return i*e===t?i:Squeak.NonSmallInt},div:function(t,e){return 0===e?Squeak.NonSmallInt:Math.floor(t/e)},mod:function(t,e){return 0===e?Squeak.NonSmallInt:t-Math.floor(t/e)*e},safeShift:function(t,e){if(0>e)return-31>e?0>t?-1:0:t>>-e;if(e>31)return 0==t?0:Squeak.NonSmallInt;var i=t<<e;return i>>e===t?i:Squeak.NonSmallInt}},"utils",{isContext:function(e){return e.sqClass===this.specialObjects[Squeak.splOb_ClassMethodContext]?!0:e.sqClass===this.specialObjects[Squeak.splOb_ClassBlockContext]?!0:!1},isMethodContext:function(e){return e.sqClass===this.specialObjects[Squeak.splOb_ClassMethodContext]},isMethod:function(e,t){return e.sqClass===this.specialObjects[Squeak.splOb_ClassCompiledMethod]},instantiateClass:function(e,t){return this.image.instantiateClass(e,t,this.nilObj)},arrayFill:function(t,i,r,n){for(var e=i;r>e;e++)t[e]=n},arrayCopy:function(t,i,r,n,s){if(t===r&&n>i)for(var e=s-1;e>=0;e--)r[n+e]=t[i+e];else for(var e=0;s>e;e++)r[n+e]=t[i+e]}},"debugging",{addMessage:function(e){return this.messages[e]?++this.messages[e]:this.messages[e]=1},warnOnce:function(e){1==this.addMessage(e)&&console.warn(e)},printMethod:function(e,t,r){if(r)return t.className()+">>"+r.bytesAsString();e||(e=this.activeContext.contextMethod());var i;if(this.allMethodsDo(function(t,r,n){return r===e?i=t.className()+">>"+n.bytesAsString():void 0}),i)return i;if(t){var n=t.pointers[Squeak.Context_receiver];return"("+n+")>>?"}return"?>>?"},allInstancesOf:function(t,i){"string"==typeof t&&(t=this.globalNamed(t));for(var r=[],e=this.image.someInstanceOf(t);e;)i?i(e):r.push(e),e=this.image.nextInstanceAfter(e);return r},globalNamed:function(e){return this.allGlobalsDo(function(t,i){return t.bytesAsString()===e?i:void 0})},allGlobalsDo:function(n){for(var i=this.globals,e=0;e<i.length;e++){var t=i[e];if(!t.isNil){var r=n(t.pointers[0],t.pointers[1]);if(r)return r}}},allMethodsDo:function(e){this.allGlobalsDo(function(l,t){if(t.pointers&&t.pointers.length>=9)for(var a=[t,t.sqClass],n=0;n<a.length;n++){var o=a[n],i=o.pointers[1];if(i.pointers&&i.pointers[1]){var s=i.pointers[1].pointers;if(s)for(var u=i.pointers,r=0;r<s.length;r++)if(e.call(this,o,s[r],u[2+r]))return!0}}})},printStack:function(e,i){"number"==typeof e&&(i=e,e=null),e||(e=this.activeContext),i||(i=100);for(var t=[],u=Math.max(i,1e6);!e.isNil&&u-->0;)t.push(e),e=e.pointers[Squeak.Context_sender];var a=200;t.length>i+a&&(e.isNil||t.push("..."),t=t.slice(0,i).concat(["..."]).concat(t.slice(-a)));for(var r=[],o=t.length;o-->0;){var e=t[o];if(e.pointers){var n="",s=e.pointers[Squeak.Context_method];"number"==typeof s?(s=e.pointers[Squeak.BlockContext_home].pointers[Squeak.Context_method],n="[] in "):e.pointers[Squeak.Context_closure].isNil||(n="[] in "),r.push(n+this.printMethod(s,e)+"\n")}else r.push("...\n")}return r.join("")},findMethod:function(e){var t,r=e.split(">>")[0],i=e.split(">>")[1];return this.allMethodsDo(function(n,s,e){return i.length==e.bytesSize()&&i==e.bytesAsString()&&r==n.className()?t=s:void 0}),t},breakNow:function(e){e&&console.log("Break: "+e),this.breakOutOfInterpreter="break"},breakOn:function(e){return this.breakOnMethod=e&&this.findMethod(e)},breakOnReturnFromThisContext:function(){this.breakOnContextChanged=!1,this.breakOnContextReturned=this.activeContext},breakOnSendOrReturn:function(){this.breakOnContextChanged=!0,this.breakOnContextReturned=null},printActiveContext:function(){for(var t=this.activeContext,s="number"==typeof t.pointers[Squeak.BlockContext_argumentCount],l=t.pointers[Squeak.Context_closure],d=!s&&!l.isNil,o=s?t.pointers[Squeak.BlockContext_home]:t,p=d?l.pointers[Squeak.Closure_numArgs]:o.pointers[Squeak.Context_method].methodTempCount(),a=this.decodeSqueakSP(0),v=o.contextSizeWithStack(this)-1,c=a+1,k=c+p-1,n="",e=a;v>=e;e++){var i=o.pointers[e],f=i.sqInstName?i.sqInstName():i.toString(),r="";e==a?r="=rcvr":k>=e&&(r="=tmp"+(e-c)),n+="\nctx["+e+"]"+r+": "+f}if(s){n+="\n";for(var m=t.pointers[3],u=this.decodeSqueakSP(1),h=u+m,e=u;e<=this.sp;e++){var i=t.pointers[e],f=i.sqInstName?i.sqInstName():i.toString(),r="";h>=e&&(r="=arg"+(e-u)),n+="\nblk["+e+"]"+r+": "+f}}return n},printAllProcesses:function(){for(var a=this.specialObjects[Squeak.splOb_SchedulerAssociation],n=a.pointers[Squeak.Assn_value],o=n.pointers[Squeak.ProcSched_activeProcess],i="Active: "+this.printProcess(o,!0),s=n.pointers[Squeak.ProcSched_processLists].pointers,r=s.length-1;r>=0;r--)for(var e=s[r].pointers[Squeak.LinkedList_firstLink];!e.isNil;)i+="\nRunnable: "+this.printProcess(e),e=e.pointers[Squeak.Link_nextLink];for(var u=this.specialObjects[Squeak.splOb_ClassSemaphore],t=this.image.someInstanceOf(u);t;){for(var e=t.pointers[Squeak.LinkedList_firstLink];!e.isNil;)i+="\nWaiting: "+this.printProcess(e),e=e.pointers[Squeak.Link_nextLink];t=this.image.nextInstanceAfter(t)}return i},printProcess:function(e,t){var i=e.pointers[Squeak.Proc_suspendedContext],r=e.pointers[Squeak.Proc_priority],n=this.printStack(t?null:i);return e.toString()+" at priority "+r+"\n"+n},printByteCodes:function(e,t,i,r){e||(e=this.method);var n=new Squeak.InstructionPrinter(e,this);return n.printInstructions(t,i,r)},willSendOrReturn:function(){var e=this.method.bytes[this.pc];if(e>=120&&125>=e)return!0;if(131>e||200==e)return!1;if(e>=176)return!0;if(134>=e){var t;if(132===e){if(this.method.bytes[this.pc+1]>>5>1)return!1;t=this.method.bytes[this.pc+2]}else t=this.method.bytes[this.pc+1]&(134===e?63:31);var i=this.method.pointers[t+1];if("blockCopy:"!=i.bytesAsString())return!0}return!1}}),Object.subclass("Squeak.Primitives","initialization",{initialize:function(e,t){this.vm=e,this.display=t,this.display.vm=this.vm,this.oldPrims=!this.vm.image.hasClosures,this.allowAccessBeyondSP=this.oldPrims,this.deferDisplayUpdates=!1,this.semaphoresToSignal=[],this.initDisplay(),this.initAtCache(),this.initModules()},initModules:function(){this.loadedModules={},this.builtinModules={JavaScriptPlugin:this.findPluginFunctions("js_","",!0),FilePlugin:this.findPluginFunctions("","primitive(Disable)?(File|Directory)"),DropPlugin:this.findPluginFunctions("","primitiveDropRequest"),SoundPlugin:this.findPluginFunctions("snd_"),JPEGReadWriter2Plugin:this.findPluginFunctions("jpeg2_"),SecurityPlugin:{primitiveDisableImageWrite:this.fakePrimitive.bind(this,"SecurityPlugin.primitiveDisableImageWrite",0)}},this.patchModules={ScratchPlugin:this.findPluginFunctions("scratch_")},this.interpreterProxy=new Squeak.InterpreterProxy(this.vm)},findPluginFunctions:function(t,i,s){i=i||"(initialise|shutdown|prim)";var r={},a=new RegExp("^"+t+i,"i");for(var e in this)if(a.test(e)&&"function"==typeof this[e]){var n=e;t&&(n=e[t.length].toLowerCase()+e.slice(t.length+1)),r[n]=s?e:this[e].bind(this)}return r},initDisplay:function(){this.indexedColors=[4294967295,4278190081,4294967295,4286611584,4294901760,4278255360,4278190335,4278255615,4294967040,4294902015,4280295456,4282400832,4284506208,4288651167,4290756543,4292861919,4278716424,4279242768,4279769112,4280821800,4281348144,4281874488,4282927176,4283453520,4283979864,4285032552,4285558896,4286085240,4287072135,4287598479,4288124823,4289177511,4289703855,4290230199,4291282887,4291809231,4292335575,4293388263,4293914607,4294440951,4278190081,4278203136,4278216192,4278229248,4278242304,4278255360,4278190131,4278203187,4278216243,4278229299,4278242355,4278255411,4278190182,4278203238,4278216294,4278229350,4278242406,4278255462,4278190233,4278203289,4278216345,4278229401,4278242457,4278255513,4278190284,4278203340,4278216396,4278229452,4278242508,4278255564,4278190335,4278203391,4278216447,4278229503,4278242559,4278255615,4281532416,4281545472,4281558528,4281571584,4281584640,4281597696,4281532467,4281545523,4281558579,4281571635,4281584691,4281597747,4281532518,4281545574,4281558630,4281571686,4281584742,4281597798,4281532569,4281545625,4281558681,4281571737,4281584793,4281597849,4281532620,4281545676,4281558732,4281571788,4281584844,4281597900,4281532671,4281545727,4281558783,4281571839,4281584895,4281597951,4284874752,4284887808,4284900864,4284913920,4284926976,4284940032,4284874803,4284887859,4284900915,4284913971,4284927027,4284940083,4284874854,4284887910,4284900966,4284914022,4284927078,4284940134,4284874905,4284887961,4284901017,4284914073,4284927129,4284940185,4284874956,4284888012,4284901068,4284914124,4284927180,4284940236,4284875007,4284888063,4284901119,4284914175,4284927231,4284940287,4288217088,4288230144,4288243200,4288256256,4288269312,4288282368,4288217139,4288230195,4288243251,4288256307,4288269363,4288282419,4288217190,4288230246,4288243302,4288256358,4288269414,4288282470,4288217241,4288230297,4288243353,4288256409,4288269465,4288282521,4288217292,4288230348,4288243404,4288256460,4288269516,4288282572,4288217343,4288230399,4288243455,4288256511,4288269567,4288282623,4291559424,4291572480,4291585536,4291598592,4291611648,4291624704,4291559475,4291572531,4291585587,4291598643,4291611699,4291624755,4291559526,4291572582,4291585638,4291598694,4291611750,4291624806,4291559577,4291572633,4291585689,4291598745,4291611801,4291624857,4291559628,4291572684,4291585740,4291598796,4291611852,4291624908,4291559679,4291572735,4291585791,4291598847,4291611903,4291624959,4294901760,4294914816,4294927872,4294940928,4294953984,4294967040,4294901811,4294914867,4294927923,4294940979,4294954035,4294967091,4294901862,4294914918,4294927974,4294941030,4294954086,4294967142,4294901913,4294914969,4294928025,4294941081,4294954137,4294967193,4294901964,4294915020,4294928076,4294941132,4294954188,4294967244,4294902015,4294915071,4294928127,4294941183,4294954239,4294967295]}},"dispatch",{quickSendOther:function(t,e){switch(this.success=!0,e){case 0:return this.popNandPushIfOK(2,this.objectAt(!0,!0,!1));case 1:return this.popNandPushIfOK(3,this.objectAtPut(!0,!0,!1));case 2:return this.popNandPushIfOK(1,this.objectSize(!0));case 6:return this.pop2andPushBoolIfOK(this.vm.stackValue(1)===this.vm.stackValue(0));case 7:return this.popNandPushIfOK(1,this.vm.getClass(this.vm.top()));case 8:return this.popNandPushIfOK(2,this.doBlockCopy());case 9:return this.primitiveBlockValue(0);case 10:return this.primitiveBlockValue(1)}return!1},doPrimitive:function(t,e,i){if(this.success=!0,128>t)switch(t){case 1:return this.popNandPushIntIfOK(2,this.stackInteger(1)+this.stackInteger(0));case 2:return this.popNandPushIntIfOK(2,this.stackInteger(1)-this.stackInteger(0));case 3:return this.pop2andPushBoolIfOK(this.stackInteger(1)<this.stackInteger(0));case 4:return this.pop2andPushBoolIfOK(this.stackInteger(1)>this.stackInteger(0));case 5:return this.pop2andPushBoolIfOK(this.stackInteger(1)<=this.stackInteger(0));case 6:return this.pop2andPushBoolIfOK(this.stackInteger(1)>=this.stackInteger(0));case 7:return this.pop2andPushBoolIfOK(this.stackInteger(1)===this.stackInteger(0));case 8:return this.pop2andPushBoolIfOK(this.stackInteger(1)!==this.stackInteger(0));case 9:return this.popNandPushIntIfOK(2,this.stackInteger(1)*this.stackInteger(0));case 10:return this.popNandPushIntIfOK(2,this.vm.quickDivide(this.stackInteger(1),this.stackInteger(0)));case 11:return this.popNandPushIntIfOK(2,this.vm.mod(this.stackInteger(1),this.stackInteger(0)));case 12:return this.popNandPushIntIfOK(2,this.vm.div(this.stackInteger(1),this.stackInteger(0)));case 13:return this.popNandPushIntIfOK(2,this.stackInteger(1)/this.stackInteger(0)|0);case 14:return this.popNandPushIfOK(2,this.doBitAnd());case 15:return this.popNandPushIfOK(2,this.doBitOr());case 16:return this.popNandPushIfOK(2,this.doBitXor());case 17:return this.popNandPushIfOK(2,this.doBitShift());case 18:return this.primitiveMakePoint(e,!1);case 19:return!1;case 20:return!1;case 21:return!1;case 22:return!1;case 23:return this.primitiveLessThanLargeIntegers();case 24:return this.primitiveGreaterThanLargeIntegers();case 25:return this.primitiveLessOrEqualLargeIntegers();case 26:return this.primitiveGreaterOrEqualLargeIntegers();case 27:return this.primitiveEqualLargeIntegers();case 28:return this.primitiveNotEqualLargeIntegers();case 29:return!1;case 30:return!1;case 31:return!1;case 32:return!1;case 33:return!1;case 34:return!1;case 35:return!1;case 36:return!1;case 37:return!1;case 38:return this.popNandPushIfOK(2,this.objectAt(!1,!1,!1));case 39:return this.popNandPushIfOK(3,this.objectAtPut(!1,!1,!1));case 40:return this.popNandPushFloatIfOK(1,this.stackInteger(0));case 41:return this.popNandPushFloatIfOK(2,this.stackFloat(1)+this.stackFloat(0));case 42:return this.popNandPushFloatIfOK(2,this.stackFloat(1)-this.stackFloat(0));case 43:return this.pop2andPushBoolIfOK(this.stackFloat(1)<this.stackFloat(0));case 44:return this.pop2andPushBoolIfOK(this.stackFloat(1)>this.stackFloat(0));case 45:return this.pop2andPushBoolIfOK(this.stackFloat(1)<=this.stackFloat(0));case 46:return this.pop2andPushBoolIfOK(this.stackFloat(1)>=this.stackFloat(0));case 47:return this.pop2andPushBoolIfOK(this.stackFloat(1)===this.stackFloat(0));case 48:return this.pop2andPushBoolIfOK(this.stackFloat(1)!==this.stackFloat(0));case 49:return this.popNandPushFloatIfOK(2,this.stackFloat(1)*this.stackFloat(0));case 50:return this.popNandPushFloatIfOK(2,this.safeFDiv(this.stackFloat(1),this.stackFloat(0)));case 51:return this.popNandPushIfOK(1,this.floatAsSmallInt(this.stackFloat(0)));case 52:return!1;case 53:return this.popNandPushIntIfOK(1,this.frexp_exponent(this.stackFloat(0))-1);case 54:return this.popNandPushFloatIfOK(2,this.ldexp(this.stackFloat(1),this.stackFloat(0)));case 55:return this.popNandPushFloatIfOK(1,Math.sqrt(this.stackFloat(0)));case 56:return this.popNandPushFloatIfOK(1,Math.sin(this.stackFloat(0)));case 57:return this.popNandPushFloatIfOK(1,Math.atan(this.stackFloat(0)));case 58:return this.popNandPushFloatIfOK(1,Math.log(this.stackFloat(0)));case 59:return this.popNandPushFloatIfOK(1,Math.exp(this.stackFloat(0)));case 60:return this.popNandPushIfOK(2,this.objectAt(!1,!1,!1));case 61:return this.popNandPushIfOK(3,this.objectAtPut(!1,!1,!1));case 62:return this.popNandPushIfOK(1,this.objectSize(!1));case 63:return this.popNandPushIfOK(2,this.objectAt(!1,!0,!1));case 64:return this.popNandPushIfOK(3,this.objectAtPut(!1,!0,!1));case 65:return!1;case 66:return!1;case 67:return!1;case 68:return this.popNandPushIfOK(2,this.objectAt(!1,!1,!0));case 69:return this.popNandPushIfOK(3,this.objectAtPut(!1,!1,!0));case 70:return this.popNandPushIfOK(1,this.instantiateClass(this.stackNonInteger(0),0));case 71:return this.popNandPushIfOK(2,this.instantiateClass(this.stackNonInteger(1),this.stackPos32BitInt(0)));case 72:return this.primitiveArrayBecome(e,!1);case 73:return this.popNandPushIfOK(2,this.objectAt(!1,!1,!0));case 74:return this.popNandPushIfOK(3,this.objectAtPut(!1,!1,!0));case 75:return this.popNandPushIfOK(1,this.stackNonInteger(0).hash);case 76:return this.primitiveStoreStackp(e);case 77:return this.popNandPushIfOK(1,this.someInstanceOf(this.stackNonInteger(0)));case 78:return this.popNandPushIfOK(1,this.nextInstanceAfter(this.stackNonInteger(0)));case 79:return this.primitiveNewMethod(e);case 80:return this.popNandPushIfOK(2,this.doBlockCopy());case 81:return this.primitiveBlockValue(e);case 82:return this.primitiveBlockValueWithArgs(e);case 83:return this.vm.primitivePerform(e);case 84:return this.vm.primitivePerformWithArgs(e,!1);case 85:return this.primitiveSignal();case 86:return this.primitiveWait();case 87:return this.primitiveResume();case 88:return this.primitiveSuspend();case 89:return this.vm.flushMethodCache();case 90:return this.primitiveMousePoint(e);case 91:return this.primitiveTestDisplayDepth(e);case 93:return this.primitiveInputSemaphore(e);case 94:return this.primitiveGetNextEvent(e);case 95:return this.primitiveInputWord(e);case 96:return this.namedPrimitive("BitBltPlugin","primitiveCopyBits",e);case 97:return this.primitiveSnapshot(e);case 99:return this.primitiveLoadImageSegment(e);case 100:return this.vm.primitivePerformWithArgs(e,!0);case 101:return this.primitiveBeCursor(e);case 102:return this.primitiveBeDisplay(e);case 103:return!1;case 104:return!1;case 105:return this.popNandPushIfOK(5,this.doStringReplace());case 106:return this.primitiveScreenSize(e);case 107:return this.primitiveMouseButtons(e);case 108:return this.primitiveKeyboardNext(e);case 109:return this.primitiveKeyboardPeek(e);case 110:return this.pop2andPushBoolIfOK(this.vm.stackValue(1)===this.vm.stackValue(0));case 111:return this.popNandPushIfOK(1,this.vm.getClass(this.vm.top()));case 112:return this.popNandPushIfOK(1,this.vm.image.bytesLeft());case 113:return this.primitiveQuit(e);case 114:return this.primitiveExitToDebugger(e);case 115:return this.primitiveChangeClass(e);case 116:return this.vm.flushMethodCacheForMethod(this.vm.top());case 117:return this.doNamedPrimitive(e,i);case 118:return this.primitiveDoPrimitiveWithArgs(e);case 119:return this.vm.flushMethodCacheForSelector(this.vm.top());case 120:return!1;case 121:return this.primitiveImageName(e);case 122:return this.primitiveReverseDisplay(e);case 124:return this.popNandPushIfOK(2,this.registerSemaphore(Squeak.splOb_TheLowSpaceSemaphore));case 125:return this.popNandPushIfOK(2,this.setLowSpaceThreshold());case 126:return this.primitiveDeferDisplayUpdates(e);case 127:return this.primitiveShowDisplayRect(e)}else if(256>t)switch(t){case 128:return this.primitiveArrayBecome(e,!0);case 129:return this.popNandPushIfOK(1,this.vm.image.specialObjectsArray);case 130:return this.primitiveFullGC(e);case 131:return this.popNandPushIfOK(1,this.vm.image.partialGC());case 132:return this.pop2andPushBoolIfOK(this.pointsTo(this.stackNonInteger(1),this.vm.top()));case 133:return!0;case 134:return this.popNandPushIfOK(2,this.registerSemaphore(Squeak.splOb_TheInterruptSemaphore));case 135:return this.popNandPushIfOK(1,this.millisecondClockValue());case 136:return this.primitiveSignalAtMilliseconds(e);case 137:return this.popNandPushIfOK(1,this.secondClock());case 138:return this.popNandPushIfOK(1,this.someObject());case 139:return this.popNandPushIfOK(1,this.nextObject(this.vm.top()));case 140:return this.primitiveBeep(e);case 141:return this.primitiveClipboardText(e);case 142:return this.popNandPushIfOK(1,this.makeStString(this.filenameToSqueak(Squeak.vmPath)));case 143:case 144:return this.primitiveShortAtAndPut(e);case 145:return this.primitiveConstantFill(e);case 146:return this.namedPrimitive("JoystickTabletPlugin","primitiveReadJoystick",e);case 147:return this.namedPrimitive("BitBltPlugin","primitiveWarpBits",e);case 148:return this.popNandPushIfOK(1,this.vm.image.clone(this.vm.top()));case 149:return this.primitiveGetAttribute(e);case 150:if(this.oldPrims)return this.primitiveFileAtEnd(e);case 151:if(this.oldPrims)return this.primitiveFileClose(e);case 152:if(this.oldPrims)return this.primitiveFileGetPosition(e);case 153:if(this.oldPrims)return this.primitiveFileOpen(e);case 154:if(this.oldPrims)return this.primitiveFileRead(e);case 155:if(this.oldPrims)return this.primitiveFileSetPosition(e);case 156:if(this.oldPrims)return this.primitiveFileDelete(e);case 157:if(this.oldPrims)return this.primitiveFileSize(e);case 158:if(this.oldPrims)return this.primitiveFileWrite(e);case 159:if(this.oldPrims)return this.primitiveFileRename(e);case 160:if(this.oldPrims)return this.primitiveDirectoryCreate(e);case 161:if(this.oldPrims)return this.primitiveDirectoryDelimitor(e);case 162:if(this.oldPrims)return this.primitiveDirectoryLookup(e);case 163:if(this.oldPrims)return this.primitiveDirectoryDelete(e);break;case 165:case 166:return this.primitiveIntegerAtAndPut(e);case 167:return!1;case 168:return this.primitiveCopyObject(e);case 169:return this.oldPrims?this.primitiveDirectorySetMacTypeAndCreator(e):this.primitiveNotIdentical(e);case 170:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStart",e);case 171:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStartWithSemaphore",e);case 172:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStop",e);case 173:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundAvailableSpace",e);case 174:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundPlaySamples",e);case 175:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundPlaySilence",e);case 176:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primWaveTableSoundmixSampleCountintostartingAtpan",e);case 177:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primFMSoundmixSampleCountintostartingAtpan",e);case 178:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primPluckedSoundmixSampleCountintostartingAtpan",e);case 179:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primSampledSoundmixSampleCountintostartingAtpan",e);case 180:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveMixFMSound",e);
case 181:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveMixPluckedSound",e);case 182:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","oldprimSampledSoundmixSampleCountintostartingAtleftVolrightVol",e);case 183:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveApplyReverb",e);case 184:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveMixLoopedSampledSound",e);case 185:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveMixSampledSound",e);break;case 188:if(!this.oldPrims)return this.primitiveExecuteMethodArgsArray(e);break;case 189:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundInsertSamples",e);case 190:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStartRecording",e);case 191:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStopRecording",e);case 192:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundGetRecordingSampleRate",e);case 193:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundRecordSamples",e);case 194:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundSetRecordLevel",e);break;case 195:return!1;case 196:return!1;case 197:return!1;case 198:return!1;case 199:return!1;case 200:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveInitializeNetwork",e):this.primitiveClosureCopyWithCopiedValues(e);case 201:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverStartNameLookup",e):this.primitiveClosureValue(e);case 202:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverNameLookupResult",e):this.primitiveClosureValue(e);case 203:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverStartAddressLookup",e):this.primitiveClosureValue(e);case 204:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverAddressLookupResult",e):this.primitiveClosureValue(e);case 205:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverAbortLookup",e):this.primitiveClosureValue(e);case 206:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverLocalAddress",e):this.primitiveClosureValueWithArgs(e);case 207:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveResolverStatus",e);case 208:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveResolverError",e);case 209:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketCreate",e);break;case 210:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketDestroy",e):this.popNandPushIfOK(2,this.objectAt(!1,!1,!1));case 211:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketConnectionStatus",e):this.popNandPushIfOK(3,this.objectAtPut(!1,!1,!1));case 212:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketError",e):this.popNandPushIfOK(1,this.objectSize(!1));case 213:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketLocalAddress",e);case 214:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketLocalPort",e);case 215:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketRemoteAddress",e);case 216:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketRemotePort",e);case 217:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketConnectToPort",e);case 218:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketListenOnPort",e);case 219:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketCloseConnection",e);case 220:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketAbortConnection",e);break;case 221:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketReceiveDataBufCount",e):this.primitiveClosureValueNoContextSwitch(e);case 222:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketReceiveDataAvailable",e):this.primitiveClosureValueNoContextSwitch(e);case 223:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketSendDataBufCount",e);case 224:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketSendDone",e);break;case 230:return this.primitiveRelinquishProcessorForMicroseconds(e);case 231:return this.primitiveForceDisplayUpdate(e);case 233:return this.primitiveSetFullScreen(e);case 234:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveDecompressFromByteArray",e);case 235:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveCompareString",e);case 236:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveConvert8BitSigned",e);case 237:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveCompressToByteArray",e);case 238:if(this.oldPrims)return this.namedPrimitive("SerialPlugin","primitiveSerialPortOpen",e);case 239:if(this.oldPrims)return this.namedPrimitive("SerialPlugin","primitiveSerialPortClose",e);break;case 240:return this.oldPrims?this.namedPrimitive("SerialPlugin","primitiveSerialPortWrite",e):this.popNandPushIfOK(1,this.microsecondClockUTC());case 241:return this.oldPrims?this.namedPrimitive("SerialPlugin","primitiveSerialPortRead",e):this.popNandPushIfOK(1,this.microsecondClockLocal());case 243:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveTranslateStringWithTable",e);case 244:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveFindFirstInString",e);case 245:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveIndexOfAsciiInString",e);case 246:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveFindSubstring",e);break;case 248:return this.vm.primitiveInvokeObjectAsMethod(e,i);case 249:return this.primitiveArrayBecome(e,!1);case 254:return this.primitiveVMParameter(e)}else switch(t){case 521:return this.namedPrimitive("MIDIPlugin","primitiveMIDIClosePort",e);case 522:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetClock",e);case 523:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetPortCount",e);case 524:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetPortDirectionality",e);case 525:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetPortName",e);case 526:return this.namedPrimitive("MIDIPlugin","primitiveMIDIOpenPort",e);case 527:return this.namedPrimitive("MIDIPlugin","primitiveMIDIParameterGetOrSet",e);case 528:return this.namedPrimitive("MIDIPlugin","primitiveMIDIRead",e);case 529:return this.namedPrimitive("MIDIPlugin","primitiveMIDIWrite",e);case 550:return this.namedPrimitive("ADPCMCodecPlugin","primitiveDecodeMono",e);case 551:return this.namedPrimitive("ADPCMCodecPlugin","primitiveDecodeStereo",e);case 552:return this.namedPrimitive("ADPCMCodecPlugin","primitiveEncodeMono",e);case 553:return this.namedPrimitive("ADPCMCodecPlugin","primitiveEncodeStereo",e);case 571:return this.primitiveUnloadModule(e);case 572:return this.primitiveListBuiltinModule(e);case 573:return this.primitiveListLoadedModule(e)}return console.error("primitive "+t+" not implemented yet"),!1},namedPrimitive:function(e,r,n){var t=""===e?this:this.loadedModules[e];void 0===t&&(t=this.loadModule(e),this.loadedModules[e]=t);var i=!1;if(t){this.interpreterProxy.argCount=n;var s=t[r];"function"==typeof s?i=t[r](n):"string"==typeof s?i=this[s](n):this.vm.warnOnce("missing primitive: "+e+"."+r)}else this.vm.warnOnce("missing module: "+e+" ("+r+")");return i===!0||i===!1?i:this.success},doNamedPrimitive:function(i,e){if(e.pointersSize()<2)return!1;var t=e.pointers[1];if(4!==t.pointersSize())return!1;this.primMethod=e;var r=t.pointers[0].bytesAsString(),n=t.pointers[1].bytesAsString();return this.namedPrimitive(r,n,i)},fakePrimitive:function(i,e,t){return this.vm.warnOnce("faking primitive: "+i),void 0===e?this.vm.popN(t):this.vm.popNandPush(t+1,this.makeStObject(e)),!0}},"modules",{loadModule:function(e){var t=Squeak.externalModules[e]||this.builtinModules[e];if(!t)return null;if(this.patchModules[e]&&this.patchModule(t,e),t.setInterpreter&&!t.setInterpreter(this.interpreterProxy))return console.log("Wrong interpreter proxy version: "+e),null;var i=t.initialiseModule;return"function"==typeof i?t.initialiseModule():"string"==typeof i&&this[i](),this.interpreterProxy.failed()?(console.log("Module initialization failed: "+e),null):(console.log("Loaded module: "+e),t)},patchModule:function(i,r){var e=this.patchModules[r];for(var t in e)i[t]=e[t]},unloadModule:function(t){var e=this.loadedModules[t];if(!t||!e||e===this)return null;delete this.loadedModules[t];var i=e.unloadModule;return"function"==typeof i?e.unloadModule(this):"string"==typeof i&&this[i](this),console.log("Unloaded module: "+t),e},loadFunctionFrom:function(r,t){var e=""===t?this:this.loadedModules[t];if(void 0===e&&(e=this.loadModule(t),this.loadedModules[t]=e),!e)return null;var i=e[r];return"function"==typeof i?i.bind(e):"string"==typeof i?this[i].bind(this):(this.vm.warnOnce("missing primitive: "+t+"."+r),null)},primitiveUnloadModule:function(t){var e=this.stackNonInteger(0).bytesAsString();return e?(this.unloadModule(e),this.popNIfOK(t)):!1},primitiveListBuiltinModule:function(e){var t=this.stackInteger(0)-1;if(!this.success)return!1;var i=Object.keys(this.builtinModules);return this.popNandPushIfOK(e+1,this.makeStObject(i[t]))},primitiveListLoadedModule:function(r){var n=this.stackInteger(0)-1;if(!this.success)return!1;var t=[];for(var i in this.loadedModules){var e=this.loadedModules[i];if(e){var s=e.getModuleName?e.getModuleName():i;t.push(s)}}return this.popNandPushIfOK(r+1,this.makeStObject(t[n]))}},"stack access",{popNIfOK:function(e){return this.success?(this.vm.popN(e),!0):!1},pop2andPushBoolIfOK:function(e){return this.vm.success=this.success,this.vm.pop2AndPushBoolResult(e)},popNandPushIfOK:function(t,e){return this.success&&null!=e?(this.vm.popNandPush(t,e),!0):!1},popNandPushIntIfOK:function(t,e){return this.success&&this.vm.canBeSmallInt(e)?this.popNandPushIfOK(t,e):!1},popNandPushFloatIfOK:function(e,t){return this.success?this.popNandPushIfOK(e,this.makeFloat(t)):!1},stackNonInteger:function(e){return this.checkNonInteger(this.vm.stackValue(e))},stackInteger:function(e){return this.checkSmallInt(this.vm.stackValue(e))},stackPos32BitInt:function(e){return this.positive32BitValueOf(this.vm.stackValue(e))},pos32BitIntFor:function(e){if(e>=0&&e<=Squeak.MaxSmallInt)return e;for(var r=this.vm.specialObjects[Squeak.splOb_ClassLargePositiveInteger],i=this.vm.instantiateClass(r,4),n=i.bytes,t=0;4>t;t++)n[t]=e>>>8*t&255;return i},pos64BitIntFor:function(e){if(4294967295>=e)return this.pos32BitIntFor(e);for(var i=0xffffffffff>=e?5:0xffffffffffff>=e?6:72057594037927940>=e?7:8,n=this.vm.specialObjects[Squeak.splOb_ClassLargePositiveInteger],r=this.vm.instantiateClass(n,i),s=r.bytes,t=0;i>t;t++)s[t]=255&e,e/=256;return r},stackSigned32BitInt:function(n){var e=this.vm.stackValue(n);if("number"==typeof e)return e;if(4!==e.bytesSize())return this.success=!1,0;for(var s=e.bytes,t=0,i=0,r=1;4>i;i++,r*=256)t+=s[i]*r;return this.isA(e,Squeak.splOb_ClassLargePositiveInteger)?t:this.isA(e,Squeak.splOb_ClassLargeNegativeInteger)?-t:(this.success=!1,0)},signed32BitIntegerFor:function(e){if(e>=Squeak.MinSmallInt&&e<=Squeak.MaxSmallInt)return e;for(var i=0>e,n=i?-e:e,s=i?Squeak.splOb_ClassLargeNegativeInteger:Squeak.splOb_ClassLargePositiveInteger,r=this.vm.instantiateClass(this.vm.specialObjects[s],4),a=r.bytes,t=0;4>t;t++)a[t]=n>>>8*t&255;return r},stackFloat:function(e){return this.checkFloat(this.vm.stackValue(e))},stackBoolean:function(e){return this.checkBoolean(this.vm.stackValue(e))},stackSigned53BitInt:function(s){var e=this.vm.stackValue(s);if("number"==typeof e)return e;var r=e.bytesSize();if(7>=r){for(var a=e.bytes,t=0,i=0,n=1;r>i;i++,n*=256)t+=a[i]*n;if(9007199254740992>t){if(this.isA(e,Squeak.splOb_ClassLargePositiveInteger))return t;if(this.isA(e,Squeak.splOb_ClassLargeNegativeInteger))return-t}}return this.success=!1,0}},"numbers",{doBitAnd:function(){var e=this.stackPos32BitInt(1),t=this.stackPos32BitInt(0);return this.success?this.pos32BitIntFor(e&t):0},doBitOr:function(){var e=this.stackPos32BitInt(1),t=this.stackPos32BitInt(0);return this.success?this.pos32BitIntFor(e|t):0},doBitXor:function(){var e=this.stackPos32BitInt(1),t=this.stackPos32BitInt(0);return this.success?this.pos32BitIntFor(e^t):0},doBitShift:function(){var e=this.stackPos32BitInt(1),t=this.stackInteger(0);if(!this.success)return 0;var i=this.vm.safeShift(e,t);return i>0?this.pos32BitIntFor(this.vm.safeShift(e,t)):(this.success=!1,0)},safeFDiv:function(t,e){return 0===e?(this.success=!1,1):t/e},floatAsSmallInt:function(e){var t=e>=0?Math.floor(e):Math.ceil(e);return this.ensureSmallInt(t)},frexp_exponent:function(t){if(0==t)return 0;var e=new DataView(new ArrayBuffer(8));e.setFloat64(0,t);var i=e.getUint32(0)>>>20&2047;0===i&&(e.setFloat64(0,t*Math.pow(2,64)),i=(e.getUint32(0)>>>20&2047)-64);var r=i-1022;return r},ldexp:function(t,e){return e>1023?t*Math.pow(2,1023)*Math.pow(2,e-1023):-1074>e?t*Math.pow(2,-1074)*Math.pow(2,e+1074):t*Math.pow(2,e)},primitiveLessThanLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)<this.stackSigned53BitInt(0))},primitiveGreaterThanLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)>this.stackSigned53BitInt(0))},primitiveLessOrEqualLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)<=this.stackSigned53BitInt(0))},primitiveGreaterOrEqualLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)>=this.stackSigned53BitInt(0))},primitiveEqualLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)===this.stackSigned53BitInt(0))},primitiveNotEqualLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)!==this.stackSigned53BitInt(0))}},"utils",{floatOrInt:function(e){return e.isFloat?e["float"]:"number"==typeof e?e:0},positive32BitValueOf:function(e){if("number"==typeof e)return e>=0?e:(this.success=!1,0);if(!this.isA(e,Squeak.splOb_ClassLargePositiveInteger)||4!==e.bytesSize())return this.success=!1,0;for(var n=e.bytes,i=0,t=0,r=1;4>t;t++,r*=256)i+=n[t]*r;return i},checkFloat:function(e){return e.isFloat?e["float"]:"number"==typeof e?e:(this.success=!1,0)},checkSmallInt:function(e){return"number"==typeof e?e:(this.success=!1,0)},checkNonInteger:function(e){return"number"!=typeof e?e:(this.success=!1,this.vm.nilObj)},checkBoolean:function(e){return e.isTrue?!0:e.isFalse?!1:this.success=!1},indexableSize:function(e){if("number"==typeof e)return-1;var t=e.format;return 2>t?-1:3===t&&this.vm.isContext(e)&&!this.allowAccessBeyondSP?e.pointers[Squeak.Context_stackPointer]:6>t?e.pointersSize()-e.instSize():8>t?e.wordsSize():12>t?e.bytesSize():e.bytesSize()+4*e.pointersSize()},isA:function(e,t){return e.sqClass===this.vm.specialObjects[t]},isKindOf:function(t,i){for(var e=t.sqClass,r=this.vm.specialObjects[i];!e.isNil;){if(e===r)return!0;e=e.pointers[Squeak.Class_superclass]}return!1},isAssociation:function(e){return"number"!=typeof e&&2==e.pointersSize()},ensureSmallInt:function(e){return e===(0|e)&&this.vm.canBeSmallInt(e)?e:(this.success=!1,0)},charFromInt:function(e){var t=this.vm.specialObjects[Squeak.splOb_CharacterTable];return t.pointers[e]},makeFloat:function(t){var i=this.vm.specialObjects[Squeak.splOb_ClassFloat],e=this.vm.instantiateClass(i,2);return e["float"]=t,e},makeLargeIfNeeded:function(e){return this.vm.canBeSmallInt(e)?e:this.makeLargeInt(e)},makeLargeInt:function(e){if(0>e)throw Error("negative large ints not implemented yet");if(e>4294967295)throw Error("large large ints not implemented yet");return this.pos32BitIntFor(e)},makePointWithXandY:function(t,i){var r=this.vm.specialObjects[Squeak.splOb_ClassPoint],e=this.vm.instantiateClass(r,0);return e.pointers[Squeak.Point_x]=t,e.pointers[Squeak.Point_y]=i,e},makeStArray:function(t,r){for(var i=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassArray],t.length),e=0;e<t.length;e++)i.pointers[e]=this.makeStObject(t[e],r);return i},makeStString:function(i){for(var e=[],t=0;t<i.length;++t)e.push(255&i.charCodeAt(t));var r=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassString],e.length);return r.bytes=e,r},makeStObject:function(e,t){if(void 0===e||null===e)return this.vm.nilObj;if(e===!0)return this.vm.trueObj;if(e===!1)return this.vm.falseObj;if(e.sqClass)return e;if("number"==typeof e)return e===(0|e)?this.makeLargeIfNeeded(e):this.makeFloat(e);if(t){var i=this.vm.instantiateClass(t,0);return i.jsObject=e,i}if("string"==typeof e||e.constructor===Uint8Array)return this.makeStString(e);if(e.constructor===Array)return this.makeStArray(e);throw Error("cannot make smalltalk object")},pointsTo:function(e,t){return e.pointers?e.pointers.indexOf(t)>=0:!1},asUint8Array:function(e){if(e.constructor===Uint8Array)return e;if(e.constructor===ArrayBuffer)return new Uint8Array(e);if("string"==typeof e){for(var i=new Uint8Array(e.length),t=0;t<e.length;t++)i[t]=e.charCodeAt(t);return i}throw Error("unknown buffer type")},filenameToSqueak:function(t){var i="/"!==t[0]?"/":"",e="/SqueakJS"+i+t;return this.emulateMac&&(e=("Macintosh HD"+e).replace(/\//g,"â‚¬").replace(/:/g,"/").replace(/â‚¬/g,":")),e},filenameFromSqueak:function(e){var t=this.emulateMac?e.replace(/^[^:]*:/,":").replace(/\//g,"â‚¬").replace(/:/g,"/").replace(/â‚¬/g,":"):e;return t=t.replace(/^\/*SqueakJS\/?/,"/")}},"indexing",{objectAt:function(a,o,r){var e=this.stackNonInteger(1),t=this.stackPos32BitInt(0);if(!this.success)return e;var i;if(a){if(i=this.atCache[e.hash&this.atCacheMask],i.array!==e)return this.success=!1,e}else{if(e.isFloat){var n=e.floatData();return 1==t?this.pos32BitIntFor(n.getUint32(0,!1)):2==t?this.pos32BitIntFor(n.getUint32(4,!1)):(this.success=!1,e)}i=this.makeAtCacheInfo(this.atCache,this.vm.specialSelectors[32],e,o,r)}if(1>t||t>i.size)return this.success=!1,e;if(r)return e.pointers[t-1];if(e.format<6)return e.pointers[t-1+i.ivarOffset];if(e.format<8)return this.pos32BitIntFor(e.words[t-1]);if(e.format<12)return i.convertChars?this.charFromInt(255&e.bytes[t-1]):255&e.bytes[t-1];var s=4*e.pointersSize();return 0>t-1-s?(this.success=!1,e):255&e.bytes[t-1-s]},objectAtPut:function(c,s,u){var e=this.stackNonInteger(2),i=this.stackPos32BitInt(1);if(!this.success)return e;var n;if(c){if(n=this.atPutCache[e.hash&this.atCacheMask],n.array!==e)return this.success=!1,e}else{if(e.isFloat){var l=this.stackPos32BitInt(0);if(!this.success||1!=i&&2!=i)this.success=!1;else{var o=e.floatData();o.setUint32(1==i?0:4,l,!1),e["float"]=o.getFloat64(0)}return this.vm.stackValue(0)}n=this.makeAtCacheInfo(this.atPutCache,this.vm.specialSelectors[34],e,s,u)}if(1>i||i>n.size)return this.success=!1,e;var t=this.vm.stackValue(0);if(u)return e.pointers[i-1]=t;if(e.format<6)return e.pointers[i-1+n.ivarOffset]=t;var r;if(e.format<8)return r=this.stackPos32BitInt(0),this.success&&(e.words[i-1]=r),t;if(s){if(t.sqClass!==this.vm.specialObjects[Squeak.splOb_ClassCharacter])return this.success=!1,t;if(r=t.pointers[0],"number"!=typeof r)return this.success=!1,t}else{if("number"!=typeof t)return this.success=!1,t;r=t}if(0>r||r>255)return this.success=!1,t;if(e.format<8)return e.bytes[i-1]=r;var a=4*e.pointersSize();return 0>i-1-a?(this.success=!1,e):(e.bytes[i-1-a]=r,t)},objectSize:function(i){var e=this.vm.stackValue(0),t=-1;return i?e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassArray]?t=e.pointersSize():e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassString]&&(t=e.bytesSize()):t=this.indexableSize(e),-1===t?(this.success=!1,-1):this.pos32BitIntFor(t)},initAtCache:function(){this.atCacheSize=32,this.atCacheMask=this.atCacheSize-1,this.atCache=[],this.atPutCache=[],this.nonCachedInfo={};for(var e=0;e<this.atCacheSize;e++)this.atCache.push({}),this.atPutCache.push({})},clearAtCache:function(){this.nonCachedInfo.array=null;for(var e=0;e<this.atCacheSize;e++)this.atCache[e].array=null,this.atPutCache[e].array=null},makeAtCacheInfo:function(i,r,e,n,s){var t,a=this.vm.verifyAtSelector===r&&this.vm.verifyAtClass===e.sqClass&&!(3===e.format&&this.vm.isContext(e));return t=a?i[e.hash&this.atCacheMask]:this.nonCachedInfo,t.array=e,t.convertChars=n,s?(t.size=e.instSize()+Math.max(0,this.indexableSize(e)),t.ivarOffset=0):(t.size=this.indexableSize(e),t.ivarOffset=e.format<6?e.instSize():0),t}},"basic",{instantiateClass:function(t,e){return 4*e>this.vm.image.bytesLeft()?(console.warn("squeak: out of memory"),this.success=!1,null):this.vm.instantiateClass(t,e)},someObject:function(){return this.vm.image.firstOldObject},nextObject:function(e){return this.vm.image.objectAfter(e)||0},someInstanceOf:function(t){var e=this.vm.image.someInstanceOf(t);return e?e:(this.success=!1,0)},nextInstanceAfter:function(t){var e=this.vm.image.nextInstanceAfter(t);return e?e:(this.success=!1,0)},primitiveFullGC:function(t){this.vm.image.fullGC("primitive");var e=this.vm.image.bytesLeft();return this.popNandPushIfOK(1,this.makeLargeIfNeeded(e))},primitiveMakePoint:function(i,r){var e=this.vm.stackValue(1),t=this.vm.stackValue(0);return r&&(this.checkFloat(e),this.checkFloat(t),!this.success)?!1:(this.vm.popNandPush(1+i,this.makePointWithXandY(e,t)),!0)},primitiveStoreStackp:function(r){var e=this.stackNonInteger(1),t=this.stackInteger(0);if(!this.success||0>t||this.vm.decodeSqueakSP(t)>=e.pointers.length)return!1;for(var i=e.pointers[Squeak.Context_stackPointer];t>i;)e.pointers[this.vm.decodeSqueakSP(++i)]=this.vm.nilObj;return e.pointers[Squeak.Context_stackPointer]=t,this.vm.popN(r),!0},primitiveChangeClass:function(i){if(1!==i)return!1;var e=this.stackNonInteger(1),t=this.stackNonInteger(0);return this.success?e.format!==t.format||e.sqClass.isCompact!==t.sqClass.isCompact||e.sqClass.classInstSize()!==t.sqClass.classInstSize()?!1:(e.sqClass=t.sqClass,this.popNIfOK(1)):!1},primitiveDoPrimitiveWithArgs:function(s){var t=this.stackNonInteger(0),r=this.stackInteger(1);if(!this.success)return!1;var e=t.pointersSize(),n=this.vm.activeContext.pointersSize();if(this.vm.sp+e>=n)return!1;this.vm.popN(2);for(var i=0;e>i;i++)this.vm.push(t.pointers[i]);return this.vm.tryPrimitive(r,e)?!0:(this.vm.popN(e),this.vm.push(r),this.vm.push(t),!1)},primitiveShortAtAndPut:function(t){var n=this.stackNonInteger(t),i=this.stackInteger(t-1)-1,r=n.wordsAsInt16Array();if(!this.success||!r||0>i||i>=r.length)return!1;var e;if(2>t)e=r[i];else{if(e=this.stackInteger(0),-32768>e||e>32767)return!1;r[i]=e}return this.popNandPushIfOK(t+1,e),!0},primitiveIntegerAtAndPut:function(e){var n=this.stackNonInteger(e),t=this.stackInteger(e-1)-1,i=n.wordsAsInt32Array();if(!this.success||!i||0>t||t>=i.length)return!1;var r;if(2>e)r=this.signed32BitIntegerFor(i[t]);else{if(r=this.stackSigned32BitInt(0),!this.success)return!1;i[t]=r}return this.popNandPushIfOK(e+1,r),!0},primitiveConstantFill:function(n){var e=this.stackNonInteger(1),r=this.stackPos32BitInt(0);if(!this.success||!e.isWordsOrBytes())return!1;var t=e.words||e.bytes;if(t){if(t===e.bytes&&r>255)return!1;for(var i=0;i<t.length;i++)t[i]=r}return this.vm.popN(n),!0},primitiveNewMethod:function(r){var t=this.stackInteger(0),n=this.stackInteger(1);if(!this.success)return 0;var s=t>>9&255,e=this.vm.instantiateClass(this.vm.stackValue(2),n);e.pointers=[t];for(var i=0;s>i;i++)e.pointers.push(this.vm.nilObj);return this.vm.popNandPush(1+r,e),this.vm.breakOnNewMethod&&(this.vm.breakOnMethod=e),!0},primitiveExecuteMethodArgsArray:function(r){var e=this.stackNonInteger(0),n=this.stackNonInteger(1),s=this.vm.stackValue(2);if(!this.success||!this.vm.isMethod(e)||r>4)return!1;var t=e.methodNumArgs();if(t!==n.pointersSize())return!1;this.vm.popNandPush(r+1,s);for(var i=0;t>i;i++)this.vm.push(n.pointers[i]);return this.vm.executeNewMethod(s,e,t,e.methodPrimitiveIndex(),null,null),!0},primitiveArrayBecome:function(e,t){var i=this.stackNonInteger(e),r=this.stackNonInteger(e-1),n=e>1?this.stackBoolean(e-2):!0;return this.success?(this.success=this.vm.image.bulkBecome(i.pointers,r.pointers,t,n),this.popNIfOK(e)):!1},doStringReplace:function(){var e=this.stackNonInteger(4),i=this.stackInteger(3)-1,n=this.stackInteger(2)-i,a=this.stackNonInteger(1),r=this.stackInteger(0)-1;if(!this.success)return e;var o=a.format,u=e.format;if(8>u){if(u!=o)return this.success=!1,e;if((12&u)!=(12&o))return this.success=!1,e}if(4>o){var s=a.pointersSize(),l=a.instSize();if(r+=l,0>r||r+n>s)return this.success=!1,e;s=e.pointersSize();var c=e.instSize();if(i+=c,0>i||i+n>s)return this.success=!1,e;for(var t=0;n>t;t++)e.pointers[i+t]=a.pointers[r+t];return e}if(8>o){var s=a.wordsSize();if(0>r||r+n>s)return this.success=!1,e;if(s=e.wordsSize(),0>i||i+n>s)return this.success=!1,e;for(var t=0;n>t;t++)e.words[i+t]=a.words[r+t];return e}var s=a.bytesSize();if(0>r||r+n>s)return this.success=!1,e;if(s=e.bytesSize(),0>i||i+n>s)return this.success=!1,e;for(var t=0;n>t;t++)e.bytes[i+t]=a.bytes[r+t];return e},primitiveCopyObject:function(n){var e=this.stackNonInteger(1),i=this.stackNonInteger(0),r=e.pointersSize();if(!this.success||e.isWordsOrBytes()||e.sqClass!==i.sqClass||r!==i.pointersSize())return!1;for(var t=0;r>t;t++)i.pointers[t]=e.pointers[t];return this.vm.pop(n),!0},primitiveLoadImageSegment:function(r){var e=this.stackNonInteger(1),t=this.stackNonInteger(0);if(!e.words||!t.pointers)return!1;var i=this.vm.image.loadImageSegment(e,t);return i?this.popNandPushIfOK(r+1,i):!1}},"blocks/closures",{doBlockCopy:function(){var i=this.vm.stackValue(1),n=this.stackInteger(0),e=i;if(this.vm.isContext(e)||(this.success=!1),!this.success)return i;"number"==typeof e.pointers[Squeak.Context_method]&&(e=e.pointers[Squeak.BlockContext_home]);var s=e.pointersSize()-e.instSize(),t=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassBlockContext],s),r=this.vm.encodeSqueakPC(this.vm.pc+2,this.vm.method);return t.pointers[Squeak.BlockContext_initialIP]=r,t.pointers[Squeak.Context_instructionPointer]=r,t.pointers[Squeak.Context_stackPointer]=0,t.pointers[Squeak.BlockContext_argumentCount]=n,t.pointers[Squeak.BlockContext_home]=e,t.pointers[Squeak.Context_sender]=this.vm.nilObj,t},primitiveBlockValue:function(t){var i=this.vm.stackValue(t);if(!this.isA(i,Squeak.splOb_ClassBlockContext))return!1;var e=i,r=e.pointers[Squeak.BlockContext_argumentCount];if("number"!=typeof r)return!1;if(r!=t)return!1;if(!e.pointers[Squeak.BlockContext_caller].isNil)return!1;this.vm.arrayCopy(this.vm.activeContext.pointers,this.vm.sp-t+1,e.pointers,Squeak.Context_tempFrameStart,t);var n=e.pointers[Squeak.BlockContext_initialIP];return e.pointers[Squeak.Context_instructionPointer]=n,e.pointers[Squeak.Context_stackPointer]=t,e.pointers[Squeak.BlockContext_caller]=this.vm.activeContext,this.vm.popN(t+1),this.vm.newActiveContext(e),!0},primitiveBlockValueWithArgs:function(r){var e=this.vm.stackValue(1),i=this.vm.stackValue(0);if(!this.isA(e,Squeak.splOb_ClassBlockContext))return!1;if(!this.isA(i,Squeak.splOb_ClassArray))return!1;var t=e.pointers[Squeak.BlockContext_argumentCount];if("number"!=typeof t)return!1;if(t!=i.pointersSize())return!1;if(!e.pointers[Squeak.BlockContext_caller].isNil)return!1;this.vm.arrayCopy(i.pointers,0,e.pointers,Squeak.Context_tempFrameStart,t);var n=e.pointers[Squeak.BlockContext_initialIP];return e.pointers[Squeak.Context_instructionPointer]=n,e.pointers[Squeak.Context_stackPointer]=t,e.pointers[Squeak.BlockContext_caller]=this.vm.activeContext,this.vm.popN(r+1),this.vm.newActiveContext(e),!0},primitiveClosureCopyWithCopiedValues:function(e){return this.vm.breakNow("primitiveClosureCopyWithCopiedValues"),!1},primitiveClosureValue:function(e){var t=this.vm.stackValue(e),i=t.pointers[Squeak.Closure_numArgs];return e!==i?!1:this.activateNewClosureMethod(t,e)},primitiveClosureValueWithArgs:function(n){var i=this.vm.top(),e=i.pointersSize(),r=this.vm.stackValue(n),s=r.pointers[Squeak.Closure_numArgs];if(e!==s)return!1;this.vm.pop();for(var t=0;e>t;t++)this.vm.push(i.pointers[t]);return this.activateNewClosureMethod(r,e)},primitiveClosureValueNoContextSwitch:function(e){return this.primitiveClosureValue(e)},activateNewClosureMethod:function(i,r){var n=i.pointers[Squeak.Closure_outerContext],o=n.pointers[Squeak.Context_method],e=this.vm.allocateOrRecycleContext(o.methodNeedsLargeFrame()),s=i.pointers.length-Squeak.Closure_firstCopiedValue;e.pointers[Squeak.Context_sender]=this.vm.activeContext,e.pointers[Squeak.Context_instructionPointer]=i.pointers[Squeak.Closure_startpc],e.pointers[Squeak.Context_stackPointer]=r+s,e.pointers[Squeak.Context_method]=n.pointers[Squeak.Context_method],e.pointers[Squeak.Context_closure]=i,e.pointers[Squeak.Context_receiver]=n.pointers[Squeak.Context_receiver];for(var a=Squeak.Context_tempFrameStart,t=0;r>t;t++)e.pointers[a++]=this.vm.stackValue(r-t-1);for(var t=0;s>t;t++)e.pointers[a++]=i.pointers[Squeak.Closure_firstCopiedValue+t];return this.vm.popN(r+1),this.vm.newActiveContext(e),!0}},"scheduling",{primitiveResume:function(){return this.resume(this.vm.top()),!0},primitiveSuspend:function(){var e=this.getScheduler().pointers[Squeak.ProcSched_activeProcess];return this.vm.top()!==e?!1:(this.vm.popNandPush(1,this.vm.nilObj),this.transferTo(this.pickTopProcess()),!0)},getScheduler:function(){var e=this.vm.specialObjects[Squeak.splOb_SchedulerAssociation];return e.pointers[Squeak.Assn_value]},resume:function(e){var t=this.getScheduler().pointers[Squeak.ProcSched_activeProcess],i=t.pointers[Squeak.Proc_priority],r=e.pointers[Squeak.Proc_priority];r>i?(this.putToSleep(t),this.transferTo(e)):this.putToSleep(e)},putToSleep:function(e){var t=e.pointers[Squeak.Proc_priority],i=this.getScheduler().pointers[Squeak.ProcSched_processLists],r=i.pointers[t-1];this.linkProcessToList(e,r)},transferTo:function(e){var t=this.getScheduler(),i=t.pointers[Squeak.ProcSched_activeProcess];t.pointers[Squeak.ProcSched_activeProcess]=e,i.pointers[Squeak.Proc_suspendedContext]=this.vm.activeContext,this.vm.newActiveContext(e.pointers[Squeak.Proc_suspendedContext]),e.pointers[Squeak.Proc_suspendedContext]=this.vm.nilObj,this.vm.reclaimableContextCount=0,this.vm.breakOnContextChanged&&(this.vm.breakOnContextChanged=!1,this.vm.breakNow())},pickTopProcess:function(){var e,t=this.getScheduler().pointers[Squeak.ProcSched_processLists],i=t.pointersSize()-1;do{if(0>i)throw Error("scheduler could not find a runnable process");e=t.pointers[i--]}while(this.isEmptyList(e));return this.removeFirstLinkOfList(e)},linkProcessToList:function(t,e){if(this.isEmptyList(e))e.pointers[Squeak.LinkedList_firstLink]=t;else{var i=e.pointers[Squeak.LinkedList_lastLink];i.pointers[Squeak.Link_nextLink]=t}e.pointers[Squeak.LinkedList_lastLink]=t,t.pointers[Squeak.Proc_myList]=e},isEmptyList:function(e){return e.pointers[Squeak.LinkedList_firstLink].isNil},removeFirstLinkOfList:function(e){var t=e.pointers[Squeak.LinkedList_firstLink],i=e.pointers[Squeak.LinkedList_lastLink];if(t===i)e.pointers[Squeak.LinkedList_firstLink]=this.vm.nilObj,e.pointers[Squeak.LinkedList_lastLink]=this.vm.nilObj;else{var r=t.pointers[Squeak.Link_nextLink];e.pointers[Squeak.LinkedList_firstLink]=r}return t.pointers[Squeak.Link_nextLink]=this.vm.nilObj,t},registerSemaphore:function(e){var t=this.vm.top();return this.isA(t,Squeak.splOb_ClassSemaphore)?this.vm.specialObjects[e]=t:this.vm.specialObjects[e]=this.vm.nilObj,this.vm.stackValue(1)},primitiveWait:function(){var e=this.vm.top();if(!this.isA(e,Squeak.splOb_ClassSemaphore))return!1;var t=e.pointers[Squeak.Semaphore_excessSignals];if(t>0)e.pointers[Squeak.Semaphore_excessSignals]=t-1;else{var i=this.getScheduler().pointers[Squeak.ProcSched_activeProcess];this.linkProcessToList(i,e),this.transferTo(this.pickTopProcess())}return!0},primitiveSignal:function(){var e=this.vm.top();return this.isA(e,Squeak.splOb_ClassSemaphore)?(this.synchronousSignal(e),
!0):!1},synchronousSignal:function(e){this.isEmptyList(e)?e.pointers[Squeak.Semaphore_excessSignals]++:this.resume(this.removeFirstLinkOfList(e))},primitiveSignalAtMilliseconds:function(t){var i=this.stackInteger(0),e=this.stackNonInteger(1);this.stackNonInteger(2);return this.success?(this.isA(e,Squeak.splOb_ClassSemaphore)?(this.vm.specialObjects[Squeak.splOb_TheTimerSemaphore]=e,this.vm.nextWakeupTick=i):(this.vm.specialObjects[Squeak.splOb_TheTimerSemaphore]=this.vm.nilObj,this.vm.nextWakeupTick=0),this.vm.popN(t),!0):!1},signalSemaphoreWithIndex:function(e){this.semaphoresToSignal.push(e)},signalExternalSemaphores:function(){for(var t=this.vm.specialObjects[Squeak.splOb_ExternalObjectsArray].pointers,i=this.vm.specialObjects[Squeak.splOb_ClassSemaphore];this.semaphoresToSignal.length;){var r=this.semaphoresToSignal.shift(),e=t[r-1];e.sqClass==i&&this.synchronousSignal(e)}}},"vm functions",{primitiveGetAttribute:function(t){var i=this.stackInteger(0);if(!this.success)return!1;var e;switch(i){case 0:e=this.filenameToSqueak(Squeak.vmPath+Squeak.vmFile);break;case 1:e=this.display.documentName||null;break;case 2:e=this.display.documentName||null;break;case 1001:e=Squeak.platformName;break;case 1002:e=Squeak.osVersion;break;case 1003:e=Squeak.platformSubtype;break;case 1004:e=Squeak.vmVersion;break;case 1005:e=Squeak.windowSystem;break;case 1006:e=Squeak.vmBuild;break;case 1007:e=Squeak.vmVersion;break;case 1009:e=Squeak.vmVersion;break;default:return!1}return this.vm.popNandPush(t+1,this.makeStObject(e)),!0},setLowSpaceThreshold:function(){var e=this.stackInteger(0);return this.success&&(this.vm.lowSpaceThreshold=e),this.vm.stackValue(1)},primitiveVMParameter:function(r){var t=41;switch(r){case 0:for(var i=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassArray],t),e=0;t>e;e++)i.pointers[e]=this.makeStObject(this.vmParameterAt(e+1));return this.popNandPushIfOK(1,i);case 1:var n=this.stackInteger(0);return this.popNandPushIfOK(2,this.makeStObject(this.vmParameterAt(n)));case 2:return this.popNandPushIfOK(3,0)}return!1},vmParameterAt:function(e){switch(e){case 1:return this.vm.image.oldSpaceBytes;case 2:return this.vm.image.oldSpaceBytes;case 3:return this.vm.image.totalMemory;case 4:return this.vm.image.allocationCount+this.vm.image.newSpaceCount;case 7:return this.vm.image.gcCount;case 8:return this.vm.image.gcMilliseconds;case 9:return 1;case 10:return 0;case 11:return this.vm.image.gcTenured;case 40:return 4;case 41:return this.vm.image.formatVersion()}return null},primitiveImageName:function(e){return 0==e?this.popNandPushIfOK(1,this.makeStString(this.filenameToSqueak(this.vm.image.name))):(this.vm.image.name=this.filenameFromSqueak(this.vm.top().bytesAsString()),window.localStorage.squeakImageName=this.vm.image.name,!0)},primitiveSnapshot:function(i){this.vm.popNandPush(1,this.vm.trueObj),this.vm.storeContextRegisters();var e=this.getScheduler().pointers[Squeak.ProcSched_activeProcess];e.pointers[Squeak.Proc_suspendedContext]=this.vm.activeContext,this.vm.image.fullGC("snapshot");var t=this.vm.image.writeToBuffer();return Squeak.flushAllFiles(),Squeak.filePut(this.vm.image.name,t),this.vm.popNandPush(1,this.vm.falseObj),!0},primitiveQuit:function(e){return Squeak.flushAllFiles(),this.display.quitFlag=!0,this.vm.breakNow("quit"),!0},primitiveExitToDebugger:function(e){return this.vm.breakNow("debugger primitive"),!0},primitiveSetGCBiasToGrow:function(e){return this.fakePrimitive(".primitiveSetGCBiasToGrow",0,e)},primitiveSetGCBiasToGrowGCLimit:function(e){return this.fakePrimitive(".primitiveSetGCBiasToGrowGCLimit",0,e)}},"display",{primitiveBeCursor:function(t){if(this.display.cursorCanvas){var e=this.loadForm(this.stackNonInteger(t),!0),s=1===t?this.loadForm(this.stackNonInteger(0)):null;if(!this.success||!e)return!1;var i=this.display.cursorCanvas,r=i.getContext("2d"),n={left:0,top:0,right:e.width,bottom:e.height};i.width=e.width,i.height=e.height,1===e.depth?s?(e=this.cursorMergeMask(e,s),this.showForm(r,e,n,[0,4278190335,4294967295,4278190080])):this.showForm(r,e,n,[0,4278190080]):this.showForm(r,e,n,!0),this.display.cursorOffsetX=e.offsetX,this.display.cursorOffsetY=e.offsetY}return this.vm.popN(t),!0},cursorMergeMask:function(t,a){for(var s=new Uint32Array(16),e=0;16>e;e++){for(var o=t.bits[e],u=a.bits[e],r=2147483648,n=0,i=0;16>i;i++)n=n|(u&r)>>i|(o&r)>>i+1,r>>>=1;s[e]=n}return{obj:t.obj,bits:s,depth:2,width:16,height:16,offsetX:t.offsetX,offsetY:t.offsetY,msb:!0,pixPerWord:16,pitch:1}},primitiveBeDisplay:function(e){var t=this.vm.stackValue(0);return this.vm.specialObjects[Squeak.splOb_TheDisplay]=t,this.vm.popN(e),!0},primitiveReverseDisplay:function(e){return this.reverseDisplay=!this.reverseDisplay,this.redrawDisplay(),!0},primitiveShowDisplayRect:function(e){var t={left:this.stackInteger(3),top:this.stackInteger(1),right:this.stackInteger(2),bottom:this.stackInteger(0)};return this.success?(this.redrawDisplay(t),this.vm.popN(e),!0):!1},redrawDisplay:function(t){var i=this.theDisplay(),e={left:0,top:0,right:i.width,bottom:i.height};t&&(t.left>e.left&&(e.left=t.left),t.right<e.right&&(e.right=t.right),t.top>e.top&&(e.top=t.top),t.bottom<e.bottom&&(e.bottom=t.bottom)),e.left<e.right&&e.top<e.bottom&&this.displayUpdate(i,e)},showForm:function(S,e,s,g){if(s){var o=s.left,r=s.top,h=s.right-o,f=s.bottom-r,n=S.createImageData(h,f),c=n.data;c.buffer||(c=new Uint8Array(h*f*4));var v=new Uint32Array(c.buffer);switch(e.depth){case 1:case 2:case 4:case 8:var i=g||this.swappedColors;if(!i){i=[];for(var m=0;256>m;m++){var a=this.indexedColors[m],y=(4278255360&a)+((16711680&a)>>16)+((255&a)<<16);i[m]=y}this.swappedColors=i}this.reverseDisplay&&!g&&(this.reversedColors||(this.reversedColors=i.map(function(e){return 16777215^e})),i=this.reversedColors);for(var O=(1<<e.depth)-1,F=32-(o%e.pixPerWord+1)*e.depth,t=0;f>t;t++){for(var p=e.pitch*r+(o/e.pixPerWord|0),l=F,d=e.bits[p],b=n.width*t,u=0;h>u;u++)v[b++]=i[d>>>l&O],(l-=e.depth)<0&&(l=32-e.depth,d=e.bits[++p]);r++}break;case 16:for(var F=o%2?0:16,t=0;f>t;t++){for(var p=e.pitch*r+(o/2|0),l=F,d=e.bits[p],b=n.width*t,u=0;h>u;u++){var k=d>>>l;v[b++]=((31744&k)>>7)+((992&k)<<6)+((31&k)<<19)+4278190080,(l-=16)<0&&(l=16,d=e.bits[++p])}r++}break;case 32:for(var I=g?0:4278190080,t=0;f>t;t++){for(var p=e.pitch*r+o,b=n.width*t,u=0;h>u;u++){var a=e.bits[p++],y=4278255360&a|(16711680&a)>>16|(255&a)<<16|I;v[b++]=y}r++}break;default:throw Error("depth not implemented")}n.data!==c&&n.data.set(c),S.putImageData(n,s.left,s.top)}},primitiveDeferDisplayUpdates:function(e){var t=this.stackBoolean(0);return this.success?(this.deferDisplayUpdates=t,this.vm.popN(e),!0):!1},primitiveForceDisplayUpdate:function(e){return this.vm.breakOut(),this.vm.popN(e),!0},primitiveScreenSize:function(t){var e=this.display,i=e.width||e.context.canvas.width,r=e.height||e.context.canvas.height;return this.popNandPushIfOK(t+1,this.makePointWithXandY(i,r))},primitiveSetFullScreen:function(t){var e=this.stackBoolean(0);if(!this.success)return!1;if(this.display.fullscreen!=e)if(this.display.fullscreenRequest){var i=this.vm.freeze();this.display.fullscreenRequest(e,function(){i()})}else this.display.fullscreen=e,this.vm.breakOut();return this.vm.popN(t),!0},primitiveTestDisplayDepth:function(t){var e=[1,2,4,8,16,32];return this.pop2andPushBoolIfOK(e.indexOf(this.stackInteger(0))>=0)},loadForm:function(t,r){if(t.isNil)return null;var e={obj:t,bits:t.pointers[Squeak.Form_bits].wordsOrBytes(),depth:t.pointers[Squeak.Form_depth],width:t.pointers[Squeak.Form_width],height:t.pointers[Squeak.Form_height]};if(r){var i=t.pointers[Squeak.Form_offset];e.offsetX=i.pointers?i.pointers[Squeak.Point_x]:0,e.offsetY=i.pointers?i.pointers[Squeak.Point_y]:0}return 0===e.width||0===e.height?e:e.width>0&&e.height>0?(e.msb=e.depth>0,e.msb||(e.depth=-e.depth),e.depth>0?(e.pixPerWord=32/e.depth,e.pitch=(e.width+(e.pixPerWord-1))/e.pixPerWord|0,e.bits.length!==e.pitch*e.height?null:e):null):null},theDisplay:function(){return this.loadForm(this.vm.specialObjects[Squeak.splOb_TheDisplay])},displayDirty:function(e,t){this.deferDisplayUpdates||e!=this.vm.specialObjects[Squeak.splOb_TheDisplay]||this.displayUpdate(this.theDisplay(),t)},displayUpdate:function(e,t){this.showForm(this.display.context,e,t),this.display.lastTick=this.vm.lastTick,this.display.idle=0},primitiveBeep:function(i){var e=Squeak.startAudioOut();if(e){var t=e.createOscillator();t.connect(e.destination),t.frequency.value=880,t.noteOn(0),t.noteOff(e.currentTime+.2)}else this.vm.warnOnce("could not initialize audio");return this.popNIfOK(i)}},"input",{primitiveClipboardText:function(e){if(0===e){if("string"!=typeof this.display.clipboardString)return!1;this.vm.popNandPush(1,this.makeStString(this.display.clipboardString))}else if(1===e){var t=this.vm.top();t.bytes&&(this.display.clipboardString=t.bytesAsString(),this.display.clipboardStringChanged=!0),this.vm.pop()}return!0},primitiveKeyboardNext:function(e){return this.popNandPushIfOK(e+1,this.ensureSmallInt(this.display.keys.shift()))},primitiveKeyboardPeek:function(e){var t=this.display.keys.length;return this.popNandPushIfOK(e+1,t?this.ensureSmallInt(this.display.keys[0]||0):this.vm.nilObj)},primitiveMouseButtons:function(e){return this.popNandPushIfOK(e+1,this.ensureSmallInt(this.display.buttons)),this.vm.breakOut(),this.display.idle++>20&&this.vm.goIdle(),!0},primitiveMousePoint:function(e){var t=this.ensureSmallInt(this.display.mouseX),i=this.ensureSmallInt(this.display.mouseY);return this.popNandPushIfOK(e+1,this.makePointWithXandY(t,i))},primitiveInputSemaphore:function(t){var e=this.stackInteger(0);return this.success?(this.inputEventSemaIndex=e,this.display.signalInputEvent=function(){this.signalSemaphoreWithIndex(this.inputEventSemaIndex)}.bind(this),!0):!1},primitiveInputWord:function(e){return this.popNandPushIfOK(1,0)},primitiveGetNextEvent:function(t){this.display.idle++;var e=this.stackNonInteger(0);return this.display.getNextEvent?(this.display.getNextEvent(e.pointers,this.vm.startupTime),!0):!1}},"time",{primitiveRelinquishProcessorForMicroseconds:function(e){return this.vm.pop(e),this.vm.goIdle(),!0},millisecondClockValue:function(){return Date.now()-this.vm.startupTime&Squeak.MillisecondClockMask},millisecondClockValueSet:function(e){this.vm.startupTime=Date.now()-e},secondClock:function(){return this.pos32BitIntFor(Squeak.totalSeconds())},microsecondClockUTC:function(){var e=Date.now()-Squeak.EpochUTC;return this.pos64BitIntFor(1e3*e)},microsecondClockLocal:function(){var e=Date.now()-Squeak.Epoch;return this.pos64BitIntFor(1e3*e)}},"FilePlugin",{primitiveDirectoryCreate:function(t){var i=this.stackNonInteger(0);if(!this.success)return!1;var e=this.filenameFromSqueak(i.bytesAsString());if(this.success=Squeak.dirCreate(e),!this.success){var r=Squeak.splitFilePath(e);console.log("Directory not created: "+r.fullname)}return this.popNIfOK(t)},primitiveDirectoryDelete:function(e){var t=this.stackNonInteger(0);if(!this.success)return!1;var i=this.filenameFromSqueak(t.bytesAsString());return this.success=Squeak.dirDelete(i),this.popNIfOK(e)},primitiveDirectoryDelimitor:function(t){var e=this.emulateMac?":":"/";return this.popNandPushIfOK(1,this.charFromInt(e.charCodeAt(0)))},primitiveDirectoryEntry:function(e){return this.vm.warnOnce("Not yet implemented: primitiveDirectoryEntry"),!1},primitiveDirectoryLookup:function(s){var i=this.stackInteger(0),a=this.stackNonInteger(1);if(!this.success)return!1;var r=a.bytesAsString(),n=this.filenameFromSqueak(r),t=Squeak.dirList(n,!0);if(!t){var o=Squeak.splitFilePath(n);return console.log("Directory not found: "+o.fullname),!1}var u=Object.keys(t).sort(),e=t[u[i-1]];return"/"===r&&(1===i?(e||(e=[0,0,0,0,0]),e[0]="SqueakJS",e[3]=!0):e=null),this.popNandPushIfOK(s+1,this.makeStObject(e)),!0},primitiveDirectorySetMacTypeAndCreator:function(e){return this.popNIfOK(e)},primitiveFileAtEnd:function(t){var e=this.stackNonInteger(0);return this.success&&e.file?(this.popNandPushIfOK(t+1,this.makeStObject(e.filePos>=e.file.size)),!0):!1},primitiveFileClose:function(t){var e=this.stackNonInteger(0);return this.success&&e.file?(this.fileClose(e.file),this.vm.breakOut(),e.file=null,this.popNIfOK(t)):!1},primitiveFileDelete:function(e){var t=this.stackNonInteger(0);if(!this.success)return!1;var i=this.filenameFromSqueak(t.bytesAsString());return this.success=Squeak.fileDelete(i),this.popNIfOK(e)},primitiveFileFlush:function(t){var e=this.stackNonInteger(0);return this.success&&e.file?(Squeak.flushFile(e.file),this.vm.breakOut(),this.popNIfOK(t)):!1},primitiveFileGetPosition:function(t){var e=this.stackNonInteger(0);return this.success&&e.file?(this.popNandPushIfOK(t+1,this.makeLargeIfNeeded(e.filePos)),!0):!1},primitiveFileOpen:function(r){var i=this.stackBoolean(0),n=this.stackNonInteger(1);if(!this.success)return!1;var s=this.filenameFromSqueak(n.bytesAsString()),t=this.fileOpen(s,i);if(!t)return!1;var e=this.makeStArray([t.name]);return e.file=t,e.fileWrite=i,e.filePos=0,this.popNandPushIfOK(r+1,e),!0},primitiveFileRead:function(i){var e=this.stackInteger(0),r=this.stackInteger(1)-1,n=this.stackNonInteger(2),t=this.stackNonInteger(3);return this.success&&t.file?e?n.bytes?0>r||r+e>n.bytes.length?!1:this.fileContentsDo(t.file,function(s){if(!s.contents)return this.popNandPushIfOK(i+1,0);var o=s.contents,u=n.bytes;e=Math.min(e,s.size-t.filePos);for(var a=0;e>a;a++)u[r+a]=o[t.filePos++];this.popNandPushIfOK(i+1,e)}.bind(this)):(console.log("File reading into non-bytes object not implemented yet"),!1):this.popNandPushIfOK(i+1,0):!1},primitiveFileRename:function(e){var t=this.stackNonInteger(1),i=this.stackNonInteger(0);if(!this.success)return!1;var r=this.filenameFromSqueak(t.bytesAsString()),n=this.filenameFromSqueak(i.bytesAsString());return this.success=Squeak.fileRename(r,n),this.vm.breakOut(),this.popNIfOK(e)},primitiveFileSetPosition:function(t){var i=this.stackPos32BitInt(0),e=this.stackNonInteger(1);return this.success&&e.file?(e.filePos=i,this.popNIfOK(t)):!1},primitiveFileSize:function(t){var e=this.stackNonInteger(0);return this.success&&e.file?(this.popNandPushIfOK(t+1,this.makeLargeIfNeeded(e.file.size)),!0):!1},primitiveFileStdioHandles:function(e){return this.vm.warnOnce("Not yet implemented: primitiveFileStdioHandles"),!1},primitiveFileTruncate:function(e){return console.warn("Not yet implemented: primitiveFileTruncate"),!1},primitiveDisableFileAccess:function(e){return this.fakePrimitive("FilePlugin.primitiveDisableFileAccess",0,e)},primitiveFileWrite:function(n){var t=this.stackInteger(0),i=this.stackInteger(1)-1,s=this.stackNonInteger(2),e=this.stackNonInteger(3);if(!this.success||!e.file||!e.fileWrite)return!1;if(!t)return this.popNandPushIfOK(n+1,0);var r=s.bytes||s.wordsAsUint8Array();return r?0>i||i+t>r.length?!1:this.fileContentsDo(e.file,function(s){var u=r,a=s.contents||[];if(e.filePos+t>a.length){var l=0===a.length?e.filePos+t:Math.max(e.filePos+t,a.length+1e4);s.contents=new Uint8Array(l),s.contents.set(a),a=s.contents}for(var o=0;t>o;o++)a[e.filePos++]=u[i+o];e.filePos>s.size&&(s.size=e.filePos),s.modified=!0,this.popNandPushIfOK(n+1,t)}.bind(this)):!1},fileOpen:function(s,a){"undefined"==typeof SqueakFiles&&(window.SqueakFiles={});var e=Squeak.splitFilePath(s);if(!e.basename)return null;var n=Squeak.dirList(e.dirname,!0);if(!n)return null;var i=n[e.basename],r=null;if(i){var t=SqueakFiles[e.fullname];if(t)return++t.refCount,t}else{if(!a)return console.log("File not found: "+e.fullname),null;if(r=new Uint8Array,i=Squeak.filePut(e.fullname,r.buffer),!i)return console.log("Cannot create file: "+e.fullname),null}var t={name:e.fullname,size:i[4],contents:r,modified:!1,refCount:1};return SqueakFiles[t.name]=t,t},fileClose:function(e){Squeak.flushFile(e),0==--e.refCount&&delete SqueakFiles[e.name]},fileContentsDo:function(e,t){if(e.contents)t(e);else{if(e.contents===!1)return!1;this.vm.freeze(function(i){Squeak.fileGet(e.name,function(r){e.contents=this.asUint8Array(r),i(),t(e)}.bind(this),function(r){console.log("File get failed: "+r),e.contents=!1,i(),t(e)}.bind(this))}.bind(this))}return!0}},"DropPlugin",{primitiveDropRequestFileHandle:function(s){var t=this.stackInteger(0),i=this.display.droppedFiles||[];if(1>t||t>i.length)return!1;var r=i[t-1],n=this.fileOpen(r,!1);if(!n)return!1;var e=this.makeStArray([r]);return e.file=n,e.fileWrite=!1,e.filePos=0,this.popNandPushIfOK(s+1,e),!0},primitiveDropRequestFileName:function(i){var e=this.stackInteger(0),t=this.display.droppedFiles||[];if(1>e||e>t.length)return!1;var r=this.makeStString(this.filenameToSqueak(t[e-1]));return this.popNandPushIfOK(i,r)}},"SoundPlugin",{snd_primitiveSoundStart:function(e){return this.snd_primitiveSoundStartWithSemaphore(e)},snd_primitiveSoundStartWithSemaphore:function(e){var t=this.stackInteger(e-1),i=this.stackInteger(e-2),r=this.stackBoolean(e-3),n=e>3?this.stackInteger(e-4):0;return this.success?(this.audioContext=Squeak.startAudioOut(),this.audioContext?(this.audioSema=n,this.audioNextTimeSlot=0,this.audioBuffersReady=[],this.audioBuffersUnused=[this.audioContext.createBuffer(r?2:1,t,i),this.audioContext.createBuffer(r?2:1,t,i)],console.log("sound: started"),this.popNIfOK(e)):(this.vm.warnOnce("could not initialize audio"),!1)):!1},snd_playNextBuffer:function(){if(this.audioContext&&0!==this.audioBuffersReady.length){var e=this.audioContext.createBufferSource();e.buffer=this.audioBuffersReady.shift(),e.connect(this.audioContext.destination),this.audioNextTimeSlot<this.audioContext.currentTime&&(this.audioNextTimeSlot>0&&console.warn("sound "+this.audioContext.currentTime.toFixed(3)+": buffer underrun by "+(this.audioContext.currentTime-this.audioNextTimeSlot).toFixed(3)+" s"),this.audioNextTimeSlot=this.audioContext.currentTime),e.start(this.audioNextTimeSlot),this.audioNextTimeSlot+=e.buffer.duration,window.setTimeout(function(){this.audioContext&&(this.audioBuffersUnused.push(e.buffer),this.audioSema&&this.signalSemaphoreWithIndex(this.audioSema),this.vm.forceInterruptCheck())}.bind(this),1e3*(this.audioNextTimeSlot-this.audioContext.currentTime)),this.snd_playNextBuffer()}},snd_primitiveSoundAvailableSpace:function(i){if(!this.audioContext)return console.log("sound: no audio context"),!1;var e=0;if(this.audioBuffersUnused.length>0){var t=this.audioBuffersUnused[0];e=t.length*t.numberOfChannels*2}return this.popNandPushIfOK(i+1,e)},snd_primitiveSoundPlaySamples:function(a){if(!this.audioContext||0===this.audioBuffersUnused.length)return console.log("sound: play but no free buffers"),!1;var o=this.stackInteger(2),r=this.stackNonInteger(1).wordsAsInt16Array(),u=this.stackInteger(0)-1;if(!this.success||!r)return!1;for(var t=this.audioBuffersUnused.shift(),n=t.numberOfChannels,e=0;n>e;e++)for(var l=t.getChannelData(e),s=u+e,i=0;o>i;i++)l[i]=r[s]/32768,s+=n;return this.audioBuffersReady.push(t),this.snd_playNextBuffer(),this.popNIfOK(a)},snd_primitiveSoundPlaySilence:function(n){if(!this.audioContext||0===this.audioBuffersUnused.length)return console.log("sound: play but no free buffers"),!1;for(var e=this.audioBuffersUnused.shift(),s=e.numberOfChannels,r=e.length,t=0;s>t;t++)for(var a=e.getChannelData(t),i=0;r>i;i++)a[i]=0;return this.audioBuffersReady.push(e),this.snd_playNextBuffer(),this.popNandPushIfOK(n+1,r)},snd_primitiveSoundStop:function(e){return this.audioContext&&(this.audioContext=null,this.audioBuffersReady=null,this.audioBuffersUnused=null,this.audioNextTimeSlot=0,this.audioSema=0,console.log("sound: stopped")),this.popNIfOK(e)},snd_primitiveSoundStartRecording:function(t){if(3!==t)return!1;var n=this.stackNonInteger(3),s=this.stackInteger(2),i=this.stackBoolean(1),a=this.stackInteger(0);if(!this.success)return!1;var o=this.primMethod,r=this.vm.freeze(),e=this;return Squeak.startAudioIn(function(n,u){for(console.log("sound: recording started"),e.audioInContext=n,e.audioInSource=u,e.audioInSema=a,e.audioInBuffers=[],e.audioInBufferIndex=0,e.audioInOverSample=1;s*e.audioInOverSample<e.audioInContext.sampleRate;)e.audioInOverSample*=2;for(var o=1024*e.audioInOverSample;o/e.audioInContext.sampleRate<.1;)o*=2;e.audioInProcessor=n.createScriptProcessor(o,i?2:1,i?2:1),e.audioInProcessor.onaudioprocess=function(t){e.snd_recordNextBuffer(t.inputBuffer)},e.audioInSource.connect(e.audioInProcessor),e.audioInProcessor.connect(n.destination),e.vm.popN(t),window.setTimeout(r,0)},function(i){console.warn(i),e.vm.sendAsPrimitiveFailure(n,o,t),window.setTimeout(r,0)}),!0},snd_recordNextBuffer:function(e){this.audioInContext&&(this.audioInBuffers.length>5&&this.audioInBuffers.shift(),this.audioInBuffers.push(e),this.audioInSema&&this.signalSemaphoreWithIndex(this.audioInSema),this.vm.forceInterruptCheck())},snd_primitiveSoundGetRecordingSampleRate:function(t){if(!this.audioInContext)return!1;var e=this.audioInContext.sampleRate/this.audioInOverSample|0;return console.log("sound: actual recording rate "+e+"x"+this.audioInOverSample),this.popNandPushIfOK(t+1,e)},snd_primitiveSoundRecordSamples:function(p){var s=this.stackNonInteger(1).wordsAsInt16Array(),i=this.stackInteger(0)-1;if(!this.success)return!1;for(var c=0;i<s.length&&0!==this.audioInBuffers.length;){for(var e=this.audioInBuffers[0],t=e.numberOfChannels,u=t,o=this.audioInOverSample,m=(s.length-i)/u,d=(e.length-this.audioInBufferIndex)/o,a=Math.min(d,m),r=0;t>r;r++)for(var h=e.getChannelData(r),n=this.audioInBufferIndex,f=i+r,l=0;a>l;l++)s[f]=32768*h[n]&65535,f+=u,n+=o;c+=a*t,i+=a*t,n<e.length?this.audioInBufferIndex=n:(this.audioInBufferIndex=0,this.audioInBuffers.shift())}return this.popNandPushIfOK(p+1,c)},snd_primitiveSoundStopRecording:function(e){return this.audioInContext&&(this.audioInSource.disconnect(),this.audioInProcessor.disconnect(),this.audioInContext=null,this.audioInSema=0,this.audioInBuffers=null,this.audioInSource=null,this.audioInProcessor=null,console.log("sound recording stopped")),!0},snd_primitiveSoundSetRecordLevel:function(e){return!0}},"JPEGReadWriter2Plugin",{jpeg2_primJPEGPluginIsPresent:function(e){return this.popNandPushIfOK(e+1,this.vm.trueObj)},jpeg2_primImageHeight:function(t){var e=this.stackNonInteger(0).wordsOrBytes();if(!e)return!1;var i=e[1];return this.popNandPushIfOK(t+1,i)},jpeg2_primImageWidth:function(t){var e=this.stackNonInteger(0).wordsOrBytes();if(!e)return!1;var i=e[0];return this.popNandPushIfOK(t+1,i)},jpeg2_primJPEGCompressStructSize:function(e){return this.popNandPushIfOK(e+1,0)},jpeg2_primJPEGDecompressStructSize:function(e){return this.popNandPushIfOK(e+1,8)},jpeg2_primJPEGErrorMgr2StructSize:function(e){return this.popNandPushIfOK(e+1,0)},jpeg2_primJPEGReadHeaderfromByteArrayerrorMgr:function(r){var e=this.stackNonInteger(2).wordsOrBytes(),t=this.stackNonInteger(1).bytes;if(!e||!t)return!1;var i=this.vm.freeze();return this.jpeg2_readImageFromBytes(t,function(r){this.jpeg2state={src:t,img:r},e[0]=r.width,e[1]=r.height,i()}.bind(this),function(){e[0]=0,e[1]=0,i()}.bind(this)),this.popNIfOK(r)},jpeg2_primJPEGReadImagefromByteArrayonFormdoDitheringerrorMgr:function(a){var n=this.stackNonInteger(3).bytes,e=this.stackNonInteger(2).pointers,o=this.stackBoolean(1);if(!this.success||!n||!e)return!1;var t=this.jpeg2state;if(!t||t.src!==n)return console.error("jpeg read did not match header info"),!1;var s=e[Squeak.Form_depth],i=this.jpeg2_getPixelsFromImage(t.img),r=e[Squeak.Form_bits].words;if(32===s)this.jpeg2_copyPixelsToForm32(i,r);else{if(16!==s)return!1;o?this.jpeg2_ditherPixelsToForm16(i,r):this.jpeg2_copyPixelsToForm16(i,r)}return this.popNIfOK(a)},jpeg2_primJPEGWriteImageonByteArrayformqualityprogressiveJPEGerrorMgr:function(e){return this.vm.warnOnce("JPEGReadWritePlugin2: writing not implemented yet"),!1},jpeg2_readImageFromBytes:function(t,i,r){var n=new Blob([t],{type:"image/jpeg"}),e=new Image;e.onload=function(){i(e)},e.onerror=function(){console.warn("could not render JPEG"),r()},e.src=(window.URL||window.webkitURL).createObjectURL(n)},jpeg2_getPixelsFromImage:function(e){var t=document.createElement("canvas"),i=t.getContext("2d");return t.width=e.width,t.height=e.height,i.drawImage(e,0,0),i.getImageData(0,0,e.width,e.height)},jpeg2_copyPixelsToForm32:function(r,i){for(var t=r.data,e=0;e<i.length;e++){var n=t[4*e+0],s=t[4*e+1],a=t[4*e+2];i[e]=4278190080|n<<16|s<<8|a}},jpeg2_copyPixelsToForm16:function(r,o){for(var u=r.width,a=r.height,i=r.data,n=0;a>n;n++)for(var s=0;u>s;s+=2){var t=n*a+s,d=i[4*t+0]>>3,l=i[4*t+1]>>3,c=i[4*t+2]>>3,f=i[4*t+4]>>3,h=i[4*t+5]>>3,p=i[4*t+6]>>3,e=d<<10|l<<5|c;0===e&&(e=1),e=e<<16|f<<10|h<<5|p,0===(65535&e)&&(e=1|e),o[t>>1]=e}},jpeg2_ditherPixelsToForm16:function(h,y){for(var S=h.width>>1,g=h.height,s=h.data,b=[2,0,14,12,1,3,13,15],F=[10,8,6,4,9,11,5,7],a=0;g>a;a++)for(var o=0;S>o;o++){var t,i,e,n=a*g+2*o<<2,v=s[n+0],d=s[n+1],m=s[n+2],p=s[n+4],f=s[n+5],c=s[n+6],k=(3&a)<<1|1&o,l=b[k],u=F[k];t=496*v>>8,i=15&t,e=t>>4,v=i>l?e+1:e,t=496*d>>8,i=15&t,e=t>>4,d=i>l?e+1:e,t=496*m>>8,i=15&t,e=t>>4,m=i>l?e+1:e,t=496*p>>8,i=15&t,e=t>>4,p=i>u?e+1:e,t=496*f>>8,i=15&t,e=t>>4,f=i>u?e+1:e,t=496*c>>8,i=15&t,e=t>>4,c=i>u?e+1:e;var r=v<<10|d<<5|m;0===r&&(r=1),r=r<<16|p<<10|f<<5|c,0===(65535&r)&&(r=1|r),y[n>>3]=r}}},"ScratchPluginAdditions",{scratch_primitiveOpenURL:function(r){var e=this.stackNonInteger(0).bytesAsString();if(""==e)return!1;if(/^\/SqueakJS\//.test(e)){e=e.slice(10);var t=Squeak.splitFilePath(e),i=localStorage["squeak-template:"+t.dirname];i&&(e=JSON.parse(i).url+"/"+t.basename)}return window.open(e,"_blank"),this.popNIfOK(r)},scratch_primitiveGetFolderPath:function(t){var i=this.stackInteger(0);if(!this.success)return!1;var e;switch(i){case 1:e="/"}return e?(this.vm.popNandPush(t+1,this.makeStString(this.filenameToSqueak(e))),!0):!1}},"JavaScriptPlugin",{js_primitiveDoUnderstand:function(l){var n=this.stackNonInteger(1),t=this.js_objectOrGlobal(n),o=this.stackNonInteger(0).pointers,c=o[0].bytesAsString(),i=o[1].pointers||[],a=!("jsObject"in n),e=null;try{this.js_activeCallback="Callbacks must be asynchronous";var r=c.match(/([^:]*)/)[0];if(a||"new"!==r){if(!(r in t))return this.js_setError("Property not found: "+r);var s=t[r];if("function"==typeof s&&(!a||i.length>0))e=s.apply(t,this.js_fromStArray(i));else if(0==i.length)e=s;else{if(1!=i.length)return this.js_setError("Property "+r+" is not a function");t[r]=this.js_fromStObject(i[0])}}else if(0===i.length)e=new t;else{var u=Object.create(t.prototype);e=t.apply(u,this.js_fromStArray(i)),Object(e)!==e&&(e=u)}}catch(f){return this.js_setError(f.message)}finally{this.js_activeCallback=null}var h=this.makeStObject(e,n.sqClass);return this.popNandPushIfOK(l+1,h)},js_primitiveAsString:function(e){var t=this.js_objectOrGlobal(this.stackNonInteger(0));return this.popNandPushIfOK(e+1,this.makeStString(String(t)))},js_primitiveTypeof:function(e){var t=this.js_objectOrGlobal(this.stackNonInteger(0));return this.popNandPushIfOK(e+1,this.makeStString(typeof t))},js_primitiveAt:function(i){var e,t=this.stackNonInteger(1),r=this.vm.stackValue(0);try{var n=this.js_objectOrGlobal(t),s=this.js_fromStObject(r),a=n[s];e=this.makeStObject(a,t.sqClass)}catch(o){return this.js_setError(o.message)}return this.popNandPushIfOK(i+1,e)},js_primitiveAtPut:function(t){var i=this.stackNonInteger(2),r=this.vm.stackValue(1),e=this.vm.stackValue(0);try{var n=this.js_objectOrGlobal(i),s=this.js_fromStObject(r),a=this.js_fromStObject(e);n[s]=a}catch(o){return this.js_setError(o.message)}return this.popNandPushIfOK(t+1,e)},js_primitiveSqueakAsJSObject:function(e){var t=this.stackNonInteger(1),i=this.vm.stackValue(0);return this.success&&(t.jsObject=i),this.popNIfOK(e)},js_primitiveInitCallbacks:function(e){return this.js_callbackSema=this.stackInteger(0),this.js_activeCallback=null,this.popNIfOK(e)},js_primitiveGetActiveCallbackBlock:function(t){var e=this.js_activeCallback;return e?this.popNandPushIfOK(t,e.block):this.js_setError("No active callback")},js_primitiveGetActiveCallbackArgs:function(r){var s=this.stackNonInteger(r),e=this.js_activeCallback;if(!e)return this.js_setError("No active callback");try{var t=e.block.pointers[Squeak.BlockContext_argumentCount],n=[];"number"!=typeof t&&(t=e.block.pointers[Squeak.Closure_numArgs]);for(var i=0;t>i;i++)n.push(e.args[i]);return this.popNandPushIfOK(r,this.makeStArray(n,s))}catch(a){return this.js_setError(a.message)}},js_primitiveReturnFromCallback:function(e){return 1!==e?!1:this.js_activeCallback?(this.js_activeCallback.result=this.vm.pop(),this.vm.breakOut(),!0):this.js_setError("No active callback")},js_primitiveGetError:function(e){var t=this.makeStObject(this.js_error);return this.js_error=null,this.popNandPushIfOK(e+1,t)},js_setError:function(e){return this.js_error=String(e),!1},js_fromStObject:function(e){if("number"==typeof e)return e;if(e.jsObject)return e.jsObject;if(e.isFloat)return e["float"];if(e.isNil)return null;if(e.isTrue)return!0;if(e.isFalse)return!1;if(e.bytes||e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassString])return e.bytesAsString();if(e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassArray])return this.js_fromStArray(e.pointers||[],!0);if(e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassBlockContext]||e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassBlockClosure])return this.js_fromStBlock(e);throw Error("asJSArgument needed for "+e)},js_fromStArray:function(e,r){if(e.length>0&&r&&this.isAssociation(e[0]))return this.js_fromStDict(e);for(var i=[],t=0;t<e.length;t++)i.push(this.js_fromStObject(e[t]));return i},js_fromStDict:function(i){for(var r={},t=0;t<i.length;t++){var e=i[t].pointers;if(!e||2!==e.length)throw Error(e+" is not an Association");var n=this.js_fromStObject(e[0]),s=this.js_fromStObject(e[1]);r[n]=s}return r},js_fromStBlock:function(e){if(!this.js_callbackSema)throw Error("CallbackSemaphore not set");this.vm.reclaimableContextCount=0;var t=this;return function(){return t.js_executeCallback(e,arguments)}},js_executeCallback:function(t,i){if(this.js_activeCallback){if("string"==typeof this.js_activeCallback)throw Error(this.js_activeCallback);return console.error("Callback: already active")}this.js_activeCallback={block:t,args:i,result:null},this.signalSemaphoreWithIndex(this.js_callbackSema),this.vm.forceInterruptCheck();for(var r=Date.now()+500;Date.now()<r&&!this.js_activeCallback.result;)this.vm.interpret();var e=this.js_activeCallback.result;if(this.js_activeCallback=null,e)try{return this.js_fromStObject(e)}catch(n){return e.toString()}else console.error("Callback error: "+(this.vm.frozen?"frozen":"timeout"))},js_objectOrGlobal:function(e){return"jsObject"in e?e.jsObject:window}},"Obsolete",{primitiveFloatArrayAt:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveAt",e)},primitiveFloatArrayMulFloatArray:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveMulFloatArray",e)},primitiveFloatArrayAddScalar:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveAddScalar",e)},primitiveFloatArrayDivFloatArray:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveDivFloatArray",e)},primitiveFloatArrayDivScalar:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveDivScalar",e)},primitiveFloatArrayHash:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveHash",e)},primitiveFloatArrayAtPut:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveAtPut",e)},primitiveFloatArrayMulScalar:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveMulScalar",e)},primitiveFloatArrayAddFloatArray:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveAddFloatArray",e)},primitiveFloatArraySubScalar:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveSubScalar",e)},primitiveFloatArraySubFloatArray:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveSubFloatArray",e)},primitiveFloatArrayEqual:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveEqual",e)},primitiveFloatArrayDotProduct:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveDotProduct",e)},m23PrimitiveInvertRectInto:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveInvertRectInto",e);
},m23PrimitiveTransformPoint:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveTransformPoint",e)},m23PrimitiveIsPureTranslation:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveIsPureTranslation",e)},m23PrimitiveComposeMatrix:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveComposeMatrix",e)},m23PrimitiveTransformRectInto:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveTransformRectInto",e)},m23PrimitiveIsIdentity:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveIsIdentity",e)},m23PrimitiveInvertPoint:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveInvertPoint",e)},primitiveDeflateBlock:function(e){return this.namedPrimitive("ZipPlugin","primitiveDeflateBlock",e)},primitiveDeflateUpdateHashTable:function(e){return this.namedPrimitive("ZipPlugin","primitiveDeflateUpdateHashTable",e)},primitiveUpdateGZipCrc32:function(e){return this.namedPrimitive("ZipPlugin","primitiveUpdateGZipCrc32",e)},primitiveInflateDecompressBlock:function(e){return this.namedPrimitive("ZipPlugin","primitiveInflateDecompressBlock",e)},primitiveZipSendBlock:function(e){return this.namedPrimitive("ZipPlugin","primitiveZipSendBlock",e)},primitiveFFTTransformData:function(e){return this.namedPrimitive("FFTPlugin","primitiveFFTTransformData",e)},primitiveFFTScaleData:function(e){return this.namedPrimitive("FFTPlugin","primitiveFFTScaleData",e)},primitiveFFTPermuteData:function(e){return this.namedPrimitive("FFTPlugin","primitiveFFTPermuteData",e)},gePrimitiveMergeFillFrom:function(e){return this.namedPrimitive("B2DPlugin","primitiveMergeFillFrom",e)},gePrimitiveCopyBuffer:function(e){return this.namedPrimitive("B2DPlugin","primitiveCopyBuffer",e)},gePrimitiveAddRect:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddRect",e)},gePrimitiveAddGradientFill:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddGradientFill",e)},gePrimitiveSetClipRect:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetClipRect",e)},gePrimitiveSetBitBltPlugin:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetBitBltPlugin",e)},gePrimitiveRegisterExternalEdge:function(e){return this.namedPrimitive("B2DPlugin","primitiveRegisterExternalEdge",e)},gePrimitiveGetClipRect:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetClipRect",e)},gePrimitiveAddBezier:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddBezier",e)},gePrimitiveInitializeProcessing:function(e){return this.namedPrimitive("B2DPlugin","primitiveInitializeProcessing",e)},gePrimitiveRenderImage:function(e){return this.namedPrimitive("B2DPlugin","primitiveRenderImage",e)},gePrimitiveGetOffset:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetOffset",e)},gePrimitiveSetDepth:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetDepth",e)},gePrimitiveAddBezierShape:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddBezierShape",e)},gePrimitiveSetEdgeTransform:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetEdgeTransform",e)},gePrimitiveGetTimes:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetTimes",e)},gePrimitiveNextActiveEdgeEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveNextActiveEdgeEntry",e)},gePrimitiveAddBitmapFill:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddBitmapFill",e)},gePrimitiveGetDepth:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetDepth",e)},gePrimitiveAbortProcessing:function(e){return this.namedPrimitive("B2DPlugin","primitiveAbortProcessing",e)},gePrimitiveNextGlobalEdgeEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveNextGlobalEdgeEntry",e)},gePrimitiveGetFailureReason:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetFailureReason",e)},gePrimitiveDisplaySpanBuffer:function(e){return this.namedPrimitive("B2DPlugin","primitiveDisplaySpanBuffer",e)},gePrimitiveGetCounts:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetCounts",e)},gePrimitiveChangedActiveEdgeEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveChangedActiveEdgeEntry",e)},gePrimitiveRenderScanline:function(e){return this.namedPrimitive("B2DPlugin","primitiveRenderScanline",e)},gePrimitiveGetBezierStats:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetBezierStats",e)},gePrimitiveFinishedProcessing:function(e){return this.namedPrimitive("B2DPlugin","primitiveFinishedProcessing",e)},gePrimitiveNeedsFlush:function(e){return this.namedPrimitive("B2DPlugin","primitiveNeedsFlush",e)},gePrimitiveAddLine:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddLine",e)},gePrimitiveSetOffset:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetOffset",e)},gePrimitiveNextFillEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveNextFillEntry",e)},gePrimitiveInitializeBuffer:function(e){return this.namedPrimitive("B2DPlugin","primitiveInitializeBuffer",e)},gePrimitiveDoProfileStats:function(e){return this.namedPrimitive("B2DPlugin","primitiveDoProfileStats",e)},gePrimitiveAddActiveEdgeEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddActiveEdgeEntry",e)},gePrimitiveSetAALevel:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetAALevel",e)},gePrimitiveNeedsFlushPut:function(e){return this.namedPrimitive("B2DPlugin","primitiveNeedsFlushPut",e)},gePrimitiveAddCompressedShape:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddCompressedShape",e)},gePrimitiveSetColorTransform:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetColorTransform",e)},gePrimitiveAddOval:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddOval",e)},gePrimitiveRegisterExternalFill:function(e){return this.namedPrimitive("B2DPlugin","primitiveRegisterExternalFill",e)},gePrimitiveAddPolygon:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddPolygon",e)},gePrimitiveGetAALevel:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetAALevel",e)}}),Object.subclass("Squeak.InterpreterProxy","initialization",{VM_PROXY_MAJOR:1,VM_PROXY_MINOR:11,initialize:function(e){this.vm=e,this.remappableOops=[],Object.defineProperty(this,"successFlag",{get:function(){return e.primHandler.success},set:function(t){e.primHandler.success=t}})},majorVersion:function(){return this.VM_PROXY_MAJOR},minorVersion:function(){return this.VM_PROXY_MINOR}},"success",{failed:function(){return!this.successFlag},primitiveFail:function(){this.successFlag=!1},primitiveFailFor:function(e){this.successFlag=!1},success:function(e){e||(this.successFlag=!1)}},"stack access",{pop:function(e){this.vm.popN(e)},popthenPush:function(e,t){this.vm.popNandPush(e,t)},push:function(e){this.vm.push(e)},pushBool:function(e){this.vm.push(e?this.vm.trueObj:this.vm.falseObj)},pushInteger:function(e){this.vm.push(e)},pushFloat:function(e){this.vm.push(this.floatObjectOf(e))},stackValue:function(e){return this.vm.stackValue(e)},stackIntegerValue:function(t){var e=this.vm.stackValue(t);return"number"==typeof e?e:(this.successFlag=!1,0)},stackFloatValue:function(e){this.vm.success=!0;var t=this.vm.stackIntOrFloat(e);return this.vm.success?t:(this.successFlag=!1,0)},stackObjectValue:function(t){var e=this.vm.stackValue(t);return"number"!=typeof e?e:(this.successFlag=!1,this.vm.nilObj)},stackBytes:function(t){var e=this.vm.stackValue(t);return e.bytes?e.bytes:("number"!=typeof e&&e.isBytes()||(this.successFlag=!1),[])},stackWords:function(t){var e=this.vm.stackValue(t);return e.words?e.words:("number"!=typeof e&&e.isWords()||(this.successFlag=!1),[])},stackInt32Array:function(t){var e=this.vm.stackValue(t);return e.words?e.wordsAsInt32Array():("number"!=typeof e&&e.isWords()||(this.successFlag=!1),[])},stackInt16Array:function(t){var e=this.vm.stackValue(t);return e.words?e.wordsAsInt16Array():("number"!=typeof e&&e.isWords()||(this.successFlag=!1),[])},stackUint16Array:function(t){var e=this.vm.stackValue(t);return e.words?e.wordsAsUint16Array():("number"!=typeof e&&e.isWords()||(this.successFlag=!1),[])}},"object access",{isBytes:function(e){return"number"!=typeof e&&e.isBytes()},isWords:function(e){return"number"!=typeof e&&e.isWords()},isWordsOrBytes:function(e){return"number"!=typeof e&&e.isWordsOrBytes()},isPointers:function(e){return"number"!=typeof e&&e.isPointers()},isIntegerValue:function(e){return"number"==typeof e&&e>=-1073741824&&1073741823>=e},isArray:function(e){return e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassArray]},isMemberOf:function(r,t){var i=r.sqClass.pointers[Squeak.Class_name].bytes;if(t.length!==i.length)return!1;for(var e=0;e<t.length;e++)if(t.charCodeAt(e)!==i[e])return!1;return!0},booleanValueOf:function(e){return e.isTrue?!0:e.isFalse?!1:(this.successFlag=!1,!1)},positive32BitValueOf:function(e){return this.vm.primHandler.positive32BitValueOf(e)},positive32BitIntegerFor:function(e){return this.vm.primHandler.pos32BitIntFor(e)},floatValueOf:function(e){return e.isFloat?e["float"]:(this.successFlag=!1,0)},floatObjectOf:function(e){return this.vm.primHandler.makeFloat(e)},fetchPointerofObject:function(e,t){return t.pointers[e]},fetchBytesofObject:function(t,i){var e=i.pointers[t];return e.bytes?e.bytes:e.words?e.wordsAsUint8Array():("number"!=typeof e&&e.isWordsOrBytes()||(this.successFlag=!1),[])},fetchWordsofObject:function(t,i){var e=i.pointers[t];return e.words?e.words:("number"!=typeof e&&e.isWords()||(this.successFlag=!1),[])},fetchInt32ArrayofObject:function(t,i){var e=i.pointers[t];return e.words?e.wordsAsInt32Array():("number"!=typeof e&&e.isWords()||(this.successFlag=!1),[])},fetchInt16ArrayofObject:function(t,i){var e=i.pointers[t];return e.words?e.wordsAsInt16Array():("number"!=typeof e&&e.isWords()||(this.successFlag=!1),[])},fetchUint16ArrayofObject:function(t,i){var e=i.pointers[t];return e.words?e.wordsAsUint16Array():("number"!=typeof e&&e.isWords()||(this.successFlag=!1),[])},fetchIntegerofObject:function(t,i){var e=i.pointers[t];return"number"==typeof e?e:(this.successFlag=!1,0)},fetchLong32ofObject:function(e,t){return t.words[e]},fetchFloatofObject:function(e,t){return this.floatValueOf(t.pointers[e])},storeIntegerofObjectwithValue:function(t,i,e){"number"==typeof e?i.pointers[t]=e:this.successFlag=!1},storePointerofObjectwithValue:function(e,t,i){t.pointers[e]=i},stObjectatput:function(e,t,i){if(e.sqClass!==this.classArray())throw Error("Array expected");return 1>t||t>=e.pointers.length?this.successFlag=!1:void(e.pointers[t]=i)}},"constant access",{isKindOfInteger:function(e){return"number"==typeof e||e.sqClass==this.classLargeNegativeInteger()||e.sqClass==this.classLargePositiveInteger()},classArray:function(){return this.vm.specialObjects[Squeak.splOb_ClassArray]},classBitmap:function(){return this.vm.specialObjects[Squeak.splOb_ClassBitmap]},classSmallInteger:function(){return this.vm.specialObjects[Squeak.splOb_ClassInteger]},classLargePositiveInteger:function(){return this.vm.specialObjects[Squeak.splOb_ClassLargePositiveInteger]},classLargeNegativeInteger:function(){return this.vm.specialObjects[Squeak.splOb_ClassLargeNegativeInteger]},classPoint:function(){return this.vm.specialObjects[Squeak.splOb_ClassPoint]},classString:function(){return this.vm.specialObjects[Squeak.splOb_ClassString]},nilObject:function(){return this.vm.nilObj},falseObject:function(){return this.vm.falseObj},trueObject:function(){return this.vm.trueObj}},"vm functions",{instantiateClassindexableSize:function(e,t){return this.vm.instantiateClass(e,t)},methodArgumentCount:function(){return this.argCount},makePointwithxValueyValue:function(e,t){return this.vm.primHandler.makePointWithXandY(e,t)},pushRemappableOop:function(e){this.remappableOops.push(e)},popRemappableOop:function(){return this.remappableOops.pop()},showDisplayBitsLeftTopRightBottom:function(n,e,t,i,r){if(i>e&&r>t){var s={left:e,top:t,right:i,bottom:r};this.vm.primHandler.displayDirty(n,s)}},ioLoadFunctionFrom:function(e,t){return this.vm.primHandler.loadFunctionFrom(e,t)}}),Object.subclass("Squeak.InstructionPrinter","initialization",{initialize:function(e,t){this.method=e,this.vm=t}},"printing",{printInstructions:function(e,t,i){for(this.indent=e,this.highlight=t,this.highlightPC=i,this.innerIndents={},this.result="",this.scanner=new Squeak.InstructionStream(this.method,this.vm),this.oldPC=this.scanner.pc,this.endPC=0,this.done=!1;!this.done;)this.scanner.interpretNextInstructionFor(this);return this.result},print:function(t){this.oldPC===this.highlightPC?this.highlight&&(this.result+=this.highlight):this.indent&&(this.result+=this.indent),this.result+=this.oldPC;for(var e=0;e<this.innerIndents[this.oldPC];e++)this.result+="   ";this.result+=" <";for(var e=this.oldPC;e<this.scanner.pc;e++)e>this.oldPC&&(this.result+=" "),this.result+=(this.method.bytes[e]+256).toString(16).substr(-2).toUpperCase();this.result+="> "+t+"\n",this.oldPC=this.scanner.pc}},"decoding",{blockReturnTop:function(){this.print("blockReturn")},doDup:function(){this.print("dup")},doPop:function(){this.print("pop")},jump:function(e){this.print("jumpTo: "+(this.scanner.pc+e)),this.scanner.pc+e>this.endPC&&(this.endPC=this.scanner.pc+e)},jumpIf:function(t,e){this.print((t?"jumpIfTrue: ":"jumpIfFalse: ")+(this.scanner.pc+e)),this.scanner.pc+e>this.endPC&&(this.endPC=this.scanner.pc+e)},methodReturnReceiver:function(){this.print("return: receiver"),this.done=this.scanner.pc>this.endPC},methodReturnTop:function(){this.print("return: topOfStack"),this.done=this.scanner.pc>this.endPC},methodReturnConstant:function(e){this.print("returnConst: "+e.toString()),this.done=this.scanner.pc>this.endPC},popIntoLiteralVariable:function(e){this.print("popIntoBinding: "+e.assnKeyAsString())},popIntoReceiverVariable:function(e){this.print("popIntoInstVar: "+e)},popIntoTemporaryVariable:function(e){this.print("popIntoTemp: "+e)},pushActiveContext:function(){this.print("push: thisContext")},pushConstant:function(e){var t=e.sqInstName?e.sqInstName():e.toString();this.print("pushConst: "+t)},pushLiteralVariable:function(e){this.print("pushBinding: "+e.assnKeyAsString())},pushReceiver:function(){this.print("push: self")},pushReceiverVariable:function(e){this.print("pushInstVar: "+e)},pushTemporaryVariable:function(e){this.print("pushTemp: "+e)},send:function(e,i,t){this.print((t?"superSend: #":"send: #")+(e.bytesAsString?e.bytesAsString():e))},storeIntoLiteralVariable:function(e){this.print("storeIntoBinding: "+e.assnKeyAsString())},storeIntoReceiverVariable:function(e){this.print("storeIntoInstVar: "+e)},storeIntoTemporaryVariable:function(e){this.print("storeIntoTemp: "+e)},pushNewArray:function(e){this.print("push: (Array new: "+e+")")},popIntoNewArray:function(e){this.print("pop: "+e+" into: (Array new: "+e+")")},pushRemoteTemp:function(e,t){this.print("push: "+e+" ofTemp: "+t)},storeIntoRemoteTemp:function(e,t){this.print("storeInto: "+e+" ofTemp: "+t)},popIntoRemoteTemp:function(e,t){this.print("popInto: "+e+" ofTemp: "+t)},pushClosureCopy:function(r,n,s){var i=this.scanner.pc,e=i+s;this.print("closure("+i+"-"+(e-1)+"): "+r+" copied, "+n+" args");for(var t=i;e>t;t++)this.innerIndents[t]=(this.innerIndents[t]||0)+1;e>this.endPC&&(this.endPC=e)}}),Object.subclass("Squeak.InstructionStream","initialization",{initialize:function(t,e){this.vm=e,this.method=t,this.pc=0,this.specialConstants=[e.trueObj,e.falseObj,e.nilObj,-1,0,1,2]}},"decoding",{interpretNextInstructionFor:function(t){var r=this.method,n=r.bytes[this.pc++],i=n/16|0,e=n%16;if(0===i)return t.pushReceiverVariable(e);if(1===i)return t.pushTemporaryVariable(e);if(2===i)return t.pushConstant(r.methodGetLiteral(e));if(3===i)return t.pushConstant(r.methodGetLiteral(e+16));if(4===i)return t.pushLiteralVariable(r.methodGetLiteral(e));if(5===i)return t.pushLiteralVariable(r.methodGetLiteral(e+16));if(6===i)return 8>e?t.popIntoReceiverVariable(e):t.popIntoTemporaryVariable(e-8);if(7===i){if(0===e)return t.pushReceiver();if(8>e)return t.pushConstant(this.specialConstants[e-1]);if(8===e)return t.methodReturnReceiver();if(12>e)return t.methodReturnConstant(this.specialConstants[e-9]);if(12===e)return t.methodReturnTop();if(13===e)return t.blockReturnTop();if(e>13)throw Error("unusedBytecode")}return 8===i?this.interpretExtension(e,r,t):9===i?8>e?t.jump(e+1):t.jumpIf(!1,e-8+1):10===i?(n=this.method.bytes[this.pc++],8>e?t.jump(256*(e-4)+n):t.jumpIf(12>e,256*(3&e)+n)):11===i?t.send(this.vm.specialSelectors[2*e],this.vm.specialSelectors[2*e+1],!1):12===i?t.send(this.vm.specialSelectors[2*(e+16)],this.vm.specialSelectors[2*(e+16)+1],!1):i>12?t.send(r.methodGetLiteral(e),i-13,!1):void 0},interpretExtension:function(r,o,e){if(6>=r){var i=this.method.bytes[this.pc++];if(2>=r){var t=i/64|0,s=i%64;if(0===r){if(0===t)return e.pushReceiverVariable(s);if(1===t)return e.pushTemporaryVariable(s);if(2===t)return e.pushConstant(this.method.methodGetLiteral(s));if(3===t)return e.pushLiteralVariable(this.method.methodGetLiteral(s))}if(1===r){if(0===t)return e.storeIntoReceiverVariable(s);if(1===t)return e.storeIntoTemporaryVariable(s);if(2===t)throw Error("illegalStore");if(3===t)return e.storeIntoLiteralVariable(this.method.methodGetLiteral(s))}if(2===r){if(0===t)return e.popIntoReceiverVariable(s);if(1===t)return e.popIntoTemporaryVariable(s);if(2===t)throw Error("illegalStore");if(3===t)return e.popIntoLiteralVariable(this.method.methodGetLiteral(s))}}if(3===r)return e.send(this.method.methodGetLiteral(i%32),i/32|0,!1);if(4===r){var n=this.method.bytes[this.pc++],t=i/32|0;if(0===t)return e.send(this.method.methodGetLiteral(n),i%32,!1);if(1===t)return e.send(this.method.methodGetLiteral(n),i%32,!0);if(2===t)return e.pushReceiverVariable(n);if(3===t)return e.pushConstant(this.method.methodGetLiteral(n));if(4===t)return e.pushLiteralVariable(this.method.methodGetLiteral(n));if(5===t)return e.storeIntoReceiverVariable(n);if(6===t)return e.popIntoReceiverVariable(n);if(7===t)return e.storeIntoLiteralVariable(this.method.methodGetLiteral(n))}if(5===r)return e.send(this.method.methodGetLiteral(31&i),i>>5,!0);if(6===r)return e.send(this.method.methodGetLiteral(63&i),i>>6,!1)}if(7===r)return e.doPop();if(8===r)return e.doDup();if(9===r)return e.pushActiveContext();var i=this.method.bytes[this.pc++];if(10===r)return 128>i?e.pushNewArray(i):e.popIntoNewArray(i-128);if(11===r)throw Error("unusedBytecode");var n=this.method.bytes[this.pc++];if(12===r)return e.pushRemoteTemp(i,n);if(13===r)return e.storeIntoRemoteTemp(i,n);if(14===r)return e.popIntoRemoteTemp(i,n);var a=this.method.bytes[this.pc++];return e.pushClosureCopy(i>>4,15&i,256*n+a)}})}),module("users.bert.SqueakJS.jit").requires("users.bert.SqueakJS.vm").toRun(function(){Object.subclass("Squeak.Compiler","initialization",{initialize:function(e){this.vm=e,this.comments=!!Squeak.Compiler.comments,this.specialSelectors=["+","-","<",">","<=",">=","=","~=","*","/","\\","@","bitShift:","//","bitAnd:","bitOr:","at:","at:put:","size","next","nextPut:","atEnd","==","class","blockCopy:","value","value:","do:","new","new:","x","y"]}},"accessing",{compile:function(e,t,i){if(e.isHot){this.singleStep=!1,this.debug=this.comments;var r=t&&t.className(),n=i&&i.bytesAsString();e.compiled=this.generate(e,r,n)}else e.isHot=!0},enableSingleStepping:function(e,i,r){if(!e.compiled||!e.compiled.canSingleStep){this.singleStep=!0,this.debug=!0;var t=this.vm.printMethod(e,i,r).split(">>");e.compiled=this.generate(e,t[0],t[1]),e.compiled.canSingleStep=!0}return!0},functionNameFor:function(t,e){if(!t||!e)return"Squeak_DOIT";if(!/[^a-zA-Z:_]/.test(e))return(t+"_"+e).replace(/[: ]/g,"_");var i=e.replace(/./g,function(e){var t={"|":"OR","~":"NOT","<":"LT","=":"EQ",">":"GT","&":"AND","@":"AT","*":"TIMES","+":"PLUS","\\":"MOD","-":"MINUS",",":"COMMA","/":"DIV","?":"IF"}[e];return t||"OPERATOR"});return t.replace(/[ ]/,"_")+"__"+i+"__"}},"generating",{generate:function(t,r,n){for(this.method=t,this.pc=0,this.endPC=0,this.prevPC=0,this.source=[],this.sourceLabels={},this.needsLabel={0:!0},this.needsBreak=!1,r&&n&&this.source.push("// ",r,">>",n,"\n"),this.source.push("var context = vm.activeContext,\n","    stack = context.pointers,\n","    rcvr = vm.receiver,\n","    inst = rcvr.pointers,\n","    temp = vm.homeContext.pointers,\n","    lit = vm.method.pointers,\n","    bytecodes = 0 - vm.pc;\n","while (true) switch (vm.pc) {\n"),this.done=!1;!this.done;){var e=t.bytes[this.pc++],i=0;switch(248&e){case 0:case 8:this.generatePush("inst[",15&e,"]");break;case 16:case 24:this.generatePush("temp[",6+(15&e),"]");break;case 32:case 40:case 48:case 56:this.generatePush("lit[",1+(31&e),"]");break;case 64:case 72:case 80:case 88:this.generatePush("lit[",1+(31&e),"].pointers[1]");break;case 96:this.generatePopInto("inst[",7&e,"]");break;case 104:this.generatePopInto("temp[",6+(7&e),"]");break;case 112:switch(e){case 112:this.generatePush("rcvr");break;case 113:this.generatePush("vm.trueObj");break;case 114:this.generatePush("vm.falseObj");break;case 115:this.generatePush("vm.nilObj");break;case 116:this.generatePush("-1");break;case 117:this.generatePush("0");break;case 118:this.generatePush("1");break;case 119:this.generatePush("2")}break;case 120:switch(e){case 120:this.generateReturn("rcvr");break;case 121:this.generateReturn("vm.trueObj");break;case 122:this.generateReturn("vm.falseObj");break;case 123:this.generateReturn("vm.nilObj");break;case 124:this.generateReturn("stack[vm.sp]");break;case 125:this.generateBlockReturn();break;default:throw Error("unusedBytecode")}break;case 128:case 136:this.generateExtended(e);break;case 144:this.generateJump((7&e)+1);break;case 152:this.generateJumpIf(!1,(7&e)+1);break;case 160:i=t.bytes[this.pc++],this.generateJump(256*((7&e)-4)+i);break;case 168:i=t.bytes[this.pc++],this.generateJumpIf(172>e,256*(3&e)+i);break;case 176:case 184:this.generateNumericOp(e);break;case 192:case 200:this.generateQuickPrim(e);break;case 208:case 216:this.generateSend("lit[",1+(15&e),"]",0,!1);break;case 224:case 232:this.generateSend("lit[",1+(15&e),"]",1,!1);break;case 240:case 248:this.generateSend("lit[",1+(15&e),"]",2,!1)}}var s=this.functionNameFor(r,n);return this.singleStep?(this.debug&&this.source.push("// all valid PCs have a label;\n"),this.source.push("default: throw Error('invalid PC'); }"),new Function("return function "+s+"(vm, singleStep) {\n"+this.source.join("")+"\n}")()):(this.debug&&this.source.push("// fall back to single-stepping\n"),this.source.push("default: bytecodes += vm.pc; vm.interpretOne(true); return bytecodes;}"),this.deleteUnneededLabels(),new Function("return function "+s+"(vm) {\n"+this.source.join("")+"\n}")())},generateExtended:function(i){switch(i){case 128:var e=this.method.bytes[this.pc++];switch(e>>6){case 0:return void this.generatePush("inst[",63&e,"]");case 1:return void this.generatePush("temp[",6+(63&e),"]");case 2:return void this.generatePush("lit[",1+(63&e),"]");case 3:return void this.generatePush("lit[",1+(63&e),"].pointers[1]")}case 129:var e=this.method.bytes[this.pc++];switch(e>>6){case 0:return void this.generateStoreInto("inst[",63&e,"]");case 1:return void this.generateStoreInto("temp[",6+(63&e),"]");case 2:throw Error("illegal store into literal");case 3:return void this.generateStoreInto("lit[",1+(63&e),"].pointers[1]")}return;case 130:var e=this.method.bytes[this.pc++];switch(e>>6){case 0:return void this.generatePopInto("inst[",63&e,"]");case 1:return void this.generatePopInto("temp[",6+(63&e),"]");case 2:throw Error("illegal pop into literal");case 3:return void this.generatePopInto("lit[",1+(63&e),"].pointers[1]")}case 131:var e=this.method.bytes[this.pc++];return void this.generateSend("lit[",1+(31&e),"]",e>>5,!1);case 132:var e=this.method.bytes[this.pc++],t=this.method.bytes[this.pc++];switch(e>>5){case 0:return void this.generateSend("lit[",1+t,"]",31&e,!1);case 1:return void this.generateSend("lit[",1+t,"]",31&e,!0);case 2:return void this.generatePush("inst[",t,"]");case 3:return void this.generatePush("lit[",1+t,"]");case 4:return void this.generatePush("lit[",1+t,"].pointers[1]");case 5:return void this.generateStoreInto("inst[",t,"]");case 6:return void this.generatePopInto("inst[",t,"]");case 7:return void this.generateStoreInto("lit[",1+t,"].pointers[1]")}case 133:var e=this.method.bytes[this.pc++];return void this.generateSend("lit[",1+(31&e),"]",e>>5,!0);case 134:var e=this.method.bytes[this.pc++];return void this.generateSend("lit[",1+(63&e),"]",e>>6,!1);case 135:return void this.generateInstruction("pop","vm.sp--");case 136:return void this.generateInstruction("dup","var dup = stack[vm.sp]; stack[++vm.sp] = dup");case 137:return void this.generateInstruction("thisContext","stack[++vm.sp] = vm.exportThisContext()");case 138:var e=this.method.bytes[this.pc++],r=e>127,n=127&e;return void this.generateClosureTemps(n,r);case 139:throw Error("unusedBytecode");case 140:var e=this.method.bytes[this.pc++],t=this.method.bytes[this.pc++];return void this.generatePush("temp[",6+t,"].pointers[",e,"]");case 141:var e=this.method.bytes[this.pc++],t=this.method.bytes[this.pc++];return void this.generateStoreInto("temp[",6+t,"].pointers[",e,"]");case 142:var e=this.method.bytes[this.pc++],t=this.method.bytes[this.pc++];return void this.generatePopInto("temp[",6+t,"].pointers[",e,"]");case 143:var e=this.method.bytes[this.pc++],t=this.method.bytes[this.pc++],s=this.method.bytes[this.pc++],a=15&e,o=e>>4,u=t<<8|s;return void this.generateClosureCopy(a,o,u)}},generatePush:function(i,e,r,t,n){this.debug&&this.generateDebugCode("push"),this.generateLabel(),this.source.push("stack[++vm.sp] = ",i),void 0!==e&&(this.source.push(e,r),void 0!==t&&this.source.push(t,n)),this.source.push(";\n")},generateStoreInto:function(i,e,r,t,n){this.debug&&this.generateDebugCode("store into"),this.generateLabel(),this.source.push(i),void 0!==e&&(this.source.push(e,r),void 0!==t&&this.source.push(t,n)),this.source.push(" = stack[vm.sp];\n")},generatePopInto:function(i,e,r,t,n){this.debug&&this.generateDebugCode("pop into"),this.generateLabel(),this.source.push(i),void 0!==e&&(this.source.push(e,r),void 0!==t&&this.source.push(t,n)),this.source.push(" = stack[vm.sp--];\n")},generateReturn:function(e){this.debug&&this.generateDebugCode("return"),this.generateLabel(),this.source.push("vm.pc = ",this.pc,"; vm.doReturn(",e,"); return bytecodes + ",this.pc,";\n"),this.needsBreak=!1,this.done=this.pc>this.endPC},generateBlockReturn:function(){this.debug&&this.generateDebugCode("block return"),this.generateLabel(),this.source.push("vm.pc = ",this.pc,"; vm.doReturn(stack[vm.sp--], context.pointers[0]); return bytecodes + ",this.pc,";\n"),this.needsBreak=!1},generateJump:function(t){var e=this.pc+t;this.debug&&this.generateDebugCode("jump to "+e),this.generateLabel(),this.source.push("vm.pc = ",e,"; "),0>t?this.source.push("bytecodes += ",-t,"; "):this.source.push("bytecodes -= ",t,"; "),0>t&&this.source.push("\nif (vm.interruptCheckCounter-- <= 0) {\n","   vm.checkForInterrupts();\n","   if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",e,";\n","}\n"),this.singleStep&&this.source.push("\nif (vm.breakOutOfInterpreter) return bytecodes + ",e,";\n"),this.source.push("continue;\n"),this.needsBreak=!1,this.needsLabel[e]=!0,e>this.endPC&&(this.endPC=e)},generateJumpIf:function(t,i){var e=this.pc+i;this.debug&&this.generateDebugCode("jump if "+t+" to "+e),this.generateLabel(),this.source.push("var cond = stack[vm.sp--]; if (cond === vm.",t,"Obj) {vm.pc = ",e,"; bytecodes -= ",i,"; "),this.singleStep&&this.source.push("if (vm.breakOutOfInterpreter) return bytecodes + ",e,"; else "),this.source.push("continue}\n","else if (cond !== vm.",!t,"Obj) {vm.sp++; vm.pc = ",this.pc,"; vm.send(vm.specialObjects[25], 0, false); return bytecodes + ",this.pc,"}\n"),this.needsLabel[this.pc]=!0,this.needsLabel[e]=!0,e>this.endPC&&(this.endPC=e)},generateQuickPrim:function(e){switch(this.debug&&this.generateDebugCode("quick prim "+this.specialSelectors[(15&e)+16]),this.generateLabel(),e){case 194:return this.source.push("if (stack[vm.sp].sqClass === vm.specialObjects[7]) stack[vm.sp] = stack[vm.sp].pointersSize();\n","else if (stack[vm.sp].sqClass === vm.specialObjects[6]) stack[vm.sp] = stack[vm.sp].bytesSize();\n","else { vm.pc = ",this.pc,"; vm.sendSpecial(18); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"; }\n"),void(this.needsLabel[this.pc]=!0);case 198:return void this.source.push("var cond = stack[vm.sp-1] === stack[vm.sp];\nstack[--vm.sp] = cond ? vm.trueObj : vm.falseObj;\n");case 199:return void this.source.push("stack[vm.sp] = typeof stack[vm.sp] === 'number' ? vm.specialObjects[5] : stack[vm.sp].sqClass;\n");case 200:return this.source.push("vm.pc = ",this.pc,"; if (!vm.primHandler.quickSendOther(rcvr, ",15&e,")) ","{vm.sendSpecial(",(15&e)+16,"); return bytecodes + ",this.pc,"}\n"),this.needsLabel[this.pc]=!0,void(this.needsLabel[this.pc+2]=!0);case 201:case 202:case 203:return this.source.push("vm.pc = ",this.pc,"; if (!vm.primHandler.quickSendOther(rcvr, ",15&e,")) vm.sendSpecial(",(15&e)+16,"); return bytecodes + ",this.pc,";\n"),void(this.needsLabel[this.pc]=!0)}this.source.push("vm.pc = ",this.pc,"; if (!vm.primHandler.quickSendOther(rcvr, ",15&e,"))"," vm.sendSpecial(",(15&e)+16,");\n","if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,";\n","if (vm.pc !== ",this.pc,") throw Error('Huh?');\n"),this.needsBreak=!1,this.needsLabel[this.pc]=!0},generateNumericOp:function(e){switch(this.debug&&this.generateDebugCode("numeric op "+this.specialSelectors[15&e]),this.generateLabel(),this.needsLabel[this.pc]=!0,e){case 176:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = vm.primHandler.signed32BitIntegerFor(a + b);\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(0); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 177:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = vm.primHandler.signed32BitIntegerFor(a - b);\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(1); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 178:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a < b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(2); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 179:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a > b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(3); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 180:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a <= b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(4); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 181:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a >= b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(5); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 182:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a === b ? vm.trueObj : vm.falseObj;\n","} else if (a === b && a.float === a.float) {\n","   stack[--vm.sp] = vm.trueObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(6); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");
case 183:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a !== b ? vm.trueObj : vm.falseObj;\n","} else if (a === b && a.float === a.float) {\n","   stack[--vm.sp] = vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(7); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 184:return void this.source.push("vm.success = true; vm.resultIsFloat = false; if(!vm.pop2AndPushNumResult(vm.stackIntOrFloat(1) * vm.stackIntOrFloat(0))) { vm.pc = ",this.pc,"; vm.sendSpecial(8); return bytecodes + ",this.pc,"}\n");case 185:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.quickDivide(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(9); return bytecodes + ",this.pc,"}\n");case 186:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.mod(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(10); return bytecodes + ",this.pc,"}\n");case 187:return void this.source.push("vm.success = true; if(!vm.primHandler.primitiveMakePoint(1, true)) { vm.pc = ",this.pc,"; vm.sendSpecial(11); return bytecodes + ",this.pc,"}\n");case 188:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.safeShift(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(12); return bytecodes + ",this.pc,"}\n");case 189:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.div(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(13); return bytecodes + ",this.pc,"}\n");case 190:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.stackInteger(1) & vm.stackInteger(0))) { vm.pc = ",this.pc,"; vm.sendSpecial(14); return bytecodes + ",this.pc,"}\n");case 191:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.stackInteger(1) | vm.stackInteger(0))) { vm.pc = ",this.pc,"; vm.sendSpecial(15); return bytecodes + ",this.pc,"}\n")}},generateSend:function(e,t,i,r,n){this.debug&&this.generateDebugCode("send "+("lit["===e?this.method.pointers[t].bytesAsString():"...")),this.generateLabel(),this.source.push("vm.pc = ",this.pc,"; vm.send(",e,t,i,", ",r,", ",n,"); ","if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,";\n"),this.needsBreak=!1,this.needsLabel[this.pc]=!0},generateClosureTemps:function(e,i){if(this.debug&&this.generateDebugCode("closure temps"),this.generateLabel(),this.source.push("var array = vm.instantiateClass(vm.specialObjects[7], ",e,");\n"),i){for(var t=0;e>t;t++)this.source.push("array.pointers[",t,"] = stack[vm.sp - ",e-t-1,"];\n");this.source.push("stack[vm.sp -= ",e-1,"] = array;\n")}else this.source.push("stack[++vm.sp] = array;\n")},generateClosureCopy:function(n,e,s){var i=this.pc,t=i+s;if(this.debug&&this.generateDebugCode("push closure("+i+"-"+(t-1)+"): "+e+" copied, "+n+" args"),this.generateLabel(),this.source.push("var closure = vm.instantiateClass(vm.specialObjects[36], ",e,");\n","closure.pointers[0] = context; vm.reclaimableContextCount = 0;\n","closure.pointers[1] = ",i+4*this.method.pointers.length+1,";\n","closure.pointers[2] = ",n,";\n"),e>0){for(var r=0;e>r;r++)this.source.push("closure.pointers[",r+3,"] = stack[vm.sp - ",e-r-1,"];\n");this.source.push("stack[vm.sp -= ",e-1,"] = closure;\n")}else this.source.push("stack[++vm.sp] = closure;\n");this.source.push("vm.pc = ",t,";\n"),this.source.push("bytecodes -= ",s,";\n"),this.singleStep&&this.source.push("if (vm.breakOutOfInterpreter) return bytecodes + ",t,";\n"),this.source.push("continue;\n"),this.needsBreak=!1,this.needsLabel[i]=!0,this.needsLabel[t]=!0,t>this.endPC&&(this.endPC=t)},generateLabel:function(){this.sourceLabels[this.prevPC]=this.source.length,this.source.push("case ",this.prevPC,":\n"),this.prevPC=this.pc},generateDebugCode:function(i){this.needsBreak&&(this.source.push("if (vm.breakOutOfInterpreter) return bytecodes + (vm.pc = ",this.prevPC,");\n"),this.needsLabel[this.prevPC]=!0);for(var t=[],e=this.prevPC;e<this.pc;e++)t.push((this.method.bytes[e]+256).toString(16).slice(-2).toUpperCase());this.source.push("// ",this.prevPC," <",t.join(" "),"> ",i,"\n"),this.needsBreak=this.singleStep},generateInstruction:function(e,t){this.debug&&this.generateDebugCode(e),this.generateLabel(),this.source.push(t,";\n")},deleteUnneededLabels:function(){for(var t in this.sourceLabels)if(!this.needsLabel[t])for(var e=0;3>e;e++)this.source[this.sourceLabels[t]+e]=""}})}),module("users.bert.SqueakJS.plugins.ADPCMCodecPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function u(t,e){return e>31?0:t<<e}function l(t,e){return e>31?0:t>>>e}function k(){return g}function v(r,s){var i,e,t;for(e=s-r,0>e&&(e=0-e),i=63,t=1;62>=t;t++)63===i&&n[t-1]>=e&&(i=t);return i}function s(o){var e,n,s;for(n=0,e=o;;){if(s=e-i,!(s>0))return n+=l(t,0-s),i-=e,t&=l(255,8-i),n;n+=u(t,s),e-=i,t=a[++r-1],i=8}}function o(c,f){var o,n,s,e;for(n=f,s=c;;){if(o=8-i,e=o-s,!(0>e))return t+=u(n,e),i+=s,self;t+=l(n,0-e),a[++r-1]=t,i=0,t=0,n&=u(1,0-e)-1,s-=o}}function m(){var o,S,f,h,p,c,d,F,O,b,k,g,l,y,u,m,v;if(o=e.stackValue(1),S=e.stackIntegerValue(0),u=e.fetchIntegerofObject(0,o),l=e.fetchIntegerofObject(1,o),O=e.fetchIntegerofObject(2,o),k=e.fetchIntegerofObject(3,o),b=e.fetchIntegerofObject(4,o),g=e.fetchIntegerofObject(5,o),t=e.fetchIntegerofObject(6,o),i=e.fetchIntegerofObject(7,o),r=e.fetchIntegerofObject(8,o),a=e.fetchBytesofObject(9,o),v=e.fetchInt16ArrayofObject(10,o),m=e.fetchIntegerofObject(12,o),F=e.fetchIntegerofObject(13,o),n=e.fetchInt16ArrayofObject(14,o),y=e.fetchInt16ArrayofObject(15,o),e.failed())return null;for(p=1;S>=p;p++)if(1===(p&g))u=s(16),u>32767&&(u-=65536),l=s(6),v[++m-1]=u;else{for(h=s(F),d=n[l],c=0,f=b;f>0;)(h&f)>0&&(c+=d),d>>>=1,f>>>=1;c+=d,(h&O)>0?u-=c:u+=c,u>32767?u=32767:-32768>u&&(u=-32768),l+=y[h&k],0>l?l=0:l>88&&(l=88),v[++m-1]=u}return e.failed()?null:(e.storeIntegerofObjectwithValue(0,o,u),e.storeIntegerofObjectwithValue(1,o,l),e.storeIntegerofObjectwithValue(6,o,t),e.storeIntegerofObjectwithValue(7,o,i),e.storeIntegerofObjectwithValue(8,o,r),e.storeIntegerofObjectwithValue(12,o,m),void e.pop(1))}function d(){var o,x,m,g,b,S,c,f,d,k,u,l,F,y,P,I,V,O,j,p,A,v,C,h,w;if(o=e.stackValue(1),x=e.stackIntegerValue(0),v=e.fetchInt16ArrayofObject(0,o),p=e.fetchInt16ArrayofObject(1,o),I=e.fetchIntegerofObject(2,o),O=e.fetchIntegerofObject(3,o),V=e.fetchIntegerofObject(4,o),j=e.fetchIntegerofObject(5,o),t=e.fetchIntegerofObject(6,o),i=e.fetchIntegerofObject(7,o),r=e.fetchIntegerofObject(8,o),a=e.fetchBytesofObject(9,o),w=e.fetchInt16ArrayofObject(10,o),C=e.fetchInt16ArrayofObject(11,o),h=e.fetchIntegerofObject(12,o),P=e.fetchIntegerofObject(13,o),n=e.fetchInt16ArrayofObject(14,o),A=e.fetchInt16ArrayofObject(15,o),e.failed())return null;for(u=v[0],l=v[1],c=p[0],f=p[1],S=1;x>=S;S++)if(1===(S&j))u=s(16),c=s(6),l=s(16),f=s(6),u>32767&&(u-=65536),l>32767&&(l-=65536),w[++h-1]=u,C[h-1]=l;else{for(g=s(P),b=s(P),F=n[c],y=n[f],d=k=0,m=V;m>0;)(g&m)>0&&(d+=F),(b&m)>0&&(k+=y),F>>>=1,y>>>=1,m>>>=1;d+=F,k+=y,(g&I)>0?u-=d:u+=d,(b&I)>0?l-=k:l+=k,u>32767?u=32767:-32768>u&&(u=-32768),l>32767?l=32767:-32768>l&&(l=-32768),c+=A[g&O],0>c?c=0:c>88&&(c=88),f+=A[b&O],0>f?f=0:f>88&&(f=88),w[++h-1]=u,C[h-1]=l}return v[0]=u,v[1]=l,p[0]=c,p[1]=f,e.failed()?null:(e.storeIntegerofObjectwithValue(6,o,t),e.storeIntegerofObjectwithValue(7,o,i),e.storeIntegerofObjectwithValue(8,o,r),e.storeIntegerofObjectwithValue(12,o,h),void e.pop(1))}function p(){var s,y,k,g,f,d,S,p,m,c,I,P,F,O,l,A,u,h,b;if(s=e.stackValue(1),y=e.stackIntegerValue(0),u=e.fetchIntegerofObject(0,s),l=e.fetchIntegerofObject(1,s),P=e.fetchIntegerofObject(2,s),F=e.fetchIntegerofObject(4,s),O=e.fetchIntegerofObject(5,s),t=e.fetchIntegerofObject(6,s),i=e.fetchIntegerofObject(7,s),r=e.fetchIntegerofObject(8,s),a=e.fetchBytesofObject(9,s),b=e.fetchInt16ArrayofObject(10,s),h=e.fetchIntegerofObject(12,s),I=e.fetchIntegerofObject(13,s),n=e.fetchInt16ArrayofObject(14,s),A=e.fetchInt16ArrayofObject(15,s),e.failed())return null;for(c=n[0],d=1;y>=d;d++)if(1===(d&O))u=b[++h-1],(S=u)<0&&(S+=65536),o(16,S),y>d&&(l=v(u,b[h])),o(6,l);else{for(m=0,f=b[++h-1]-u,0>f&&(m=P,f=0-f),g=0,p=0,k=F;k>0;)f>=c&&(g+=k,p+=c,f-=c),c>>>=1,k>>>=1;p+=c,m>0?u-=p:u+=p,u>32767?u=32767:-32768>u&&(u=-32768),l+=A[g],0>l?l=0:l>88&&(l=88),c=n[l],o(I,m|g)}return i>0&&(a[++r-1]=t),e.failed()?null:(e.storeIntegerofObjectwithValue(0,s,u),e.storeIntegerofObjectwithValue(1,s,l),e.storeIntegerofObjectwithValue(6,s,t),e.storeIntegerofObjectwithValue(7,s,i),e.storeIntegerofObjectwithValue(8,s,r),e.storeIntegerofObjectwithValue(12,s,h),void e.pop(1))}function c(){var s,o;return s=e.stackValue(1),o=e.stackIntegerValue(0),t=e.fetchIntegerofObject(6,s),i=e.fetchIntegerofObject(7,s),r=e.fetchIntegerofObject(8,s),a=e.fetchIntegerofObject(9,s),n=e.fetchIntegerofObject(14,s),e.failed()?null:(success(!1),e.failed()?null:(e.storeIntegerofObjectwithValue(6,s,t),e.storeIntegerofObjectwithValue(7,s,i),e.storeIntegerofObjectwithValue(8,s,r),void e.pop(1)))}function b(i){var t;return e=i,t=e.majorVersion()==f,t===!1?!1:t=e.minorVersion()>=h}var f=1,h=11,i=0,r=0,t=0,a=null,e=null,g="ADPCMCodecPlugin 3 November 2014 (e)",n=null;Squeak.registerExternalModule("ADPCMCodecPlugin",{primitiveDecodeStereo:d,primitiveEncodeStereo:c,setInterpreter:b,primitiveEncodeMono:p,primitiveDecodeMono:m,getModuleName:k})}),module("users.bert.SqueakJS.plugins.B2DPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function se(t){return"number"==typeof t?e.classSmallInteger():t.sqClass}function p(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function Gf(e){return e.bytes?e.bytes.length:e.words?4*e.words.length:0}function Oe(e,t){return 0|Math.floor(e/t)}function Kf(e,t){return e-Oe(e,t)*t|0}function M(t,e){return e>31?0:t<<e}function n(t,e){return e>31?0:t>>>e}function x(e,t){return new Int32Array(e.buffer,e.byteOffset+4*t)}function no(e,t){return new Float32Array(e.buffer,e.byteOffset+4*t)}function D(){return t[ia]}function Qr(e){return t[ia]=e}function te(){return t[ra]}function Df(e){return t[ra]=e}function _t(i,t){var e;return e=i+P()-1&~(P()-1),e>t?t:e}function Nf(e){return t[cc]=e}function Nt(t,e){return e-1&~(P()-1)}function P(){return t[na]}function Vf(e){return t[na]=e}function me(){return t[sa]}function Hr(e){return t[sa]=e}function g(){return t[aa]}function Or(e){return t[aa]=e}function Qu(i){var e,t;return e=65535&i,t=i>>>16&255,(e*e>>>16)+e*t*2+(t*t<<16)>>>8}function bi(e,t){var i;return 0===e?0>t?0-t:t:0===t?0>e?0-e:e:(i=e*e+t*t,yl(i))}function br(e){return ms(1)?(B[K()]=e,void fr(K()+1)):0}function vu(e,i,t,s){var r,n;z(e)[T]=z(e)[T]-256*t,r=ee(e)[T],ee(e)[T]=r+256*(i-t),n=ee(e)[qe],ee(e)[qe]=n+256*i,ya(e,s-t)}function yo(e,t,i,s){var r,n;z(e)[T]=z(e)[T]+256*i,r=ee(e)[T],ee(e)[T]=r-256*(t-i),n=ee(e)[qe],ee(e)[qe]=n+256*t,ya(e,s-i+t)}function xf(e,r,l){var s,i,a,t,n,u,o;u=sn(e),o=on(e),s=fi(e),a=Ce(s),t=ln(e),n=qi(e),i=l-r,s>u&&(0>n?t-=i:(t+=i,G(e,r))),o+a===0&&(n>0?t-=He(e):(t+=He(e),G(e,r))),o+a>0&&(0>n?(t+=i,G(e,r)):t-=i),ni(e,t)}function C(){return t[oa]}function oe(e){return t[oa]=e}function W(){return t[ua]}function Kt(e){return t[ua]=e}function so(e){return X(e)}function af(){var e;return be(Ge)?(e=O,O=e+Ge,U(e,ds),ne(e,0),pe(e,Ge),e):0}function Hi(){return uo(6),E()}function hc(i,s){var n,t,r,e;if(r=lu+i,!be(r))return 0;if(t=O,O=t+r,U(t,ol),ne(t,0),pe(t,r),n=Is(t),gi())for(e=0;i-1>=e;e++)n[e]=q(s[e]);else for(e=0;i-1>=e;e++)n[e]=s[e];return Zc(t,i),t}function ms(e){var i,t,r,n;if(!so(e))return!1;if(0!==W())for(r=W(),i=W()+e,t=1,n=W();n>=t;t++)b[--i]=b[--r];return b=x(b,e),!0}function rc(s,i,a){var t,r,e,n;if(r=Ul+i,!be(r))return 0;if(t=O,O=t+r,a?U(t,dl):U(t,pl),ne(t,0),pe(t,r),n=Pi(t),gi())for(e=0;i-1>=e;e++)n[e]=q(s[e]);else for(e=0;i-1>=e;e++)n[e]=s[e];return qc(t,i),t}function ec(){var e;return be(Ae)?(e=O,O=e+Ae,U(e,bs),ne(e,0),pe(e,Ae),e):0}function be(e){var i,t,r,n;if(!ms(e))return!1;if(0!==K())for(r=K(),i=K()+e,t=1,n=K();n>=t;t++)B[--i]=B[--r];return B=x(B,e),!0}function Fl(e){return X(e)}function An(){return uo(_())}function $o(){var e;return be(Ii)?(e=O,O=e+Ii,U(e,kl),ne(e,0),pe(e,Ii),e):0}function Qo(){var e;return be(st)?(e=O,O=e+st,U(e,gl),ne(e,0),pe(e,st),e):0}function Yo(e){return 0===(Ro(e)&vr)}function nn(e,t,i){if(t>i){if(e>t)return t;if(i>e)return i}else{if(t>e)return t;if(e>i)return i}return e}function _i(e){return s(e,qn)}function $r(e,t){return a(e,qn,t)}function Mi(e){return s(e,Mn)}function Xa(e,t){return a(e,Mn,t)}function Aa(e){return s(e,Bn)}function ya(e,t){return a(e,Bn,t)}function z(e){return x(Z,e+mu)}function Of(e){return s(e,Ln)}function io(e,t){return a(e,Ln,t)}function Lo(e){return s(e,Rn)}function Un(e,t){return a(e,Rn,t)}function Jl(e){return s(e,xn)}function Zc(e,t){return a(e,xn,t)}function ff(e){return s(e,Pn)}function mf(e,t){return a(e,Pn,t)}function po(e){return s(e,Cn)}function Lu(e,t){return a(e,Cn,t)}function Uf(e){return s(e,wn)}function sc(e,t){return a(e,wn,t)}function zf(e){return s(e,Vn)}function Rf(e,t){return a(e,Vn,t)}function ho(e){return s(e,Nn)}function _f(e,t){return a(e,Nn,t)}function Ut(r,h,u,f){var p,s,t,l,c,o,a,i,e;return t=ff(r),l=Uf(r),32===t?(e=0|h[l*f+u],0!==e&&0===(4278190080&e)&&(e=4278190080|e),ao(e)):(i=Pl()[t],e=h[l*f+n(u,i)],c=M(1,t)-1,i=32-t-(u&M(1,i)-1)*t,e=n(e,i)&c,16===t?0!==e&&(s=(31&e)<<3,s+=s>>>5,o=(e>>>5&31)<<3,o+=o>>>5,a=(e>>>10&31)<<3,a+=a>>>5,p=255,e=s+(o<<8)+(a<<16)+(p<<24)):e=0===Jl(r)?0:Is(r)[e],ao(e))}function fo(e){return s(e,jn)}function Mf(e,t){return a(e,jn,t)}function Te(e){return de(E()-e+4)}function qt(e,t){return he(E()-e+4,t)}function je(e){return de(E()-e+5)}function xt(e,t){return he(E()-e+5,t)}function $e(e){return de(E()-e+0)}function Zr(e,t){return he(E()-e+0,t)}function we(e){return de(E()-e+1)}function Yr(e,t){return he(E()-e+1,t)}function Vt(e){return de(E()-e+2)}function Ct(e,t){return he(E()-e+2,t)}function Pt(e){return de(E()-e+3)}function At(e,t){return he(E()-e+3,t)}function Xr(n,o,u){var t,e,s,i,a,r;for(s=p(n),t=n.wordsAsInt32Array(),i=0,e=0;s-1>=e;e++){if(a=We(e,t),r=It(e,t),!(r>=0&&o>=r))return!1;i+=a}return i===u}function wf(i){var r,n,t,s;if(!e.isWords(i))return!1;for(s=p(i),n=i.wordsAsInt32Array(),t=0;s-1>=t;t++)if(r=n[t],!L(r))return!1;return!0}function Pf(i,a){var e,r,t,n,s;for(r=p(i),n=i.wordsAsInt32Array(),t=0,e=0;r-1>=e;e++)s=We(e,n),t+=s;return t===a}function Af(i,r){var t;return e.isWords(i)?(t=p(i),t!==3*r&&t!==6*r?!1:!0):!1}function If(r,e,n,s,a,o,i){var t;return Af(r,e)&&wf(i)?(t=p(i),Xr(n,t,e)&&Xr(s,t,e)&&Xr(o,t,e)&&Pf(a,e)?!0:!1):!1}function yf(e){var t;return t=Ue(e)?or(e):0,Mi(e)+t<Qt()?0:A(e)-t>=re()&&_i(e)-t>=re()?0:void br(e)}function Xc(e){return Io(e)?Nc(e):Uc(e)?yf(e):void br(e)}function Nc(e){var t;return t=Ue(e)?fi(e):0,xi(e)+t<Qt()?0:A(e)-t>=re()&&_n(e)-t>=re()?0:void br(e)}function Rr(){var e=[1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0,.1950903220161282,.38268343236509,.555570233019602,.707106781186547,.831469612302545,.9238795325112865,.98078528040323,1];return e}function Lr(){var e=[0,.1950903220161282,.3826834323650897,.555570233019602,.707106781186547,.831469612302545,.923879532511287,.98078528040323,1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0];return e}function Fe(e,t){return 0>e?0:e>=t?t-1:e}function pi(){var e,t;for(e=n(Ei(),g()),t=n(Gt(),g())+1,0>e&&(e=0),t>Se()&&(t=Se());t>e;)u[e]=0,++e;Ki(Se()),zt(0)}function _r(){return t[da]}function Le(e){return t[da]=e}function Re(){return t[ma]}function xr(e){return t[ma]=e}function Vr(){return t[va]}function Es(e){return t[va]=e}function ze(){return t[ka]}function Ar(e){return t[ka]=e}function Ir(){return t[ga]}function As(e){return t[ga]=e}function $t(){return no(t,Pc)}function Is(e){return x(Z,e+nu)}function Fs(e,s){var f,o,u,n,t,l,a,c,i,m,h,p,d;return u=m=$e(e),n=h=we(e),l=p=Vt(e),a=d=Pt(e),f=Te(e),o=je(e),c=u+=(p-m)*s|0,i=n+=(d-h)*s|0,l+=(f-p)*s|0,a+=(o-d)*s|0,c+=(l-u)*s|0,i+=(a-n)*s|0,n=nn(n,h,i),a=nn(a,i,o),t=Hi(),r?0:(Ct(e,u),At(e,n),qt(e,c),xt(e,i),Zr(t,c),Yr(t,i),Ct(t,l),At(t,a),qt(t,f),xt(t,o),t)}function Ss(e){var l,c,n,s,t,o,a,u,i,p,d,f,h;return t=Hi(),r?0:(n=p=$e(e),s=d=we(e),o=f=Vt(e),a=h=Pt(e),l=Te(e),c=je(e),n+=f-p>>1,s+=h-d>>1,u=o+=l-f>>1,i=a+=c-h>>1,u+=n-o>>1,i+=s-a>>1,Ct(e,n),At(e,s),qt(e,u),xt(e,i),Zr(t,u),Yr(t,i),Ct(t,o),At(t,a),qt(t,l),xt(t,c),t)}function ys(i,r){var e,t,n;e=z(i)[T]>>8,t=ee(i)[T]>>8,e>t&&(n=e,e=t,t=n),G(i,e),t-e>r?ur(i,t-e):ur(i,r)}function yl(e){return 32>e?El()[e]:Math.sqrt(e)+.5|0}function bl(e,t,i){return jt||ki()?jt(e,t,i):!1}function Yu(){var t,e;for(e=0,t=O;t>e;)Qc(e)&&(Q(e)>=Ri()||Xc(e)),e+=Go(e)}function y(){return t[Ca]}function Je(e){return t[Ca]=e}function kr(){return t[wa]}function Hn(e){return t[wa]=e}function mr(){return t[Va]}function pu(e){return t[Va]=e}function hr(){return t[ja]}function To(e){return t[ja]=e}function lr(r){var e,t,i;return e=n(Ei(),g()),e<ze()&&(e=ze()),t=n(Gt()+P()-1,g()),t>Re()&&(t=Re()),i=n(r,g()),i<Ir()||i>=Vr()||t<ze()||e>=Re()?0:void bl(e,t,i)}function oi(e){return U(e,J(e)|vr)}function li(e){return U(e,J(e)&~vr)}function Co(e){return s(e,us)}function ar(e,t){return a(e,us,t)}function fe(e){return s(e,cs)}function H(e,t){return a(e,cs,t)}function mo(e){return s(e,ls)}function sr(e,t){return a(e,ls,t)}function nr(){return no(t,Lc)}function kf(e){return J(e)>>>1}function A(e){return s(e,ws)}function G(e,t){return a(e,ws,t)}function Q(e){return s(e,Vs)}function ht(e,t){return a(e,Vs,t)}function Ji(e){return s(e,js)}function ti(e,t){return a(e,js,t)}function pt(){}function fa(n,r){var e,i,t;for(e=Zt(),i=n,t=rr();r>t;){if(e=Zt(),0!==e&&cn(e,i,t))return!0;Xt(t),i=t,t=rr()}return e=Zt(),0!==e?cn(e,i,r):!1}function xc(){return lc(Dt(),xe(),Ne(),y())}function fc(l,f,h){var a,r,c,o,i,s,t,e;if(t=f,e=h,r=-1,1===P())for(;e>t;)i=0|l[++r],u[t]=i,++t;else for(c=D(),o=te(),a=g();e>t;)s=n(t,a),i=0|l[++r],i=n(i&c,o),u[s]=u[s]+i,++t;e>Gt()&&zt(e),e>Jt()&&Ot(e)}function lc(e,c,g,b){var h,s,a,d,l,n,f,r,p,v,m,o,k,i,t;if(1!==P())return uc(e,c,g,b);if(h=Cs(e),!h)return null;for(a=fo(e),s=po(e),m=1===ho(e),d=c-ge(e),l=b-ai(e),f=mi(e),p=Wi(e),n=d*f+l*Si(e),r=d*p+l*Ni(e),o=c,k=g;k>o;)m&&(n=ye(n,a<<16),r=ye(r,s<<16)),i=n>>16,t=r>>16,m||(i=Fe(i,a),t=Fe(t,s)),i>=0&&t>=0&&a>i&&s>t&&(v=Ut(e,h,i,t),u[o]=v),n+=f,r+=p,++o}function uc(i,b,F,w){var C,y,k,l,o,d,h,O,S,s,v,r,m,a,A,f,I,p,c,t,e;if(k=Cs(i),!k)return null;for(o=fo(i),l=po(i),p=1===ho(i),O=b-ge(i),S=w-ai(i),v=mi(i),m=Wi(i),s=O*v+S*Si(i),r=O*m+S*Ni(i),C=P(),A=_t(b,F),I=Nt(b,F),y=g(),d=D(),h=te(),c=b;A>c;)p&&(s=ye(s,o<<16),r=ye(r,l<<16)),t=s>>16,e=r>>16,p||(t=Fe(t,o),e=Fe(e,l)),t>=0&&e>=0&&o>t&&l>e&&(a=Ut(i,k,t,e),a=n(a&d,h),f=n(c,y),u[f]=u[f]+a),s+=v,r+=m,++c;for(d=4042322160|n(D(),g()),h=g();I>c;)p&&(s=ye(s,o<<16),r=ye(r,l<<16)),t=s>>16,e=r>>16,p||(t=Fe(t,o),e=Fe(e,l)),t>=0&&e>=0&&o>t&&l>e&&(a=Ut(i,k,t,e),a=n(a&d,h),f=n(c,y),u[f]=u[f]+a),s+=M(v,h),r+=M(m,h),c+=C;for(d=D(),h=te();F>c;)p&&(s=ye(s,o<<16),r=ye(r,l<<16)),t=s>>16,e=r>>16,p||(t=Fe(t,o),e=Fe(e,l)),t>=0&&e>=0&&o>t&&l>e&&(a=Ut(i,k,t,e),a=n(a&d,h),f=n(c,y),u[f]=u[f]+a),s+=v,r+=m,++c}function bt(t,r,n){var e,i;if(1!==P())return nc(t,r,n);for(e=r,i=n;i>e+4;)u[e]=t,u[e+1]=t,u[e+2]=t,u[e+3]=t,e+=4;for(;i>e;)u[e]=t,++e}function nc(l,a,r){var f,s,h,o,t,c,i,e;if(o=_t(a,r),c=Nt(a,r),f=P(),s=g(),e=a,o>e)for(i=n(l&D(),te());o>e;)t=n(e,s),u[t]=u[t]+i,++e;if(c>e)for(h=4042322160|n(D(),g()),i=n(l&h,g());c>e;)t=n(e,s),u[t]=u[t]+i,e+=f;if(r>e)for(i=n(l&D(),te());r>e;)t=n(e,s),u[t]=u[t]+i,++e}function mi(e){return s(e,Ns)}function ic(e,t){return a(e,Ns,t)}function Si(e){return s(e,_s)}function tc(e,t){return a(e,_s,t)}function Yl(){return Xl(Dt(),xe(),Ne(),y())}function Xl(i,c,f,h){var n,s,o,e,r,t,l,a;for(o=Pi(i),r=Lt(i),s=mi(i),n=(c-ge(i))*s+(h-ai(i))*Si(i),t=l=c,a=f;((e=n>>16)<0||e>=r)&&a>t;)++t,n+=s;if(t>l&&(0>e&&(e=0),e>=r&&(e=r-1),bt(o[e],l,t)),1===P())for(;(e=n>>16)<r&&e>=0&&a>t;)u[t]=o[e],++t,n+=s;else t=Hl(i,o,n,s,t,f);a>t&&(0>e&&(e=0),e>=r&&(e=r-1),bt(o[e],t,a))}function Hl(y,p,b,v,h,l){var k,c,o,a,r,d,s,m,e,f,i,t;for(k=P(),c=g(),f=Lt(y),r=b,t=h,e=r>>16,d=_t(h,l),m=Nt(h,l),o=D(),a=te();d>t&&f>e&&e>=0;){for(i=p[e],i=n(i&o,a);d>t&&r>>16===e;)s=n(t,c),u[s]=u[s]+i,++t,r+=v;e=r>>16}for(o=4042322160|n(D(),g()),a=g();m>t&&f>e&&e>=0;){for(i=p[e],i=n(i&o,a);m>t&&r>>16===e;)s=n(t,c),u[s]=u[s]+i,t+=k,r+=M(v,a);e=r>>16}for(o=D(),a=te();l>t&&f>e&&e>=0;){for(i=p[e],i=n(i&o,a);l>t&&r>>16===e;)s=n(t,c),u[s]=u[s]+i,++t,r+=v;e=r>>16}return t}function re(){return t[xa]}function zl(e){return t[xa]=e}function Ri(){return t[qa]}function Tl(e){return t[qa]=e}function Li(){return t[Ma]}function Il(e){return t[Ma]=e}function Qt(){return t[Ba]}function eu(e){return t[Ba]=e}function Wi(e){return s(e,Ws)}function Uo(e,t){return a(e,Ws,t)}function Ni(e){return s(e,Ds)}function xo(e,t){return a(e,Ds,t)}function ge(e){return s(e,Ts)}function Wf(e,t){return a(e,Ts,t)}function ai(e){return s(e,Ls)}function jf(e,t){return a(e,Ls,t)}function Cf(f,l,a,m,d,h,p){var t,r,s,c,e,o,i,n;for(t=0|a[0],r=0|a[1],e=bi(t>>16,r>>16),o=l[e],s=(e-1)*(e-1),i=h,n=p,n>ge(f)&&(n=ge(f));n>i;){for(;n>i&&j(t>>16,r>>16)>=s;)u[i]=o,++i,t+=m,r+=d;for(c=j(t>>16,r>>16);s>c;)--e,o=l[e],s=(e-1)*(e-1)}return a[0]=t,a[1]=r,i}function Ff(I,h,m,b,S,y,F){var O,d,c,a,r,s,v,l,k,o,p,t,e,i,f;if(r=0|m[0],s=0|m[1],O=P(),d=g(),t=bi(r>>16,s>>16),o=(t-1)*(t-1),i=y,f=ge(I),f>F&&(f=F),v=_t(y,f),k=Nt(y,f),v>i)for(c=D(),a=te(),e=h[t],e=n(e&c,a);v>i;){for(;v>i&&j(r>>16,s>>16)>=o;)l=n(i,d),u[l]=u[l]+e,++i,r+=b,s+=S;for(p=j(r>>16,s>>16);o>p;)--t,e=h[t],e=n(e&c,a),o=(t-1)*(t-1)}if(k>i)for(c=4042322160|n(D(),g()),a=g(),e=h[t],e=n(e&c,a);k>i;){for(;k>i&&j(r>>16,s>>16)>=o;)l=n(i,d),u[l]=u[l]+e,i+=O,r+=M(b,a),s+=M(S,a);for(p=j(r>>16,s>>16);o>p;)--t,e=h[t],e=n(e&c,a),o=(t-1)*(t-1)}if(f>i)for(c=D(),a=te(),e=h[t],e=n(e&c,a);f>i;){for(;f>i&&j(r>>16,s>>16)>=o;)l=n(i,d),u[l]=u[l]+e,++i,r+=b,s+=S;for(p=j(r>>16,s>>16);o>p;)--t,e=h[t],e=n(e&c,a),o=(t-1)*(t-1)}return m[0]=r,m[1]=s,i}function Fc(){return ac(Dt(),xe(),Ne(),y())}function ac(t,c,d,v){var s,p,h,l,o,f,a,m,n,u,e,r;for(n=Pi(t),u=Lt(t),p=c-ge(t),h=v-ai(t),o=mi(t),a=Wi(t),l=p*o+h*Si(t),f=p*a+h*Ni(t),e=c,r=d,m=(u-1)*(u-1);j(l>>16,f>>16)>=m&&r>e;)++e,l+=o,f+=a;e>c&&bt(n[u-1],c,e),s=i(),s[0]=l,s[1]=f,e<ge(t)&&(e=1===P()?Cf(t,n,s,o,a,e,r):Ff(t,n,s,o,a,e,r)),r>e&&(e=1===P()?Ho(t,n,s,o,a,e,r):zo(t,n,s,o,a,e,r)),d>e&&bt(n[u-1],e,d)}function Ho(k,h,n,v,m,d,p){var i,t,a,f,s,e,l,o,r,c;for(i=0|n[0],t=0|n[1],e=bi(i>>16,t>>16),o=h[e],l=Lt(k),f=(l-1)*(l-1),s=(e+1)*(e+1),a=j(i>>16,t>>16),r=d,c=p;c>r&&f>a;){for(;c>r&&j(i>>16,t>>16)<=s;)u[r]=o,++r,i+=v,t+=m;for(a=j(i>>16,t>>16);a>s;)++e,o=h[e],s=(e+1)*(e+1)}return n[0]=i,n[1]=t,r}function zo(A,p,b,F,y,S,d){var I,k,f,o,r,a,m,c,s,v,h,l,t,O,e,i;if(r=0|b[0],a=0|b[1],I=P(),k=g(),t=bi(r>>16,a>>16),O=Lt(A),h=(O-1)*(O-1),l=(t+1)*(t+1),s=j(r>>16,a>>16),i=S,m=_t(S,d),v=Nt(S,d),m>i&&h>s)for(f=D(),o=te(),e=p[t],e=n(e&f,o);m>i&&h>s;){for(;m>i&&j(r>>16,a>>16)<=l;)c=n(i,k),u[c]=u[c]+e,++i,r+=F,a+=y;for(s=j(r>>16,a>>16);s>l;)++t,e=p[t],e=n(e&f,o),l=(t+1)*(t+1)}if(v>i&&h>s)for(f=4042322160|n(D(),g()),o=g(),e=p[t],e=n(e&f,o);v>i&&h>s;){for(;v>i&&j(r>>16,a>>16)<=l;)c=n(i,k),u[c]=u[c]+e,i+=I,r+=M(F,o),a+=M(y,o);for(s=j(r>>16,a>>16);s>l;)++t,e=p[t],e=n(e&f,o),l=(t+1)*(t+1)}if(d>i&&h>s)for(f=D(),o=te(),e=p[t],e=n(e&f,o);d>i&&h>s;){for(;d>i&&j(r>>16,a>>16)<=l;)c=n(i,k),u[c]=u[c]+e,++i,r+=F,a+=y;for(s=j(r>>16,a>>16);s>l;)++t,e=p[t],e=n(e&f,o),l=(t+1)*(t+1)}return b[0]=r,b[1]=a,i}function vn(t,i){var e;return e=Ee(t)-Ee(i),0!==e?e>0:Ke(t)>>>0<Ke(i)>>>0}function cn(i,n,s){var r,t,e;if(0===i)return!1;if(t=n<Jt()?Jt():n,e=s>M(Se(),g())?M(Se(),g()):s,t<Li()&&(t=Li()),e>re()&&(e=re()),t<Ei()&&Ki(t),e>Gt()&&zt(e),e>Jt()&&Ot(e),t>=e)return!1;if(vi(i))bt(i,t,e);else{if(Ko(i),Jo(t),Xo(e),r=vf(i),1>=r)return!0;switch(r){case 0:case 1:pt();break;case 2:Yl();break;case 3:Fc();break;case 4:case 5:xc()}}return!1}function vf(e){return(J(e)&gs)>>>8}function ji(){var e,t,i;for(i=y();Y()<K();){if(e=B[Y()],Q(e)>i)return!1;if(t=J(e),(t&ri)===Fr)return!0;if(!X(1))return!1;switch(t){case 0:case 1:case 2:case 3:pt();break;case 4:mc();break;case 5:bc();break;case 6:pc();break;case 7:kc()}rn(e),yi(Y()+1)}return!1}function Ci(){var t,i,n,e;for(i=e=re();C()<W();){if(t=n=b[C()],i=e=A(t),i>=re())return!1;if(Xt(i),Ue(t)&&Hc(t),Yo(t)&&(Jc(t),r))return!1;oe(C()+1),C()<W()&&(n=b[C()],e=A(n),e>=Li()&&fa(i,e))}return e<re()&&fa(e,re()),!1}function Ai(){for(var t,e,i;C()<W();)if(e=b[C()],t=fe(e)-1,0===t)Dn();else{if(H(e,t),i=J(e),(i&ri)===Fr)return!0;switch(i){case 0:case 1:case 2:case 3:pt();break;case 4:Ic();break;case 5:Vc();break;case 6:Sc();break;case 7:Cc()}Yn(),oe(C()+1)}return!1}function Tn(t,i){var e;for(e=0;e<V()&&(Ke(e)!==t||Ee(e)!==i);)e+=_();return e>=V()?-1:e}function Rt(){return _e()===Ye}function co(){Sf(_())}function Mo(){return Ef}function et(t,i){var e;return t===i?!0:(e=Q(t)-Q(i),0!==e?0>e:(e=A(t)-A(i),0>e))}function Y(){return t[Na]}function yi(e){return t[Na]=e}function K(){return t[_a]}function fr(e){return t[_a]=e}function Lt(e){return s(e,Rs)}function qc(e,t){return a(e,Rs,t)}function Pi(e){return x(Z,e+Gl)}function gi(){return 0!==tu()}function tu(){return t[Wa]}function wi(e){return t[Wa]=e}function Bc(){return 0!==Wc()}function Wc(){return t[Da]}function Vi(e){return t[Da]=e}function os(s,a){var e,i,r,n,t;if(e=Tn(s,a),-1===e)return!1;if(0===e)return co(),!0;if(kt(e,Ke(0)),yt(e,Ee(0)),Xe(e,di(0)),co(),V()<=_())return!0;for(t=0,e=_();e<V();)vn(e,t)&&(t=e),e+=_();return t+_()===V()?!0:(n=Ke(t),kt(t,tr()),ir(n),i=Ee(t),yt(t,Zi()),Qi(i),r=di(t),Xe(t,$i()),er(r),!0)}function h(e,i){return t[e]=t[e]+i}function Sl(i){var e,t;for(t=A(i),e=0;e<W()&&A(b[e])<t;)++e;for(;e<W()&&A(b[e])===t&&et(b[e],i);)++e;return e}function Rl(){var e;e=$t(),e[0]=1,e[1]=0,e[2]=1,e[3]=0,e[4]=1,e[5]=0,e[6]=1,e[7]=0,wi(0)}function Ql(){var e;e=nr(),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,Vi(0)}function ki(){return Tt=e.ioLoadFunctionFrom("loadBitBltFrom",Ft),jt=e.ioLoadFunctionFrom("copyBitsFromtoat",Ft),!!Tt&&!!jt}function lo(){return Zn(P()),ze()<0&&Ar(0),Re()>Se()&&xr(Se()),Il(M(ze(),g())),eu(M(Ir(),g())),zl(M(Re(),g())),Tl(M(Vr(),g())),fr(0),Kt(0),B=x(Z,O),b=x(Z,O),Yu(),r?null:0===K()?(Je(Ri()),0):(Kl(),Je(Q(B[0])),y()<Qt()&&Je(Qt()),Ki(0),zt(M(Se(),g())-1),void pi())}function rn(e){var t;return fe(e)<=0?null:(t=Sl(e),void Ec(e,t))}function Ec(i,t){var e;if(!so(1))return null;for(e=W()-1;!(t>e);)b[e+1]=b[e],--e;b[t]=i,Kt(W()+1)}function Uc(e){return(J(e)&ri)===ds}function Qc(e){var t;return t=J(e),t>vs?!1:0!==(J(e)&vs)}function nf(e){return vi(e)||qo(e)}function vi(e){return 0!==(4278190080&e)}function L(e){return 0===e||vi(e)||Ao(e)&&nf(e)}function Io(e){return(J(e)&ri)===bs}function Ao(e){return e>=0&&O>e}function qo(e){return 0!==(J(e)&gs)}function Ue(e){return 0!==(J(e)&vl)}function _o(){return t[Ta]}function Do(e){return t[Ta]=e}function Dt(){return t[La]}function Ko(e){return t[La]=e}function xe(){return t[Ra]}function Jo(e){return t[Ra]=e}function Ne(){return t[Ea]}function Xo(e){return t[Ea]=e}function _n(e){return s(e,Ks)}function hl(e,t){return a(e,Ks,t)}function xi(e){return s(e,zs)}function Al(e,t){return a(e,zs,t)}function Cl(e){return s(e,Us)}function wl(e,t){return a(e,Us,t)}function jl(e){return s(e,Js)}function Nl(e,t){return a(e,Js,t)}function Ll(e){return s(e,Gs)}function es(e,t){return a(e,Gs,t)}function qi(e){return s(e,ea)}function $l(e,t){return a(e,ea,t)}function He(e){return s(e,ta)}function dc(e,t){return a(e,ta,t)}function vc(e,t){return a(e,oc,t)}function ci(s,a,o,l){var e,u,t,n,i;if(e=Hi(),r)return 0;for(Zr(e,s[0]),Yr(e,s[1]),Ct(e,a[0]),At(e,a[1]),qt(e,o[0]),xt(e,o[1]),i=u=Kc(e,l),t=e;u>=t;t+=6)if(n=Yi(t),n>i&&(i=n),r)return 0;return Oe(i,6)}function Oc(u,c,f,h,p){var t,n,s,a,o;if(I(i(),e.fetchPointerofObject(0,u)),e.failed())return null;for(n=i()[0],a=i()[1],t=1;c-1>=t;t++){if(I(i(),e.fetchPointerofObject(t,u)),e.failed())return null;if(s=i()[0],o=i()[1],i()[0]=n,i()[1]=a,l()[0]=s,l()[1]=o,ae(2),ce(h,i(),l(),p,f,0),r)return null;n=s,a=o}}function Ac(s,k,p,a,o){var t,n,v,h,c,d,m,u,f;for(t=0;k-1>=t;t++){if(n=e.fetchPointerofObject(3*t,s),I(i(),n),n=e.fetchPointerofObject(3*t+1,s),I(l(),n),n=e.fetchPointerofObject(3*t+2,s),I(S(),n),e.failed())return null;if(ae(3),h=i()[0],m=i()[1],c=l()[0],u=l()[1],d=S()[0],f=S()[1],h===m&&c===u||c===d&&u===f)ce(a,i(),S(),o,p,0);else{if(v=ci(i(),l(),S(),0!==a&&0!==o),r)return null;ui(a,o,p,0,v)}if(r)return null}}function wc(n,r,s){var t,i;for(t=0;s-1>=t;t++){if(i=e.fetchPointerofObject(t,n),"number"!=typeof i&&!i.isFloat)return e.primitiveFail();"number"==typeof i?r[t]=i:r[t]=e.floatValueOf(i)}}function jc(e,t,r,n,i){je(t)>=we(t)?(G(e,$e(t)),ht(e,we(t)-i),io(e,Vt(t)),Un(e,Pt(t)-i),$r(e,Te(t)),Xa(e,je(t)-i)):(G(e,Te(t)),ht(e,je(t)-i),io(e,Vt(t)),Un(e,Pt(t)-i),$r(e,$e(t)),Xa(e,we(t)-i)),ti(e,kr()),ar(e,r),sr(e,n)}function ps(e){return Tt||ki()?Tt(e):!1}function Mc(n,u,b,g,k,v,m){var l,d,t,i,o,f,a,h,s,c;if(u.isNil)s=0,h=null;else{if(se(u)!==e.classBitmap())return e.primitiveFail();s=p(u),h=u.wordsAsInt32Array()}return"number"==typeof n?e.primitiveFail():e.isPointers(n)?p(n)<5?e.primitiveFail():(l=e.fetchPointerofObject(0,n),se(l)!==e.classBitmap()?e.primitiveFail():(d=p(l),a=e.fetchIntegerofObject(1,n),o=e.fetchIntegerofObject(2,n),t=e.fetchIntegerofObject(3,n),e.failed()?null:a>=0&&o>=0?32!==t&&8!==t&&16!==t&&1!==t&&2!==t&&4!==t?e.primitiveFail():0!==s&&s!==M(1,t)?e.primitiveFail():(c=Oe(32,t),f=Oe(a+(c-1),c),d!==f*o?e.primitiveFail():(i=hc(s,h),r?null:(Mf(i,a),Lu(i,o),mf(i,t),sc(i,f),Rf(i,d),_f(i,b),ne(i,m),ha(i,g,k,v,a,o),i))):e.primitiveFail())):e.primitiveFail()}function Cs(r){var n,t,s,i;return i=ii(r),i>p(Wt)?null:(s=e.fetchPointerofObject(i,Wt),t=e.fetchPointerofObject(0,s),n=p(t),n!==zf(r)?null:t.wordsAsInt32Array())}function _c(i){var t,e;return e=$t(),wi(0),(t=Ia(i,e,8))?(wi(1),e[1]=256*e[1],e[3]=256*e[3],e[5]=256*e[5],e[7]=256*e[7],t):!1}function Ms(k,e,v,d,p,h,f){var t,m,a,u,s,n,c,o;return d!==p||0!==h&&0!==f?(t=6*k,v?(a=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[t+0],n=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[t+1],u=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[t+2],c=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[t+3],s=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[t+4],o=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[t+5]):(a=0|e[t+0],n=0|e[t+1],u=0|e[t+2],c=0|e[t+3],s=0|e[t+4],o=0|e[t+5]),a===u&&n===c||u===s&&c===o?a===s&&n===o?null:(i()[0]=a,i()[1]=n,l()[0]=s,l()[1]=o,ae(2),ce(h,i(),l(),f,d,p)):(i()[0]=a,i()[1]=n,l()[0]=u,l()[1]=c,S()[0]=s,S()[1]=o,ae(3),m=ci(i(),l(),S(),0!==h&&0!==f),r?null:void ui(h,f,d,p,m))):null}function Dc(S,v,b,g,k,m,d,y){var l,f,u,t,p,o,n,c,s,e,h,a,i;if(0===v)return 0;for(u=s=a=o=-1,f=c=h=p=1,t=e=i=n=0,l=1;v>=l;l++){if(--f<=0&&(++u,f=We(u,b),t=It(u,b),0!==t&&(t=d[t-1],t=q(t),r)))return null;if(--c<=0&&(++s,c=We(s,g),e=It(s,g),0!==e&&(e=d[e-1],e=q(e))),--h<=0&&(++a,h=We(a,k),i=It(a,k),0!==i&&(i=ct(i))),--p<=0&&(++o,p=We(o,m),n=It(o,m),0!==n&&(n=d[n-1])),Ms(l-1,S,y,t,e,i,n),r)return null}}function la(i){var t;return t=_o(),p(i)<cr?null:(G(t,e.fetchIntegerofObject(gn,i)),ht(t,e.fetchIntegerofObject(bn,i)),
ti(t,e.fetchIntegerofObject(yn,i)),H(t,e.fetchIntegerofObject(kn,i)),t)}function zc(r){var i,t;return Vi(0),t=nr(),i=Ia(r,t,6),e.failed()?null:i?(Vi(1),t[2]=t[2]+mr(),t[5]=t[5]+hr(),!0):!1}function ha(r,e,t,i,m,d){var a,o,l,c,f,s,h,p,n,u;t[0]=t[0]+e[0],t[1]=t[1]+e[1],i[0]=i[0]+e[0],i[1]=i[1]+e[1],Pe(e),Pe(t),Pe(i),a=t[0]-e[0],o=t[1]-e[1],n=i[0]-e[0],u=i[1]-e[1],l=a*a+o*o,l>0?(c=a*m*65536/l|0,f=o*m*65536/l|0):(c=0,f=0),s=n*n+u*u,s>0?(h=n*d*65536/s|0,p=u*d*65536/s|0):(h=0,p=0),Wf(r,e[0]),jf(r,e[1]),ic(r,c),tc(r,f),Uo(r,h),xo(r,p)}function pa(o){var r,u,l,n,c,s,t,i,a;if(!e.isArray(o))return!1;for(Wt=o,i=0;i<=p(Wt)-1;i++){if(t=e.fetchPointerofObject(i,Wt),"number"==typeof t)return!1;if(!e.isPointers(t))return!1;if(p(t)<5)return!1;if(r=e.fetchPointerofObject(0,t),se(r)!==e.classBitmap())return!1;if(u=p(r),s=e.fetchIntegerofObject(1,t),n=e.fetchIntegerofObject(2,t),l=e.fetchIntegerofObject(3,t),e.failed())return!1;if(!(s>=0&&n>=0))return!1;if(a=Oe(32,l),c=Oe(s+(a-1),a),u!==c*n)return!1}return!0}function $c(i,s,a,o,u){var n,t;return se(i)!==e.classBitmap()?e.primitiveFail():(t=p(i),n=rc(i.wordsAsInt32Array(),t,u),r?null:(ha(n,s,a,o,t,t),n))}function ef(e,r,n,a,o,u){var t,i,s;r[1]<=n[1]?(t=r,i=n,s=1):(t=n,i=r,s=-1),G(e,t[0]),ht(e,t[1]-a),ti(e,kr()),ar(e,o),sr(e,u),hl(e,i[0]),Al(e,i[1]-a),vc(e,s)}function tf(t,n,f,h){var s,a,o,e,u,c;for(c=l()[0]-i()[0]>>1,o=l()[1]-i()[1]>>1,s=l()[0]+i()[0]>>1,a=l()[1]+i()[1]>>1,e=0;15>=e;e++){if(rf(e,c,o,s,a),ae(3),u=ci(i(),l(),S(),0!==t&&0!==n),r)return null;if(ui(t,n,f,h,u),r)return null}}function rf(e,a,f,n,s){var h,t,u,c,r,o;h=Rr()[2*e+0]*a+n|0,c=Lr()[2*e+0]*f+s|0,i()[0]=h,i()[1]=c,u=Rr()[2*e+2]*a+n|0,o=Lr()[2*e+2]*f+s|0,S()[0]=u,S()[1]=o,t=Rr()[2*e+1]*a+n|0,r=Lr()[2*e+1]*f+s|0,t=2*t-(h+u>>1),r=2*r-(c+o>>1),l()[0]=t,l()[1]=r}function I(i,r){var t;return se(r)!==e.classPoint()?e.primitiveFail():(t=e.fetchPointerofObject(0,r),"number"==typeof t||t.isFloat?("number"==typeof t?i[0]=t:i[0]=0|e.floatValueOf(t),t=e.fetchPointerofObject(1,r),"number"==typeof t||t.isFloat?void("number"==typeof t?i[1]=t:i[1]=0|e.floatValueOf(t)):e.primitiveFail()):e.primitiveFail())}function sf(e,c,p,h,f,u){var t,a,s,n,o;for(u?(a=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[0],n=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[1]):(a=0|e[0],n=0|e[1]),t=1;c-1>=t;t++){if(u?(s=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[2*t],o=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[2*t+1]):(s=0|e[2*t],o=0|e[2*t+1]),i()[0]=a,i()[1]=n,l()[0]=s,l()[1]=o,ae(2),ce(h,i(),l(),f,p,0),r)return null;a=s,n=o}}function df(e,t,r,n){ce(e,i(),l(),t,r,n),ce(e,l(),S(),t,r,n),ce(e,S(),wt(),t,r,n),ce(e,wt(),i(),t,r,n)}function Sa(){var r,t,n,i;return 2!==e.methodArgumentCount()?c:0!==(t=R(e.stackValue(2)))?t:(n=e.stackObjectValue(0),r=e.stackObjectValue(1),e.failed()?f:0!==(t=Bt(e.fetchPointerofObject(nt,o)))?t:ps(e.fetchPointerofObject(pn,o))?pa(e.fetchPointerofObject(dn,o))?p(r)<cr?gr:p(n)<Oi?ss:(i=_e(),i===it||i===rt||i===tt?yr:0):as:Qn)}function bf(t,i,n,s,a,o){var e;for(e=1;i>=e;e++)if(Ms(e-1,t,o,n,0,s,a),r)return null}function Bt(t){return se(t)!==e.classBitmap()?$n:(u=t.words,Zl(p(t)-1),0)}function Ia(t,r,i){return t.isNil?!1:"number"==typeof t?e.primitiveFail():p(t)!==i?e.primitiveFail():(e.isWords(t)?qf(t,r,i):wc(t,r,i),!0)}function ui(t,a,o,u,l){var e,i,s,n;for(0===t||0===a?(n=!1,s=0):(n=!0,s=Ce(t)),i=6*l;i>0;){if(e=n?$o():af(),r)return 0;jc(e,i,o,u,s),n&&(bo(e,a),ur(e,t),ko(e,t)),i-=6}ve()}function ce(t,s,a,n,o,u){var e,i;return 0===t||0===n?(e=ec(),i=0):(e=Qo(),i=Ce(t)),r?0:(ef(e,s,a,i,o,u),void(Ue(e)&&(jo(e,n),ni(e,t),wo(e,t))))}function qf(i,r,n){var e,t;for(t=i.wordsAsFloat32Array(),e=0;n-1>=e;e++)r[e]=t[e]}function si(i){return"number"==typeof i?Gu:e.isWords(i)?p(i)<Ga?Hu:(fn(i),Lf()!==za?zu:Qe()!==p(i)?Xu:ro()!==ft?Ju:(Z=x(t,ro()),B=x(Z,Bi()),b=x(B,K()),ft+Bi()+K()+W()>Qe()?ke:0)):Uu}function Lf(){return t[Ka]}function vo(e){return t[Ka]=e}function Fo(e){0===strcmp(e,Ft)&&(Tt=0,jt=0)}function Oo(t,i,r){var e;for(e=t;e>0&&A(b[e-1])>r;)b[e]=b[e-1],--e;b[e]=i}function X(e){return ft+O+K()+W()+e>$()?(Ie(Wl),!1):!0}function Pa(){return 0!==Po()}function Po(){return t[Ua]}function Ve(e){return t[Ua]=e}function s(e,t){return Z[e+t]}function a(e,t,i){return Z[e+t]=i}function ro(){return t[Ja]}function Wo(e){return t[Ja]=e}function Bi(){return t[Ha]}function oo(e){return t[Ha]=e}function Ro(e){return s(e,Sr)}function ii(e){return s(e,fs)}function ne(e,t){return a(e,fs,t)}function Go(e){return s(e,hs)}function pe(e,t){return a(e,hs,t)}function J(e){return s(e,Sr)&ml}function U(e,t){return a(e,Sr,t)}function Ce(e){return e>>1}function i(){return x(t,of)}function l(){return x(t,uf)}function S(){return x(t,lf)}function wt(){return x(t,cf)}function Di(){Y()>=K()&&0===W()&&v(Ye),y()>=Ri()&&v(Ye)}function iu(){var t;return 0!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=R(e.stackValue(0)))?e.primitiveFailFor(t):(v(Ye),void k(o))}function ru(){var t,i,n;return d&&(m=e.ioMicroMSecs()),1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(n=F(e.stackValue(1),it))?e.primitiveFailFor(n):(i=e.stackObjectValue(0),e.failed()?e.primitiveFailFor(f):(t=la(i))?X(1)?(fe(t)>0&&rn(t),r?e.primitiveFailFor(N):(v(le),k(o),e.pop(1),void(d&&(h(Br,1),h(Kr,e.ioMicroMSecs()-m))))):e.primitiveFailFor(ke):e.primitiveFailFor(gr))}function su(){var a,u,t,s,n,h,p;return 5!==e.methodArgumentCount()?e.primitiveFailFor(c):(n=e.positive32BitValueOf(e.stackValue(0)),t=e.positive32BitValueOf(e.stackValue(1)),p=e.stackObjectValue(2),a=e.stackObjectValue(3),h=e.stackObjectValue(4),e.failed()?e.primitiveFailFor(f):0!==(u=F(e.stackValue(5),w))?e.primitiveFailFor(u):L(t)&&L(n)?(I(i(),h),I(l(),p),I(S(),a),e.failed()?e.primitiveFailFor(f):(ae(3),s=ci(i(),l(),S(),!1),X(s*Ge),r||(t=q(t),n=q(n)),r||ui(0,0,t,n,s),r?(ve(),e.primitiveFailFor(N)):e.failed()?e.primitiveFailFor(ue):(k(o),void e.pop(5)))):e.primitiveFailFor(ie))}function au(){var h,s,u,i,t,n,a,l,d;if(5!==e.methodArgumentCount())return e.primitiveFailFor(c);if(i=e.positive32BitValueOf(e.stackValue(0)),t=e.stackIntegerValue(1),s=e.positive32BitValueOf(e.stackValue(2)),n=e.stackIntegerValue(3),a=e.stackObjectValue(4),e.failed())return e.primitiveFailFor(f);if(0!==(h=F(e.stackValue(5),w)))return e.primitiveFailFor(h);if(u=p(a),e.isWords(a)){if(l=!1,u!==3*n&&u!==6*n)return e.primitiveFailFor(f)}else{if(!e.isArray(a))return e.primitiveFailFor(f);if(u!==3*n)return e.primitiveFailFor(f);l=!0}return d=0===t||0===i?Ae:st,X(d*n)?L(i)&&L(s)?(i=q(i),s=q(s),r?e.primitiveFailFor(N):0!==i&&0!==t||0!==s?(0!==t&&(t=ct(t),1>t&&(t=1)),l?Ac(a,n,s,t,i):bf(a.wordsAsInt32Array(),n,s,t,i,3*n===u),r?e.primitiveFailFor(N):e.failed()?e.primitiveFailFor(ue):(Ve(1),k(o),void e.pop(5))):e.pop(5)):e.primitiveFailFor(ie):e.primitiveFailFor(ke)}function ou(){var n,s,a,u,h,p,d,m,t;return 7!==e.methodArgumentCount()?e.primitiveFailFor(c):(t=e.stackIntegerValue(0),0>=t?e.primitiveFailFor(f):(p=e.stackObjectValue(1),s=e.stackObjectValue(2),d=e.stackObjectValue(3),m=e.booleanValueOf(e.stackValue(4)),n=e.stackObjectValue(5),h=e.stackObjectValue(6),e.failed()?e.primitiveFailFor(f):0!==(a=F(e.stackValue(7),w))?e.primitiveFailFor(a):(I(i(),d),I(l(),s),I(S(),p),e.failed()?e.primitiveFailFor(St):(u=Mc(h,n,m?1:0,i(),l(),S(),t-1),r?e.primitiveFailFor(N):e.failed()?e.primitiveFailFor(ue):(k(o),void e.popthenPush(8,e.positive32BitIntegerFor(u)))))))}function uu(){var h,n,s,a,u,t,i,d,l;return 7!==e.methodArgumentCount()?e.primitiveFailFor(c):(n=e.stackObjectValue(0),a=e.stackObjectValue(1),u=e.stackObjectValue(2),l=e.stackObjectValue(3),s=e.stackObjectValue(4),t=e.stackIntegerValue(5),i=e.stackObjectValue(6),e.failed()?e.primitiveFailFor(f):0!==(h=F(e.stackValue(7),w))?e.primitiveFailFor(h):If(i,t,s,l,u,a,n)?X(Math.max(Ge,Ae)*t)?(d=p(i)===3*t,Dc(i.wordsAsInt32Array(),t,s.wordsAsInt32Array(),l.wordsAsInt32Array(),u.wordsAsInt32Array(),a.wordsAsInt32Array(),n.wordsAsInt32Array(),d),r?e.primitiveFailFor(N):e.failed()?e.primitiveFailFor(ue):(Ve(1),k(o),void e.pop(7))):e.primitiveFailFor(ke):e.primitiveFailFor(Tu))}function cu(){var t,n,s,a,u,h,p;return 5!==e.methodArgumentCount()?e.primitiveFailFor(c):(a=e.booleanValueOf(e.stackValue(0)),u=e.stackValue(1),t=e.stackValue(2),h=e.stackValue(3),p=e.stackValue(4),e.failed()?e.primitiveFailFor(f):0!==(n=F(e.stackValue(5),w))?e.primitiveFailFor(n):(I(i(),h),I(l(),t),I(S(),u),e.failed()?e.primitiveFailFor(St):(s=$c(p,i(),l(),S(),a),r?e.primitiveFailFor(N):e.failed()?e.primitiveFailFor(ue):(k(o),void e.popthenPush(6,e.positive32BitIntegerFor(s))))))}function fu(){var s,a,t,n,u;return 4!==e.methodArgumentCount()?e.primitiveFailFor(c):(n=e.positive32BitValueOf(e.stackValue(0)),t=e.positive32BitValueOf(e.stackValue(1)),s=e.stackObjectValue(2),u=e.stackObjectValue(3),e.failed()?e.primitiveFailFor(f):0!==(a=F(e.stackValue(4),w))?e.primitiveFailFor(a):L(t)&&L(n)?(I(i(),u),I(l(),s),e.failed()?e.primitiveFailFor(St):(ae(2),t=q(t),n=q(n),r?e.primitiveFailFor(N):(ce(0,i(),l(),0,t,n),r?e.primitiveFailFor(N):e.failed()?e.primitiveFailFor(ue):(k(o),void e.pop(4))))):e.primitiveFailFor(ie))}function hu(){var t,n,a,u,s,h;return 5!==e.methodArgumentCount()?e.primitiveFailFor(c):(t=e.positive32BitValueOf(e.stackValue(0)),n=e.stackIntegerValue(1),s=e.positive32BitValueOf(e.stackValue(2)),a=e.stackObjectValue(3),h=e.stackObjectValue(4),e.failed()?e.primitiveFailFor(f):0!==(u=F(e.stackValue(5),w))?e.primitiveFailFor(u):L(t)&&L(s)?(s=q(s),t=q(t),r?e.primitiveFailFor(N):0===s&&(0===t||0>=n)?e.pop(5):X(16*Ge)?(n=n>0&&0!==t?ct(n):0,I(i(),h),I(l(),a),e.failed()?e.primitiveFailFor(St):(tf(n,t,0,s),r?(ve(),e.primitiveFailFor(N)):e.failed()?e.primitiveFailFor(ue):(Ve(1),k(o),void e.pop(5)))):e.primitiveFailFor(ke)):e.primitiveFailFor(ie))}function du(){var h,s,u,t,i,n,a,l,d;if(5!==e.methodArgumentCount())return e.primitiveFailFor(c);if(t=e.positive32BitValueOf(e.stackValue(0)),i=e.stackIntegerValue(1),s=e.positive32BitValueOf(e.stackValue(2)),n=e.stackIntegerValue(3),a=e.stackObjectValue(4),e.failed())return e.primitiveFailFor(f);if(0!==(h=F(e.stackValue(5),w)))return e.primitiveFailFor(h);if(u=p(a),e.isWords(a)){if(l=!1,u!==n&&2*n!==u)return e.primitiveFailFor(f)}else{if(!e.isArray(a))return e.primitiveFailFor(f);if(u!==n)return e.primitiveFailFor(f);l=!0}return d=0===i||0===t?Ae:st,X(d*n)?L(t)&&L(s)?(t=q(t),s=q(s),r?e.primitiveFailFor(N):0!==t&&0!==i||0!==s?(0!==i&&(i=ct(i)),l?Oc(a,n,s,i,t):sf(a.wordsAsInt32Array(),n,s,i,t,n===u),r?e.primitiveFailFor(N):e.failed()?e.primitiveFailFor(ue):(Ve(1),k(o),void e.pop(5))):e.pop(5)):e.primitiveFailFor(ie):e.primitiveFail()}function ku(){var t,n,a,u,s,h;return 5!==e.methodArgumentCount()?e.primitiveFailFor(c):(t=e.positive32BitValueOf(e.stackValue(0)),n=e.stackIntegerValue(1),s=e.positive32BitValueOf(e.stackValue(2)),a=e.stackObjectValue(3),h=e.stackObjectValue(4),e.failed()?e.primitiveFailFor(f):0!==(u=F(e.stackValue(5),w))?e.primitiveFailFor(u):L(t)&&L(s)?(t=q(t),s=q(s),r?e.primitiveFailFor(N):0!==s||0!==t&&0!==n?X(4*Ae)?(n=n>0&&0!==t?ct(n):0,I(i(),h),I(S(),a),e.failed()?e.primitiveFailFor(St):(l()[0]=S()[0],l()[1]=i()[1],wt()[0]=i()[0],wt()[1]=S()[1],ae(4),df(n,t,0,s),e.failed()?e.primitiveFailFor(ue):(Ve(1),k(o),void e.pop(5)))):e.primitiveFailFor(ke):e.pop(5)):e.primitiveFailFor(ie))}function gu(){var t,i,r;return d&&(m=e.ioMicroMSecs()),1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(r=F(e.stackValue(1),tt))?e.primitiveFailFor(r):(i=e.stackObjectValue(0),e.failed()?e.primitiveFailFor(f):(t=la(i))?(0===fe(t)?Dn():(Yn(),oe(C()+1)),v(Me),k(o),e.pop(1),void(d&&(h(Nr,1),h(zr,e.ioMicroMSecs()-m)))):e.primitiveFailFor(gr))}function bu(){var o,n,s,r,u,i,a,l;if(2!==e.methodArgumentCount())return e.primitiveFailFor(c);if(n=e.stackValue(0),o=e.stackValue(1),0!==(u=si(o)))return e.primitiveFailFor(u);if(se(o)!==se(n))return e.primitiveFailFor($n);if(s=p(n)-p(o),0>s)return e.primitiveFailFor(Ku);for(a=t,r=n.wordsAsInt32Array(),i=0,l=$()-1;l>=i;i++)r[i]=a[i];for(r[Mr]=$()+s,r[Er]=Qe()+s,a=x(a,$()),r=x(r,$()+s),i=0,l=Qe()-$()-1;l>=i;i++)r[i]=a[i];return 0!==(u=si(n))?e.primitiveFailFor(u):void e.pop(2)}function yu(){var t;return d&&(m=e.ioMicroMSecs()),0!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=F(e.stackValue(0),Ze))?e.primitiveFailFor(t):0!==(t=Bt(e.fetchPointerofObject(nt,o)))?e.primitiveFailFor(t):ps(e.fetchPointerofObject(pn,o))?((y()&me())===me()&&(lr(y()),Di()),Rt()||(oe(0),Je(y()+1),v(Me)),k(o),void(d&&(h(at,1),h(mt,e.ioMicroMSecs()-m)))):e.primitiveFailFor(Qn)}function Su(){var t,i;i=d,t=e.stackObjectValue(0),t=e.booleanValueOf(t),e.failed()||(d=t,e.pop(2),e.pushBool(i))}function Fu(){var t,i;return d&&(m=e.ioMicroMSecs()),0!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=R(e.stackValue(0)))?e.primitiveFailFor(t):(i=Rt(),k(o),e.pop(1),e.pushBool(i),void(d&&(h(Wr,1),h(Gr,e.ioMicroMSecs()-m))))}function Ou(){var t;return 0!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=R(e.stackValue(0)))?e.primitiveFailFor(t):(e.pop(1),void e.pushInteger(P()))}function Iu(){var n,r,i;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(n=R(e.stackValue(1)))?e.primitiveFailFor(n):(r=e.stackObjectValue(0),!e.failed()&&e.isWords(r)&&p(r)>=4?(i=r.wordsAsInt32Array(),i[0]=i[0]+t[Fi],i[1]=i[1]+t[jr],i[2]=i[2]+t[qr],i[3]=i[3]+t[ca],void e.pop(1)):e.primitiveFailFor(f))}function Pu(){var r,i,t;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(r=R(e.stackValue(1)))?e.primitiveFailFor(r):(t=e.stackObjectValue(0),!e.failed()&&e.isPointers(t)&&p(t)>=2?(e.pushRemappableOop(t),i=e.makePointwithxValueyValue(ze(),Ir()),e.storePointerofObjectwithValue(0,e.topRemappableOop(),i),i=e.makePointwithxValueyValue(Re(),Vr()),t=e.popRemappableOop(),e.storePointerofObjectwithValue(1,t,i),void e.popthenPush(2,t)):e.primitiveFailFor(f))}function Cu(){var n,r,i;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(n=R(e.stackValue(1)))?e.primitiveFailFor(n):(r=e.stackObjectValue(0),!e.failed()&&e.isWords(r)&&p(r)>=9?(i=r.wordsAsInt32Array(),i[0]=i[0]+t[Dr],i[1]=i[1]+t[Wr],i[2]=i[2]+t[lt],i[3]=i[3]+t[Br],i[4]=i[4]+t[ut],i[5]=i[5]+t[Tr],i[6]=i[6]+t[at],i[7]=i[7]+t[ot],i[8]=i[8]+t[Nr],void e.pop(1)):e.primitiveFailFor(f))}function wu(){var t;return 0!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=R(e.stackValue(0)))?e.primitiveFailFor(t):(e.pop(1),void e.pushInteger(kr()))}function Vu(){var t;return 0!==e.methodArgumentCount()?e.primitiveFailFor(c):(o=e.stackValue(0),"number"==typeof o?e.primitiveFailFor(ts):e.isPointers(o)?p(o)<hn?e.primitiveFailFor(ns):0!==(t=si(e.fetchPointerofObject(mn,o)))?e.primitiveFailFor(t):(e.pop(1),void e.pushInteger(Ui())):e.primitiveFailFor(is))}function xu(){var t,i;return 0!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=R(e.stackValue(0)))?e.primitiveFailFor(t):(i=e.makePointwithxValueyValue(mr(),hr()),void e.popthenPush(1,i))}function qu(){var n,r,i;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(n=R(e.stackValue(1)))?e.primitiveFailFor(n):(r=e.stackObjectValue(0),!e.failed()&&e.isWords(r)&&p(r)>=9?(i=r.wordsAsInt32Array(),i[0]=i[0]+t[Ur],i[1]=i[1]+t[Gr],i[2]=i[2]+t[Et],i[3]=i[3]+t[Kr],i[4]=i[4]+t[gt],i[5]=i[5]+t[Jr],i[6]=i[6]+t[mt],i[7]=i[7]+t[vt],i[8]=i[8]+t[zr],void e.pop(1)):e.primitiveFailFor(f))}function Mu(){var r,i;return 1!==e.methodArgumentCount()?e.primitiveFail():(i=e.stackObjectValue(0),e.failed()?null:e.isWords(i)?(r=p(i))<Ga?e.primitiveFail():(fn(i),Z=x(t,ft),vo(za),gf(r),hi(r),v(w),Wo(ft),oo(4),U(0,ks),pe(0,4),ne(0,0),yi(0),fr(0),oe(0),Kt(0),dt(0),Ve(0),Ar(0),xr(0),As(0),Es(0),Hn(0),Vl(),Ql(),Rl(),e.pop(2),void e.push(i)):e.primitiveFail())}function Bu(){var t;return d&&(m=e.ioMicroMSecs()),0!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=F(e.stackValue(0),w))?e.primitiveFailFor(t):0!==(t=Bt(e.fetchPointerofObject(nt,o)))?e.primitiveFailFor(t):(lo(),r?e.primitiveFailFor(N):(v(le),e.failed()||k(o),void(d&&(h(Dr,1),h(Ur,e.ioMicroMSecs()-m)))))}function Nu(){var r,n,i,t;return d&&(m=e.ioMicroMSecs()),2!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(n=F(e.stackValue(2),rt))?e.primitiveFailFor(n):0!==(n=Bt(e.fetchPointerofObject(nt,o)))?e.primitiveFailFor(n):(i=e.stackObjectValue(0),r=e.stackObjectValue(1),e.failed()||se(r)!==e.classBitmap()?e.primitiveFailFor(f):p(i)<Oi?e.primitiveFailFor(ss):(t=e.fetchIntegerofObject(Fn,i),ii(Dt())!==t?e.primitiveFailFor(ie):(t=e.fetchIntegerofObject(In,i),xe()!==t?e.primitiveFailFor(ie):(t=e.fetchIntegerofObject(On,i),Ne()!==t?e.primitiveFailFor(ie):p(r)<Ne()-xe()?e.primitiveFailFor(f):e.failed()?null:(fc(r.wordsAsInt32Array(),xe(),Ne()),v(Be),k(o),e.pop(2),void(d&&(h(Tr,1),h(Jr,e.ioMicroMSecs()-m))))))))}function _u(){var t,i;return 0!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=R(e.stackValue(0)))?e.primitiveFailFor(t):(i=Pa(),k(o),e.pop(1),void e.pushBool(i))}function Wu(){var t,i;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=R(e.stackValue(1)))?e.primitiveFailFor(t):(i=e.booleanValueOf(e.stackValue(0)),e.failed()?e.primitiveFailFor(f):(Ve(i===!0?1:0),k(o),void e.pop(1)))}function Du(){var i,r,n,t;return d&&(m=e.ioMicroMSecs()),1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(n=Ol(e.stackValue(1),Me,Ye))?e.primitiveFailFor(n):(r=e.stackObjectValue(0),e.failed()?e.primitiveFailFor(f):(t=!1,_e()!==Ye&&(t=Ai(),t?(i=b[C()],ei(i,r),v(tt)):v(le)),e.failed()?null:(k(o),e.pop(2),e.pushBool(!t),void(d&&(h(ot,1),h(vt,e.ioMicroMSecs()-m))))))}function Ru(){var t,n,i;return d&&(m=e.ioMicroMSecs()),1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=F(e.stackValue(1),Be))?e.primitiveFailFor(t):0!==(t=Bt(e.fetchPointerofObject(nt,o)))?e.primitiveFailFor(t):pa(e.fetchPointerofObject(dn,o))?(0!==_r()&&(0===(y()&me())&&pi(),Le(0)),n=e.stackObjectValue(0),i=Ci(),r?e.primitiveFailFor(N):(i&&ba(n),e.failed()?e.primitiveFailFor(ie):(i?v(rt):(ve(),Ot(0),v(Ze)),k(o),e.pop(2),e.pushBool(!i),void(d&&(h(ut,1),h(gt,e.ioMicroMSecs()-m)))))):e.primitiveFailFor(as)}function Eu(){var i,r,n,t;return d&&(m=e.ioMicroMSecs()),1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(n=F(e.stackValue(1),le))?e.primitiveFailFor(n):(r=e.stackObjectValue(0),t=ji(),t&&(i=B[Y()],ei(i,r),yi(Y()+1)),e.failed()?e.primitiveFailFor(Zu):(t?v(it):(v(Be),Le(1),oe(0),ve()),k(o),e.pop(2),e.pushBool(!t),void(d&&(h(lt,1),h(Et,e.ioMicroMSecs()-m)))))}function $u(){var t,s,a,u,l,h,i,n;return 6!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(s=F(e.stackValue(6),w))?e.primitiveFailFor(s):(n=e.positive32BitValueOf(e.stackValue(0)),i=e.positive32BitValueOf(e.stackValue(1)),h=e.stackIntegerValue(2),l=e.stackIntegerValue(3),u=e.stackIntegerValue(4),a=e.stackIntegerValue(5),e.failed()?e.primitiveFailFor(f):be(Ht)?L(i)&&L(n)?(t=O,O=t+Ht,U(t,Fr),pe(t,Ht),ne(t,a),G(t,u),ht(t,l),ti(t,h),ar(t,q(i)),sr(t,q(n)),r?e.primitiveFailFor(N):void(e.failed()||(k(o),e.pop(6)))):e.primitiveFailFor(ie):e.primitiveFailFor(ke))}function el(){var i,t,r;if(1!==e.methodArgumentCount())return e.primitiveFailFor(c);if(0!==(i=F(e.stackValue(1),w)))return e.primitiveFailFor(i);if(r=e.stackIntegerValue(0),e.failed())return e.primitiveFailFor(f);for(t=0;0===t;){if(!be(Ht))return e.primitiveFailFor(ke);t=O,O=t+Xn,U(t,ks),pe(t,Xn),ne(t,r)}e.failed()||(k(o),e.pop(2),e.pushInteger(t))}function tl(){var t;return 0!==(t=Sa())?e.primitiveFailFor(t):(Sn(),r?Xi():(fl(),void Xi()))}function il(){var t;return 0!==(t=Sa())?e.primitiveFailFor(t):(Sn(),void Xi())}function rl(){var t,i;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=F(e.stackValue(1),w))?e.primitiveFailFor(t):(i=e.stackIntegerValue(0),e.failed()?e.primitiveFailFor(f):(Zn(i),k(o),void e.pop(1)))}function nl(){var r,i,t,s;if(t=e.stackValue(0),!e.isBytes(t))return e.primitiveFail();if(r=Gf(t),r>=256)return e.primitiveFail();s=t.bytes,i=!1;var n=t.bytesAsString();return n!==Ft&&(Ft=n,i=!0),i&&!ki()?e.primitiveFail():void e.pop(1)}function sl(){var r,t;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(r=F(e.stackValue(1),w))?e.primitiveFailFor(r):(t=e.stackObjectValue(0),!e.failed()&&e.isPointers(t)&&p(t)>=2?(I(i(),e.fetchPointerofObject(0,t)),I(l(),e.fetchPointerofObject(1,t)),e.failed()?e.primitiveFailFor(f):(Ar(i()[0]),As(i()[1]),xr(l()[0]),Es(l()[1]),k(o),void e.pop(1))):e.primitiveFailFor(f))}function al(){var t,i;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=F(e.stackValue(1),w))?e.primitiveFailFor(t):(i=e.stackObjectValue(0),e.failed()?e.primitiveFailFor(f):(_c(i),e.failed()?e.primitiveFailFor(ue):(k(o),void e.pop(1))))}function ul(){var t,i;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(i=F(e.stackValue(1),w))?e.primitiveFailFor(i):(t=e.stackIntegerValue(0),e.failed()?e.primitiveFailFor(f):(Hn(t),k(o),void e.pop(1)))}function ll(){var t,i;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(t=F(e.stackValue(1),w))?e.primitiveFailFor(t):(i=e.stackObjectValue(0),e.failed()?e.primitiveFailFor(f):(zc(i),e.failed()?e.primitiveFailFor(f):(k(o),void e.pop(1))))}function cl(){var r,t;return 1!==e.methodArgumentCount()?e.primitiveFailFor(c):0!==(r=F(e.stackValue(1),w))?e.primitiveFailFor(r):(t=e.stackValue(0),se(t)!==e.classPoint()?e.primitiveFailFor(f):(I(i(),t),e.failed()?e.primitiveFailFor(f):(pu(i()[0]),To(i()[1]),k(o),void e.pop(1))))}function fl(){for(var t;!Rt();){if(d&&(m=e.ioMicroMSecs()),t=ji(),d&&(h(lt,1),h(Et,e.ioMicroMSecs()-m)),r)return v(le);if(t)return v(it),Ie(wr);if(oe(0),ve(),Le(1),d&&(m=e.ioMicroMSecs()),0!==_r()&&0===(y()&me())&&pi(),Le(0),t=Ci(),d&&(h(ut,1),h(gt,e.ioMicroMSecs()-m)),r)return v(Be);if(t)return v(rt),Ie(Cr);if(ve(),Ot(0),d&&(m=e.ioMicroMSecs()),(y()&me())===me()&&(lr(y()),Di()),d&&(h(at,1),h(mt,e.ioMicroMSecs()-m)),r)return v(Ze);if(Rt())return 0;if(oe(0),Je(y()+1),d&&(m=e.ioMicroMSecs()),t=Ai(),d&&(h(ot,1),h(vt,e.ioMicroMSecs()-m)),r)return v(Me);if(t)return v(tt),Ie(Pr)}}function Sn(){var i,t;if(t=_e(),t===w){if(lo(),r)return 0;t=le}if(t===le){if(d&&(m=e.ioMicroMSecs()),i=ji(),d&&(h(lt,1),h(Et,e.ioMicroMSecs()-m)),r)return v(le);if(i)return v(it),Ie(wr);oe(0),ve(),Le(1),t=Be}if(t===Be){if(d&&(m=e.ioMicroMSecs()),0!==_r()&&0===(y()&me())&&pi(),Le(0),i=Ci(),d&&(h(ut,1),h(gt,e.ioMicroMSecs()-m)),r)return v(Be);if(i)return v(rt),Ie(Cr);t=Ze,ve(),Ot(0)}if(t===Ze){if(d&&(m=e.ioMicroMSecs()),(y()&me())===me()&&(lr(y()),Di()),d&&(h(at,1),h(mt,e.ioMicroMSecs()-m)),r)return v(Ze);if(Rt())return 0;t=Me,oe(0),Je(y()+1)}if(t===Me){if(d&&(m=e.ioMicroMSecs()),i=Ai(),d&&(h(ot,1),h(vt,e.ioMicroMSecs()-m)),r)return v(Me);if(i)return v(tt),Ie(Pr);v(le)}}function R(t){var i;return e.failed()?ju:"number"==typeof t?ts:e.isPointers(t)?p(t)<hn?ns:(o=t,0!==(i=si(e.fetchPointerofObject(mn,t)))?i:(dt(0),O=Bi(),r=!1,0)):is}function F(t,i){var e;return 0!==(e=R(t))?e:_e()===i?0:(dt(qs),yr)}function Ol(t,i,r){var e;return 0!==(e=R(t))?e:_e()===i?0:_e()===r?0:(dt(qs),yr)}function Xt(e){if(0===V())return null;for(;rr()<=e;)if(os(Zt(),Yc()),0===V())return null}function Ti(e,n,r){var f,t,c,o,l,u,s,a,h,i,p;if((h=r+1-n)<=1)return 0;if(c=e[n],l=e[r],t=et(c,l),t||(i=e[n],e[n]=e[r],e[r]=i,p=c,c=l,l=p),2>=h)return 0;if(u=n+r>>1,o=e[u],t=et(c,o),t?(t=et(o,l),t||(i=e[r],e[r]=e[u],e[u]=i,o=l)):(i=e[n],e[n]=e[u],e[u]=i,o=c),3>=h)return 0;for(s=n,a=r,f=!0;f;){for(t=!0;t;)s<=--a?(i=e[a],t=et(o,i)):t=!1;for(t=!0;t;)++s<=a?(i=e[s],t=et(i,o)):t=!1;f=a>=s,f&&(i=e[s],e[s]=e[a],e[a]=i)}Ti(e,n,a),Ti(e,s,r)}function Pl(){var e=[0,5,4,0,3,0,0,0,2,0,0,0,0,0,0,0,1];return e}function Dn(){var e;for(e=C(),Kt(W()-1);e<W();)b[e]=b[e+1],++e}function ye(i,t){var e;for(e=i;0>e;)e+=t;for(;e>=t;)e-=t;return e}function Vl(){t[Ur]=0,t[Gr]=0,t[Et]=0,t[Kr]=0,t[gt]=0,t[Jr]=0,t[mt]=0,t[vt]=0,t[zr]=0,t[Dr]=0,t[Wr]=0,t[lt]=0,t[Br]=0,t[ut]=0,t[Tr]=0,t[at]=0,t[ot]=0,t[Nr]=0,t[Fi]=0,t[jr]=0,t[qr]=0,t[ca]=0}function Yn(){var e,i,t;return 0===C()?null:(e=b[C()],t=A(e),i=b[C()-1],A(i)<=t?null:void Oo(C(),e,t))}function xl(){return De=go(Mt)}function ql(){return De=So(Mt)}function Ml(){return De=Vo(Mt)}function Bl(){return De=ln(Mt)}function Zn(t){var e;t>=4&&(e=4),t>=2&&4>t&&(e=2),2>t&&(e=1),Vf(e),1===e&&(Or(0),Qr(4294967295),Hr(0)),2===e&&(Or(1),Qr(4244438268),Hr(1)),4===e&&(Or(2),Qr(4042322160),Hr(3)),Df(2*g()),Nf(g())}function Dl(i){var t;return e=i,t=e.majorVersion()==Bo,t===!1?!1:t=e.minorVersion()>=No}function We(e,t){return(0|t[e])>>>16}function It(e,t){return 65535&(0|t[e])}function rs(e,t,i){return An()?(kt(0,e),yt(0,t),Xe(0,i),V()===_()?null:void(vn(0,V()-_())&&(kt(0,tr()),yt(0,Zi()),Xe(0,$i()),ir(e),Qi(t),er(i)))):null}function El(){var e=[0,1,1,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6];return e}function Kl(){Ti(B,0,K()-1)}function Jt(){return t[Za]}function Ot(e){return t[Za]=e}function Gt(){return t[Ya]}function zt(e){return t[Ya]=e}function Se(){return t[Qa]}function Zl(e){return t[Qa]=e}function Ei(){return t[$a]}function Ki(e){return t[$a]=e}function j(e,t){return e*e+t*t}function Ee(e){return de(e+1)}function yt(e,t){return he(e+1,t)}function _(){return 3}function di(e){return de(e+2)}function Xe(e,t){return he(e+2,t)}function V(){return E()}function Ke(e){return de(e)}function kt(e,t){return he(e,t)}function _e(){return t[eo]}function v(e){return t[eo]=e}function pc(){return Os(B[Y()],y())}function Os(e,n){var r,b,f,h,p,d,u,g,y,k,v,a,o,m,s,i,t,c,l;return!Ue(e)&&n>=Mi(e)?H(e,0):(s=A(e),i=Q(e),c=Of(e),l=Lo(e),b=_i(e),f=Mi(e),r=f-i,g=2*(c-s),y=s+b-2*c,k=2*(l-i),v=i+f-2*l,a=2*r,2>a&&(a=2),o=Oe(16777216,a),m=Qu(o),d=g*o,h=y*m*2,d+=h>>1,u=k*o,p=v*m*2,u+=p>>1,H(e,r),t=z(e),t[T]=256*s,t[qe]=256*i,t[Yt]=d,t[dr]=u,t[pr]=h,t[Wn]=p,void((i=Q(e))!==n&&(xs(e,n),H(e,r-(n-i)))))}function mc(){return Ps(B[Y()],y())}function Ps(e,s){var r,t,n,l,a,c,i,o,u;if(!Ue(e)&&s>=xi(e))return H(e,0);if(r=_n(e)-A(e),t=xi(e)-Q(e),r>=0?(o=1,i=r,n=0):(o=-1,i=0-r,n=1-t),0===t?(n=0,u=r,l=0):t>i?(u=0,l=i):(u=Oe(i,t)*o,l=Kf(i,t)),H(e,t),$l(e,o),dc(e,u),es(e,n),Nl(e,l),wl(e,t),(c=Q(e))!==s){for(a=c;s-1>=a;a++)Gi(e,a);H(e,t-(s-c))}}function kc(){return gc(B[Y()],y())}function gc(e,u){var o,t,r,i,a,n,s,l,c;for(i=or(e),r=Ce(i),o=_i(e),n=Q(e),Os(e,n),a=fe(e),t=0;5>=t;t++)ee(e)[t]=z(e)[t];if(s=z(e)[Yt],0===s&&z(e)[pr],s=s>=0?1:-1,0>s?vu(e,i,r,o):yo(e,i,r,o),0===a&&(z(e)[T]=256*Aa(e)),H(e,a+i),l=0,c=0-a-r,en(e,l),tn(e,c),l>=r&&0>c?li(e):oi(e),ys(e,i),n!==u){for(t=n;u-1>=t;t++)Bs(e,t);H(e,fe(e)-(u-n))}}function bc(){return yc(B[Y()],y())}function yc(e,s){var r,n,t,u,c,i,l,a,o;if(t=fi(e),n=Ce(t),c=A(e),i=Q(e),Ps(e,i),u=fe(e),l=qi(e),G(e,c-n),H(e,u+t),l>0?ni(e,He(e)+t):(ni(e,t-He(e)),G(e,A(e)+He(e))),a=0,o=0-u-n,an(e,a),un(e,o),a>=n&&0>o?li(e):oi(e),i!==s){for(r=i;s-1>=r;r++)Qs(e,r);H(e,fe(e)-(s-i))}}function Sc(){return xs(b[C()],y())}function zi(e,a){var i,t,r,n,s;for(r=e[T],n=e[qe],i=e[Yt],t=e[dr],s=256*a;s>n&&t>=0;)r+=i+32768>>16,n+=t+32768>>16,i+=e[pr],t+=e[Wn];return e[T]=r,e[qe]=n,e[Yt]=i,e[dr]=t,r>>8}function xs(e,i){var t;t=zi(z(e),i),G(e,t)}function Ic(){return Gi(b[C()],y())}function Gi(e,r){var t,i;i=A(e)+He(e),t=Ll(e)+jl(e),t>0&&(i+=qi(e),t-=Cl(e)),es(e,t),G(e,i)}function Cc(){Bs(b[C()],y())}function Bs(e,s){var i,r,n,t;r=or(e),i=Ce(r),n=Bf(e)+1,t=Tf(e)+1,en(e,n),tn(e,t),n>=i&&li(e),t>=0&&oi(e),0>t+i?zi(z(e),s):z(e)[T]=256*Aa(e),zi(ee(e),s),ys(e,r)}function Vc(){return Qs(b[C()],y())}function Qs(e,o){var s,r,n,a,t,i;t=sn(e)+1,i=on(e)+1,an(e,t),un(e,i),n=fi(e),r=Ce(n),t>=r&&li(e),i>=0&&oi(e),s=A(e),Gi(e,o),a=A(e),(n>=t||i+r>=0)&&xf(e,s,a)}function Ie(e){dt(e),r=!0}function Ui(){return t[to]}function dt(e){return t[to]=e}function ei(i,t){return p(t)<cr?e.primitiveFail():(e.storeIntegerofObjectwithValue(Eo,t,ii(i)),e.storeIntegerofObjectwithValue(gn,t,A(i)),e.storeIntegerofObjectwithValue(bn,t,y()),e.storeIntegerofObjectwithValue(yn,t,Ji(i)),e.storeIntegerofObjectwithValue(kn,t,fe(i)),void Do(i))}function k(e){oo(O)}function ba(t){var i,r,n;return i=Dt(),r=xe(),n=Ne(),p(t)<Oi?e.primitiveFail():(e.storeIntegerofObjectwithValue(Fn,t,ii(i)),e.storeIntegerofObjectwithValue(In,t,r),e.storeIntegerofObjectwithValue(On,t,n),void e.storeIntegerofObjectwithValue(Zo,t,y()))}function Xi(){return e.failed()?null:(r&&Tc(e.stackObjectValue(1),e.stackObjectValue(0)),k(o),e.pop(3),void e.pushInteger(Ui()))}function Tc(i,r){var e,t;t=Ui(),t===wr&&(e=B[Y()],ei(e,i),yi(Y()+1)),t===Cr&&ba(r),t===Pr&&(e=b[C()],ei(e,i))}function Rc(e){var i,t,s,r,a,n;return n=we(e),r=je(e),r===n?e:(t=r-n,0>t&&(t=0-t),t>255?(h(jr,1),Ss(e)):(a=$e(e),s=Te(e),i=s-a,0>i&&(i=0-i),i>32*t?(h(qr,1),Ss(e)):e))}function Yi(e){var t,i,n;return n=Rc(e),n!==e?(t=Yi(e),r?0:(i=Yi(n),r?0:t>=i?t:i)):e}function Kc(i,n){var r,e,t;return r=e=t=Gc(i),n&&(e=Fa(i)),e>t&&(t=e),i!==r&&n&&(e=Fa(r)),e>t&&(t=e),t}function Fa(e){var t,r,n,a,i,o,s;return o=$e(e),s=Vt(e),a=Te(e),r=s-o,n=a-s,r*n>=0?e:(h(Fi,1),t=n-r,i=r,0>i&&(i=0-i),0>t&&(t=0-t),Fs(e,i/t))}function Gc(e){var t,r,n,a,i,o,s;return o=we(e),s=Pt(e),a=je(e),r=s-o,n=a-s,r*n>=0?e:(h(Fi,1),t=n-r,i=r,0>i&&(i=0-i),0>t&&(t=0-t),Fs(e,i/t))}function Oa(e,t,i){var r;0===V()?An()&&(ir(e),Qi(t),er(i)):(r=os(e,t),r||rs(e,t,i))}function Jc(t){var i,e;return X(2*_())?(i=Ji(t)<<1,e=Co(t),0!==e&&Oa(e,i,999999999),e=mo(t),0!==e&&Oa(e,i,999999999),void Xt(A(t))):null}function Hc(e){var n,t,i,a,r,s;switch(s=kf(e),Mt=e,s){case 0:case 1:pt();break;case 2:Bl();break;case 3:ql()}switch(a=De,s){case 0:case 1:pt();break;case 2:Ml();break;case 3:xl()}return t=De,0===t?null:X(_())?(n=(Ji(e)<<1)+1,r=A(e)+a,i=Tn(t,n),-1===i?rs(t,n,r):di(i)<r&&Xe(i,r),void Xt(A(e))):null}function Yc(){return 0===V()?-1:Zi()}function Zt(){return 0===V()?0:tr()}function Zi(){return Ee(V()-_())}function Qi(e){return yt(V()-_(),e)}function $i(){return di(V()-_())}function er(e){return Xe(V()-_(),e)}function tr(){return Ke(V()-_())}function ir(e){return kt(V()-_(),e)}function rr(){return 0===V()?999999999:$i()}function q(s){var e,a,i,r,n,t;return 0===s||vi(s)?(i=255&s,r=s>>>8&255,n=s>>>16&255,e=s>>>24&255,gi()&&(t=$t(),a=(e*t[6]+t[7])/e,n=(n*t[0]+t[1])*a|0,r=(r*t[2]+t[3])*a|0,i=(i*t[4]+t[5])*a|0,e=e*a|0,n=Math.max(n,0),n=Math.min(n,255),r=Math.max(r,0),r=Math.min(r,255),i=Math.max(i,0),i=Math.min(i,255),e=Math.max(e,0),e=Math.min(e,255)),1>e?0:(255>e&&Pa()&&Ie(_l),i+(r<<8)+(n<<16)+(e<<24))):s}function Pe(e){Bc()?hf(e,e):(e[0]=(e[0]+mr())*P(),e[1]=(e[1]+hr())*P())}function hf(e,t){pf(0|e[0],0|e[1],t)}function pf(t,i,r){var e,n,s;e=nr(),n=(e[0]*t+e[1]*i+e[2])*P()|0,s=(e[3]*t+e[4]*i+e[5])*P()|0,r[0]=n,r[1]=s}function ae(e){e>0&&Pe(i()),e>1&&Pe(l()),e>2&&Pe(S()),e>3&&Pe(wt())}function ct(n){var e,t,r,s;return 0===n?0:(i()[0]=0,i()[1]=0,l()[0]=256*n,l()[1]=0,S()[0]=0,S()[1]=256*n,ae(3),e=l()[0]-i()[0],t=l()[1]-i()[1],r=(0|Math.sqrt(e*e+t*t))+128>>8,e=S()[0]-i()[0],t=S()[1]-i()[1],s=(0|Math.sqrt(e*e+t*t))+128>>8,r>s&&(r=s),0===r?1:r)}function ao(s){var e,i,r,n,t;return gi()?(i=255&s,r=s>>>8&255,n=s>>>16&255,e=s>>>24&255,t=$t(),n=n*t[0]+t[1]|0,r=r*t[2]+t[3]|0,i=i*t[4]+t[5]|0,e=e*t[6]+t[7]|0,n=Math.max(n,0),n=Math.min(n,255),r=Math.max(r,0),r=Math.min(r,255),i=Math.max(i,0),i=Math.min(i,255),e=Math.max(e,0),e=Math.min(e,255),16>e?0:i+(r<<8)+(n<<16)+(e<<24)):s}function Qe(){return t[Er]}function gf(e){return t[Er]=e}function ve(){hi(Qe())}function Sf(e){hi($()+e)}function uo(e){return Fl(e)?(hi($()-e),!0):!1}function E(){return Qe()-$()}function de(e){return t[$()+e]}function he(e,i){return t[$()+e]=i}function $(){return t[Mr]}function hi(e){return t[Mr]=e}function Bf(e){return s(e,En)}function en(e,t){return a(e,En,t)}function Tf(e){return s(e,Kn)}function tn(e,t){return a(e,Kn,t)}function or(e){return s(e,zn)}function ko(e,t){return a(e,zn,t)}function go(e){return s(e,Gn)}function bo(e,t){return a(e,Gn,t)}function ee(e){return x(Z,e+Au)}function So(e){return s(e,Jn)}function ur(e,t){return a(e,Jn,t)}function sn(e){return s(e,Hs)}function an(e,t){return a(e,Hs,t)}function on(e){return s(e,Xs)}function un(e,t){return a(e,Xs,t)}function fi(e){return s(e,Ys)}function wo(e,t){return a(e,Ys,t)}function Vo(e){return s(e,Zs)}function jo(e,t){return a(e,Zs,t)}function ln(e){return s(e,$s)}function ni(e,t){return a(e,$s,t)}function fn(e){t=e.wordsAsInt32Array()}var Bo=1,No=11,hn=12,pn=2,dn=3,nt=1,mn=0,cr=6,Eo=0,kn=4,gn=1,bn=2,yn=3,Oi=6,Fn=0,On=2,In=1,Zo=3,Ge=16,Pn=12,Cn=11,wn=14,Vn=13,jn=10,nu=18,xn=15,qn=14,Mn=15,Bn=21,lu=18,Nn=16,pr=4,Wn=5,Yt=2,dr=3,mu=10,T=0,qe=1,Ln=12,Rn=13,En=18,Kn=19,zn=20,Gn=16,Ii=28,Au=22,Jn=17,Ht=10,Xn=4,vr=65536,ju=100,St=121,Qn=122,$n=114,gr=112,ts=101,is=102,N=104,ns=103,Tu=120,ue=119,ss=113,as=123,Ku=115,zu=108,Gu=105,Uu=106,Ju=110,Hu=107,Xu=109,ke=111,Zu=118,ie=117,yr=116,us=8,ls=9,cs=7,fs=2,hs=1,Sr=0,ds=6,ol=1024,Fr=2,vs=255,ks=256,gs=65280,bs=4,pl=512,dl=768,ml=65535,vl=1,kl=7,gl=5,ri=254,le=1,Ze=5,Ye=8,Be=3,w=0,Me=6,tt=7,it=2,rt=4,ws=4,Vs=5,js=6,Pr=6,qs=2,Cr=5,wr=4,_l=3,Wl=1,Ns=6,_s=7,Ws=8,Ds=9,Ts=4,Ls=5,Rs=10,Gl=12,Ul=12,Ae=16,Ks=14,zs=15,Gs=13,Us=15,Js=14,Hs=18,Xs=19,Ys=20,Zs=16,st=21,$s=17,ea=10,ta=12,oc=11,ia=51,ra=50,cc=53,na=48,sa=52,aa=49,oa=13,ua=14,jr=109,ca=111,Fi=108,qr=110,Mr=10,da=69,ma=43,va=45,ka=42,ga=44,Pc=24,Br=97,Nr=107,at=103,Wr=93,Dr=91,Tr=101,ot=105,ut=99,lt=95,Ca=88,wa=113,Va=46,ja=47,Lc=18,xa=37,qa=39,Ma=36,Ba=38,Na=11,_a=12,Wa=17,Da=16,ft=128,Ta=65,La=66,Ra=67,Ea=68,Ka=0,za=1097753705,Ga=256,Ua=63,Ja=8,Ha=9,of=80,uf=82,lf=84,cf=86,Er=1,Ya=34,Za=35,Qa=33,$a=32,eo=2,to=64,Kr=96,zr=106,mt=102,Gr=92,Ur=90,Jr=100,vt=104,gt=98,Et=94,f=3,c=5,b=null,Ft="BitBltPlugin",jt=null,De=0,Mt=0,d=0,o=0,r=0,Wt=0,m=0,B=null,e=null,Tt=null,Ef="B2DPlugin 14 November 2014 (e)",Z=null,O=0,u=null,t=null;
Squeak.registerExternalModule("B2DPlugin",{primitiveMergeFillFrom:Nu,primitiveCopyBuffer:bu,primitiveAddRect:ku,primitiveAddGradientFill:cu,primitiveSetClipRect:sl,initialiseModule:ki,primitiveSetBitBltPlugin:nl,primitiveRegisterExternalEdge:$u,primitiveGetClipRect:Pu,primitiveAddBezier:su,primitiveInitializeProcessing:Bu,primitiveRenderImage:tl,primitiveGetOffset:xu,primitiveSetDepth:ul,primitiveAddBezierShape:au,primitiveSetEdgeTransform:ll,getModuleName:Mo,primitiveGetTimes:qu,primitiveNextActiveEdgeEntry:Du,primitiveAddBitmapFill:ou,primitiveGetDepth:wu,primitiveAbortProcessing:iu,primitiveNextGlobalEdgeEntry:Eu,primitiveGetFailureReason:Vu,primitiveDisplaySpanBuffer:yu,moduleUnloaded:Fo,primitiveGetCounts:Cu,primitiveChangedActiveEdgeEntry:gu,primitiveRenderScanline:il,primitiveGetBezierStats:Iu,primitiveFinishedProcessing:Fu,setInterpreter:Dl,primitiveNeedsFlush:_u,primitiveAddLine:fu,primitiveSetOffset:cl,primitiveNextFillEntry:Ru,primitiveInitializeBuffer:Mu,primitiveDoProfileStats:Su,primitiveAddActiveEdgeEntry:ru,primitiveSetAALevel:rl,primitiveNeedsFlushPut:Wu,primitiveAddCompressedShape:uu,primitiveSetColorTransform:al,primitiveAddOval:hu,primitiveRegisterExternalFill:el,primitiveAddPolygon:du,primitiveGetAALevel:Ou})}),module("users.bert.SqueakJS.plugins.BitBltPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function jt(t){return"number"==typeof t?e.classSmallInteger():t.sqClass}function L(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function rt(e){return e.bytes?e.bytes.length:e.words?4*e.words.length:0}function v(e,t){return 0|Math.floor(e/t)}function Cr(e,t){return e-v(e,t)*t|0}function i(t,e){return e>31?0:t<<e}function u(t,e){return e>31?0:t>>>e}function z(t,e){return 0>e?-31>e?0:t>>>0-e:e>31?0:t<<e}function Pr(r,i){var e,n;if(16>t){for(e=r^i,n=x[t];0!==e;)0!==(e&n)&&++Z,e=u(e,t);return i}return 16===t?(e=pe(r,i,5,3),Z=Z+(31&e)+(e>>>5&31)+(e>>>10&31),e=pe(r>>>16,i>>>16,5,3),Z=Z+(31&e)+(e>>>5&31)+(e>>>10&31)):(e=pe(r,i,8,3),Z=Z+(255&e)+(e>>>8&255)+(e>>>16&255)),i}function Ar(a,i){var s,e,n,r;if((w&(ee|ve))!==(ee|ve))return i;if(16>t){for(s=x[t]&ne,r=i,n=1;c>=n;n++)e=r&s,Le(e,Te(e)+1),r=u(r,t);return i}return 16===t?(e=de(65535&i,5,R),Le(e,Te(e)+1),e=de(i>>>16,5,R),Le(e,Te(e)+1)):(e=de(i,8,R),Le(e,Te(e)+1)),i}function Ir(e,t){return e+t}function Or(r,n){var s,t,i,a,e;return e=r>>>24,0===e?n:255===e?r:(s=255-e,t=(16711935&r)*e+(16711935&n)*s+16711935,i=(16711935&(r>>>8|16711680))*e+(n>>>8&16711935)*s+16711935,t=t+(t-65537>>>8&16711935)>>>8&16711935,i=i+(i-65537>>>8&16711935)>>>8&16711935,a=t|i<<8)}function Fr(e,t){return Vt(e,t,!1)}function Vt(l,a,A){var b,e,y,n,f,s,p,S,k,g,F,o,r,O,I,m,h;if(16>t)return a;if(g=255-be,s=a,1===c)A&&0===l||(o=(16711935&l)*be+(16711935&a)*g+16711935,r=(l>>>8&16711935)*be+(a>>>8&16711935)*g+16711935,o=o+(o-65537>>>8&16711935)>>>8&16711935,r=r+(r-65537>>>8&16711935)>>>8&16711935,s=o|r<<8);else for(e=x[t],O=5,b=31,h=d,m=a,f=l,n=1;c>=n;n++){if(S=f&e,!(0===(h&e)||A&&0===S)){for(F=m&e,y=0,k=1;3>=k;k++)p=(k-1)*O,I=v((u(S,p)&b)*be+(u(F,p)&b)*g+254,255)&b,y|=i(I,p);s=s&~i(e,16*(n-1))|i(y,16*(n-1))}h=u(h,t),f=u(f,t),m=u(m,t)}return s}function Ce(i,n){var r,e,t;return r=255-(i>>>24),e=((16711935&n)*r>>>8&16711935)+(16711935&i),t=((n>>>8&16711935)*r>>>8&16711935)+(i>>>8&16711935),e=16711935&e|255*(16777472&e)>>>8,t=(16711935&t)<<8|255*(16777472&t),t|e}function Sr(e,t){return 0===e?t:Vt(e,t,!0)}function yr(){var I,k,t,e,b,O,c,v,l,F,y,s,d,g;for(F=h+1,y=m,d=a,t=16*(1&r),q&&(t=16-t),S=i(65535,16-t);0!==--F;){for(b=y*C+4*p,c=d*B+4*(r>>1),I=4*(3&d),g=(3&p)-1,O=o+1,l=S,t=65535===l?16:0;0!==--O;)k=Dt[I+(g=g+1&3)],e=f[b>>>2],v=e>>>24,255===v?(e=ht(e,k),e=0===e?i(1,t):i(e,t),Be(c,e,l)):0!==v&&(s=n[c>>>2],s&=~l,s=u(s,t),s=(31744&s)<<9|(992&s)<<6|((31&s)<<3|4278190080),e=Ce(e,s),e=ht(e,k),e=0===e?i(1,t):i(e,t),Be(c,e,l)),b+=4,q?0===t&&(c+=4):0!==t&&(c+=4),t=16^t,l=~l;++y,++d}}function br(){var i,t,s,e,l,v,c,u,d;for(v=h+1,c=m,d=a;0!==--v;){for(t=c*C+4*p,e=d*B+4*r,s=o+1;0!==--s;)if(i=f[t>>>2],l=i>>>24,255===l){for(n[e>>>2]=i,t+=4,e+=4;0!==--s&&(i=f[t>>>2])>>>24===255;)n[e>>>2]=i,t+=4,e+=4;++s}else if(0===l){for(t+=4,e+=4;0!==--s&&(i=f[t>>>2])>>>24===0;)t+=4,e+=4;++s}else u=n[e>>>2],u=Ce(i,u),n[e>>>2]=u,t+=4,e+=4;++c,++d}}function gr(){var e,s,b,O,F,d,t,I,g,l,y,k,c,v;for(F=Pt(),I=w&~Ae,y=h+1,k=m,v=a,S=8*(3&r),q&&(S=24-S),E=P^i(255,S),t=0===(1&r)?0:522133279,0===(1&a)&&(t=522133279^t);0!==--y;){for(t=522133279^t,b=k*C+4*p,d=v*B+4*(r>>2),O=o+1,e=S,l=E;0!==--O;)s=(f[b>>>2]&~t)+t,g=s>>>24,g>31&&(224>g&&(c=n[d>>>2],c&=~l,c=u(c,e),c=F[c],s=Ce(s,c)),s=Ke(s,I),s=i(s,e),Be(d,s,l)),b+=4,q?0===e?(d+=4,e=24,l=16777215):(e-=8,l=l>>>8|4278190080):24===e?(d+=4,e=0,l=4294967040):(e+=8,l=l<<8|255),t=522133279^t;++k,++v}}function kr(e,t){return e&t}function vr(e,t){return e&~t}function mr(e,t){return~e&t}function dr(e,t){return~e&~t}function pr(t,e){return~e}function hr(e,t){return~e|t}function fr(e,t){return~e|~t}function cr(e,t){return~e}function lr(e,t){return~e^t}function ur(e,t){return e|t}function or(e,t){return e|~t}function ar(e,t){return e^t}function sr(){var e;W===K&&a>=m&&(a>m?(ke=-1,m=m+h-1,a=a+h-1):a===m&&r>p&&(G=-1,p=p+o-1,r=r+o-1,N>1&&(e=S,S=E,E=e)),l=a*B+4*v(r,c),Pe=B*ke-4*(N*G))}function nr(e,t){return 0}function bt(){return M>=_?(p=Se,r=M,o=H):(p=Se+(_-M),o=H-(_-M),r=_),r+o>_+we&&(o-=r+o-(_+we)),D>=j?(m=$e,a=D,h=Oe):(m=$e+j-D,h=Oe-(j-D),a=j),a+h>j+Ve&&(h-=a+h-(j+Ve)),T?null:(0>p&&(r-=p,o+=p,p=0),p+o>se&&(o-=p+o-se),0>m&&(a-=m,h+=m,m=0),void(m+h>le&&(h-=m+h-le)))}function xe(){return bt(),0>=o||0>=h?(y=O=F=A=0,null):xt()?(ir(),void It()):e.primitiveFail()}function rr(e,t,i){M=e,D=i,Se=e,H=t-e,xe(),Fe()}function ir(){var t;if(tr(),e.failed())return e.primitiveFail();if(t=si())return null;if(30===k||31===k){if(1!==e.methodArgumentCount())return e.primitiveFail();if(be=e.stackIntegerValue(0),!(!e.failed()&&be>=0&&255>=be))return e.primitiveFail()}Z=0,_i(),(22===k||32===k)&&(y=O=F=A=0),G>0?(y=r,O=r+o):(y=r-o+1,O=r+1),ke>0?(F=a,A=a+h):(F=a-h+1,A=a+1)}function tr(){var t,i;if(41===k)if(ot=255,Ze=16777215,he=null,J=null,e.methodArgumentCount()>=2){if(ot=e.stackIntegerValue(e.methodArgumentCount()-2),e.failed())return e.primitiveFail();if(Ze=e.stackIntegerValue(e.methodArgumentCount()-1),e.failed())return e.primitiveFail();4===e.methodArgumentCount()&&(i=e.stackObjectValue(1),e.isBytes(i)&&(he=i.bytes),t=e.stackObjectValue(0),e.isBytes(t)&&(J=t.bytes))}else{if(1!==e.methodArgumentCount())return e.primitiveFail();if(Ze=e.stackIntegerValue(0),e.failed())return e.primitiveFail()}}function er(){var b,g,p,m,v,F,e,c,r,o,O,A,t,y;for(F=s[k+1],e=4*G,-32===V?V=v=p=0:0>V?(v=V+32,p=i(P,0-V)):0===V?(v=0,p=P):(v=V-32,p=u(P,V)),y=~p,ge?(m=P,Ne=0):m=Me(0),O=a,A=1;h>=A;A++){if(Ne>1&&(m=Me(O),O+=ke),Je?(o=f[I>>>2],I+=e):o=0,d=S,t=f[I>>>2],I+=e,g=z(o&y,v)|z(t&p,V),o=t,c=n[l>>>2],b=F(g&m,c),c=d&b|c&~d,n[l>>>2]=c,l+=e,d=P,3===k)if(0===V&&m===P)if(-1===G)for(r=2;N-1>=r;r++)t=f[I>>>2],I+=e,n[l>>>2]=t,l+=e;else for(r=2;N-1>=r;r++)n[l>>>2]=o,l+=e,o=f[I>>>2],I+=e;else for(r=2;N-1>=r;r++)t=f[I>>>2],I+=e,g=z(o&y,v)|z(t&p,V),o=t,n[l>>>2]=g&m,l+=e;else for(r=2;N-1>=r;r++)t=f[I>>>2],I+=e,g=z(o&y,v)|z(t&p,V),o=t,b=F(g&m,n[l>>>2]),n[l>>>2]=b,l+=e;N>1&&(d=E,t=f[I>>>2],I+=e,g=z(o&y,v)|z(t&p,V),c=n[l>>>2],b=F(g&m,c),c=d&b|c&~d,n[l>>>2]=c,l+=e),I+=Ue,l+=Pe}}function $i(){var t,r,o,e,i,u;for(o=s[k+1],u=1;h>=u;u++){if(r=ge?P:Me(a+u-1),d=S,e=n[l>>>2],t=o(r,e),e=d&t|e&~d,n[l>>>2]=e,l+=4,d=P,3===k)for(e=r,i=2;N-1>=i;i++)n[l>>>2]=e,l+=4;else for(i=2;N-1>=i;i++)e=n[l>>>2],t=o(r,e),n[l>>>2]=t,l+=4;N>1&&(d=E,e=n[l>>>2],t=o(r,e),e=d&t|e&~d,n[l>>>2]=e,l+=4),l+=Pe}}function Wt(){var K,y,W,R,T,j,M,e,b,V,i,F,B,O,D,A,f,L,u,_;for(V=s[k+1],$=v(32,g),R=x[g],D=x[t],K=w&~Ae,I=m*C+4*v(p,$),_=$-(p&$-1),T=_>o?0:v(o-_,$)+1,Ue=C-4*T,b=c-(r&c-1),L=(r+o-1&c-1)+1,b>o&&(b=o),f=(p&$-1)*g,i=(r&c-1)*t,y=g,A=t,W=0,re&&(f=32-g-f,y=0-y),q&&(i=32-t-i,A=0-A,W=32-t),F=1;h>=F;F++){B=ge?P:Me(a+F-1),We=f,U=i,d=S,u=b,M=N;do j=Ni(u,K,R,D,y,A),U=W,d===P?(O=V(j&B,n[l>>>2]),n[l>>>2]=d&O):(e=n[l>>>2],O=V(j&B,e&d),e=d&O|e&~d,n[l>>>2]=e),l+=4,2===M?(d=E,u=L):(d=P,u=c);while(0!==--M);I+=Ue,l+=Pe}}function Pt(){var e=[0,4278190081,4294967295,4286611584,4294901760,4278255360,4278190335,4278255615,4294967040,4294902015,4280295456,4282400832,4284506208,4288651167,4290756543,4292861919,4278716424,4279242768,4279769112,4280821800,4281348144,4281874488,4282927176,4283453520,4283979864,4285032552,4285558896,4286085240,4287072135,4287598479,4288124823,4289177511,4289703855,4290230199,4291282887,4291809231,4292335575,4293388263,4293914607,4294440951,4278190081,4278203136,4278216192,4278229248,4278242304,4278255360,4278190131,4278203187,4278216243,4278229299,4278242355,4278255411,4278190182,4278203238,4278216294,4278229350,4278242406,4278255462,4278190233,4278203289,4278216345,4278229401,4278242457,4278255513,4278190284,4278203340,4278216396,4278229452,4278242508,4278255564,4278190335,4278203391,4278216447,4278229503,4278242559,4278255615,4281532416,4281545472,4281558528,4281571584,4281584640,4281597696,4281532467,4281545523,4281558579,4281571635,4281584691,4281597747,4281532518,4281545574,4281558630,4281571686,4281584742,4281597798,4281532569,4281545625,4281558681,4281571737,4281584793,4281597849,4281532620,4281545676,4281558732,4281571788,4281584844,4281597900,4281532671,4281545727,4281558783,4281571839,4281584895,4281597951,4284874752,4284887808,4284900864,4284913920,4284926976,4284940032,4284874803,4284887859,4284900915,4284913971,4284927027,4284940083,4284874854,4284887910,4284900966,4284914022,4284927078,4284940134,4284874905,4284887961,4284901017,4284914073,4284927129,4284940185,4284874956,4284888012,4284901068,4284914124,4284927180,4284940236,4284875007,4284888063,4284901119,4284914175,4284927231,4284940287,4288217088,4288230144,4288243200,4288256256,4288269312,4288282368,4288217139,4288230195,4288243251,4288256307,4288269363,4288282419,4288217190,4288230246,4288243302,4288256358,4288269414,4288282470,4288217241,4288230297,4288243353,4288256409,4288269465,4288282521,4288217292,4288230348,4288243404,4288256460,4288269516,4288282572,4288217343,4288230399,4288243455,4288256511,4288269567,4288282623,4291559424,4291572480,4291585536,4291598592,4291611648,4291624704,4291559475,4291572531,4291585587,4291598643,4291611699,4291624755,4291559526,4291572582,4291585638,4291598694,4291611750,4291624806,4291559577,4291572633,4291585689,4291598745,4291611801,4291624857,4291559628,4291572684,4291585740,4291598796,4291611852,4291624908,4291559679,4291572735,4291585791,4291598847,4291611903,4291624959,4294901760,4294914816,4294927872,4294940928,4294953984,4294967040,4294901811,4294914867,4294927923,4294940979,4294954035,4294967091,4294901862,4294914918,4294927974,4294941030,4294954086,4294967142,4294901913,4294914969,4294928025,4294941081,4294954137,4294967193,4294901964,4294915020,4294928076,4294941132,4294954188,4294967244,4294902015,4294915071,4294928127,4294941183,4294954239,4294967295];return e}function qe(e,t,i){return t>e?v(t-e+qt,i+1)+1:t===e?0:0-(v(e-t+qt,i+1)+1)}function st(){var s,e,n;n=c-1,e=c-(r&n),S=q?u(P,32-e*t):i(P,32-e*t),s=(r+o-1&n)+1,E=q?i(P,32-s*t):u(P,32-s*t),e>o?(S&=E,E=0,N=1):N=v(o-e+n,c)+1,G=ke=1,l=a*B+4*v(r,c),Pe=B*ke-4*(N*G)}function Ye(t,e){return e}function ht(t,i){var e;return e=i<<8,(He[e+(t>>>16&255)]<<10)+(He[e+(t>>>8&255)]<<5)+He[e+(255&t)]}function Qi(l,c){var u,i,f,a,t,r,o,s,n,h;if(f=l>0?1:0===l?0:-1,h=c>0?1:0===c?0:-1,a=Math.abs(c),o=Math.abs(l),r=i=9999,t=n=-9999,o>a){for(u=o>>1,s=1;o>=s;s++)if(M+=f,(u-=a)<0&&(D+=h,u+=o),o>s){if(xe(),e.failed())return null;O>y&&A>F&&(r=Math.min(r,y),t=Math.max(t,O),i=Math.min(i,F),n=Math.max(n,A),(t-r)*(n-i)>4e3&&(y=r,O=t,F=i,A=n,Fe(),r=i=9999,t=n=-9999))}}else for(u=a>>1,s=1;a>=s;s++)if(D+=h,(u-=o)<0&&(M+=f,u+=a),a>s){if(xe(),e.failed())return null;O>y&&A>F&&(r=Math.min(r,y),t=Math.max(t,O),i=Math.min(i,F),n=Math.max(n,A),(t-r)*(n-i)>4e3&&(y=r,O=t,F=i,A=n,Fe(),r=i=9999,t=n=-9999))}y=r,O=t,F=i,A=n,e.storeIntegerofObjectwithValue(dt,b,M),e.storeIntegerofObjectwithValue(wt,b,D)}function Be(t,i,r){var e;e=n[t>>>2],e&=r,e|=i,n[t>>>2]=e}function Zi(r,n){var e,i,t,s;return e=255&r,i=at[7&e],t=ut[e>>>3],s=i>n?t+1:t,e=r>>>8&255,i=at[7&e],t=ut[e>>>3],s|=i>n?t+1<<5:t<<5,e=r>>>16&255,i=at[7&e],t=ut[e>>>3],s|=i>n?t+1<<10:t<<10}function X(r,n){var t,i;return i=e.fetchPointerofObject(r,n),"number"==typeof i?i:(t=e.floatValueOf(i),t>=-2147483648&&2147483647>=t?0|t:(e.primitiveFail(),0))}function Q(r,n,s){var i,t;return t=e.fetchPointerofObject(r,n),"number"==typeof t?t:t.isNil?s:(i=e.floatValueOf(t),i>=-2147483648&&2147483647>=i?0|i:(e.primitiveFail(),0))}function Xi(i,e){return 32!==t?e:0===e?0:0!==(4278190080&e)?e:e|4278190080&i}function Hi(){return Yi}function Me(e){return Ft[Cr(e,Ne)]}function Mt(e){return e.isNil?!0:0===k?!0:5===k?!0:10===k?!0:15===k?!0:!1}function Ji(){s[1]=nr,s[2]=kr,s[3]=vr,s[4]=ui,s[5]=mr,s[6]=Ye,s[7]=ar,s[8]=ur,s[9]=dr,s[10]=lr,s[11]=pr,s[12]=or,s[13]=cr,s[14]=hr,s[15]=fr,s[16]=Ye,s[17]=Ye,s[18]=Ye,s[19]=Ir,s[20]=oi,s[21]=Oi,s[22]=fi,s[23]=Pr,s[24]=Ar,s[25]=Or,s[26]=qi,s[27]=Mi,s[28]=mi,s[29]=di,s[30]=pi,s[31]=Fr,s[32]=Sr,s[33]=gi,s[34]=ai,s[35]=Ce,s[36]=Ce,s[37]=Ce,s[38]=hi,s[39]=xi,s[40]=Tt,s[41]=Xi,s[42]=bi}function Ui(){var e,t,i;for(t=0;255>=t;t++)for(e=0;15>=e;e++)i=Zi(t,e),He[(e<<8)+t]=i}function Gi(){return Ji(),Ui(),!0}function zi(e,t){return e&&t?0===e[_e]&&0===e[Ee]&&0===e[Re]&&0===e[Xe]&&16711680===t[_e]&&65280===t[Ee]&&255===t[Re]&&4278190080===t[Xe]?!0:!1:!0}function Ki(){var i;if(n=e.fetchPointerofObject(ae,K),fe=e.fetchIntegerofObject(pt,K),me=e.fetchIntegerofObject(tt,K),!(fe>=0&&me>=0))return!1;if(t=e.fetchIntegerofObject(vt,K),q=t>0,0>t&&(t=0-t),"number"==typeof n){if(!Ai(n))return!1;c=v(32,t),n=B=0}else{if(c=v(32,t),B=4*v(fe+(c-1),c),i=rt(n),!e.isWordsOrBytes(n)||i!==B*me)return!1;n=n.wordsOrBytes()}return!0}function Qe(e){return Bt(e,!1)}function Bt(i,r){var t;if(b=i,St=r,k=e.fetchIntegerofObject(Kt,b),e.failed()||0>k||k>Ht-2)return!1;if(k>=16&&17>=k)return!1;if(W=e.fetchPointerofObject(Et,b),T=Mt(W),ie=e.fetchPointerofObject(Gt,b),ge=Mt(ie),K=e.fetchPointerofObject(Ut,i),!(e.isPointers(K)&&L(K)>=4))return!1;if(t=Ki(),!t)return!1;if(M=Q(dt,b,0),D=Q(wt,b,0),H=Q(Lt,b,fe),Oe=Q(zt,b,me),e.failed())return!1;if(T)Se=$e=0;else{if(!(e.isPointers(W)&&L(W)>=4))return!1;if(t=Ei(),!t)return!1;if(t=Ri(),!t)return!1;0===(w&Ae)&&Ct(),Se=Q(Rt,b,0),$e=Q(Bi,b,0)}return(t=Li())?(_=Q(Yt,b,0),j=Q(Xt,b,0),we=Q(Zt,b,fe),Ve=Q(Qt,b,me),e.failed()?!1:(0>_&&(we+=_,_=0),0>j&&(Ve+=j,j=0),_+we>fe&&(we=fe-_),j+Ve>me&&(Ve=me-j),!0)):!1}function Ei(){var t;if(f=e.fetchPointerofObject(ae,W),se=X(pt,W),le=X(tt,W),!(se>=0&&le>=0))return!1;if(g=e.fetchIntegerofObject(vt,W),re=g>0,0>g&&(g=0-g),"number"==typeof f){if(!Ii(f))return!1;$=v(32,g),f=C=0}else{if($=v(32,g),C=4*v(se+($-1),$),t=rt(f),!e.isWordsOrBytes(f)||t!==C*le)return!1;f=f.wordsOrBytes()}return!0}function Ri(){var r,t,i,n;if(w=ne=R=0,oe=null,te=null,Y=null,t=e.fetchPointerofObject(Jt,b),t.isNil)return!0;if(w=ee,n=!1,e.isWords(t))i=L(t),Y=t.words,n=!0;else{if(!(e.isPointers(t)&&L(t)>=3))return!1;if(oe=At(e.fetchPointerofObject(0,t)),te=At(e.fetchPointerofObject(1,t)),r=e.fetchPointerofObject(2,t),r.isNil)i=0;else{if(!e.isWords(r))return!1;i=L(r),Y=r.words}w|=Ae}return 0!==(i&i-1)?!1:(ne=i-1,R=0,512===i&&(R=3),4096===i&&(R=4),32768===i&&(R=5),0===i?(Y=null,ne=0):w|=ve,n&&Ct(),zi(oe,te)?(te=null,oe=null):w|=Ot,!0)}function At(t){return t.isNil?null:"number"==typeof t?(e.primitiveFail(),null):e.isWords(t)&&4===L(t)?t.words:(e.primitiveFail(),null)}function Li(){var t;if(ge)return Ft=null,!0;if(e.isPointers(ie)&&L(ie)>=4)t=e.fetchPointerofObject(ae,ie),Ne=e.fetchIntegerofObject(tt,ie),e.isWords(t)||(ge=!0);else{if(e.isPointers(ie)||!e.isWords(ie))return!1;t=ie,Ne=L(t)}return Ft=t.wordsOrBytes(),!0}function Ge(){return ye=e.ioLoadFunctionFrom("ioGetSurfaceFormat","SurfacePlugin"),Ie=e.ioLoadFunctionFrom("ioLockSurface","SurfacePlugin"),ze=e.ioLoadFunctionFrom("ioUnlockSurface","SurfacePlugin"),!!ye&&!!Ie&&!!ze}function Ti(e){return Bt(e,!0)}function xt(){var s,t,u,i,c,d,l;if(je=!1,0===n){if(!Ie&&!Ge())return null;if(i=Ie,s=e.fetchIntegerofObject(ae,K),0===f&&!T&&(t=e.fetchIntegerofObject(ae,W),t===s))return St?(l=Math.min(p,r),c=Math.max(p,r)+o,u=Math.min(m,a),d=Math.max(m,a)+h,f=i(t,function(e){C=e},l,u,c-l,d-u)):f=i(t,function(e){C=e},0,0,se,le),n=f,B=C,je=!0,0!==n;n=i(s,function(e){B=e},r,a,o,h),je=!0}if(0===f&&!T){if(t=e.fetchIntegerofObject(ae,W),!Ie&&!Ge())return null;i=Ie,f=St?i(t,function(e){C=e},0,0,se,le):i(t,function(e){C=e},p,m,o,h),je=!0}return 0!==n&&(0!==f||T)}function Ke(i,t){var e;return e=i,0!==(t&ee)&&(0!==(t&Ot)&&(e=vi(i,t),0===e&&0!==i&&(e=1)),0!==(t&ve)&&(e=Y[e&ne])),e}function Di(e){0===strcmp(e,"SurfacePlugin")&&(ye=Ie=ze=0)}function Nt(s,a,n,o){var t,r,e;for(e=x[n],t=0,r=1;o>=r;r++)(s&e)===e&&(t|=a&e),e=i(e,n);return t}function lt(r,n,o,l,s){var e,a,i,t;return t=r&s,e=n&s,i=(r^t)+(n^e),a=t&e|(t|e)&i,i^t^e|u(a,o-1)*l}function et(s,a,n,o){var t,r,e;for(e=x[n],t=0,r=1;o>=r;r++)t|=Math.max(a&e,s&e),e=i(e,n);return t}function ce(s,a,n,o){var t,r,e;for(e=x[n],t=0,r=1;o>=r;r++)t|=Math.min(a&e,s&e),e=i(e,n);return t}function it(a,o,e,l){var s,r,n,t;return t=x[e],s=i(t,e),r=u(((a&t)+1)*((o&t)+1)-1&s,e),1===l?r:(n=((u(a,e)&t)+1)*((u(o,e)&t)+1)-1&s,r|=n,2===l?r:(n=((u(a,2*e)&t)+1)*((u(o,2*e)&t)+1)-1&s,r|=i(n,e),3===l?r:(n=((u(a,3*e)&t)+1)*((u(o,3*e)&t)+1)-1&s,r|=i(n,2*e))))}function Wi(l,c,e,f){var t,o,r,n,a,s;for(s=x[e],o=0,n=1;f>=n;n++)r=u(l&s,(n-1)*e),t=u(c&s,(n-1)*e),32!==e&&(16===e?(r=4278190080|ct(r),t=4278190080|ct(t)):(r=4278190080|de(r,e,32),t=4278190080|de(t,e,32))),a=nt(r,t),32!==e&&(a=de(a,32,e)),o|=i(a,(n-1)*e),s=i(s,e);return o}function pe(o,u,a,l){var t,n,r,s,e;for(e=x[a],n=0,s=1;l>=s;s++)r=o&e,t=u&e,n|=t>r?t-r:r-t,e=i(e,a);return n}function _i(){st(),T?$i():(sr(),g!==t||0!==w||re!==q?Wt():(li(),er()))}function Ni(m,l,d,p,h,c){var n,e,r,t,s,o,a;if(r=f[I>>>2],a=0,e=We,t=U,o=m,l===(ee|ve)){do n=u(r,e)&d,s=Y[n&ne],a|=i(s&p,t),t+=c,0!==(4294967264&(e+=h))&&(re?e+=32:e-=32,r=f[(I+=4)>>>2]);while(0!==--o)}else do n=u(r,e)&d,s=Ke(n,l),a|=i(s&p,t),t+=c,0!==(4294967264&(e+=h))&&(re?e+=32:e-=32,r=f[(I+=4)>>>2]);while(0!==--o);return We=e,a}function ft(t,i){var a,r,n,e,s;return 0>t||0>i||(e=t>>>14)>=se||(s=i>>>14)>=le?0:(n=s*C+4*u(e,gt),r=f[n>>>2],We=yt[e&kt],a=u(r,We)&_t)}function Tt(u,n){var r,s,a,o,e;if(32===t)return u===n?0:n;for(s=t,e=x[s],a=0,o=1;c>=o;o++)r=n&e,(u&e)===r&&(r=0),a|=r,e=i(e,s);return a}function Mi(e,i){return Nt(~e,i,t,c)}function qi(e,i){return 0===e?i:e|Nt(~e,i,t,c)}function xi(l,n){var s,e,r,a,o;if(1===c)return n;if(s=0,r=i(1,t)-1,a=i(r,(c-1)*t),e=32-t,s|=i(n&r,e)|u(n&a,e),2>=c)return s;for(o=2;c>>1>=o;o++)r=i(r,t),a=u(a,t),e-=2*t,s|=i(n&r,e)|u(n&a,e);return s}function ji(){var t;return t=e.stackValue(e.methodArgumentCount()),Qe(t)?(xe(),e.failed()?null:(Fe(),e.failed()?null:(e.pop(e.methodArgumentCount()),22===k||32===k?(e.pop(1),e.pushInteger(Z)):void 0))):e.primitiveFail()}function Vi(){var c,S,u,d,s,v,b,i,l,I,P,m,C,p;if(6!==e.methodArgumentCount())return e.primitiveFail();if(P=e.stackIntegerValue(0),s=e.stackObjectValue(1),l=e.stackObjectValue(2),jt(s)!==e.classArray()||jt(l)!==e.classArray())return e.primitiveFail();if(256!==L(l))return e.primitiveFail();if(e.failed())return null;if(v=L(s)-2,u=e.stackIntegerValue(3),m=e.stackIntegerValue(4),p=e.stackObjectValue(5),!e.isBytes(p))return e.primitiveFail();if(!(m>0&&u>0&&u<=rt(p)))return e.primitiveFail();if(d=e.stackObjectValue(6),!Qe(d))return e.primitiveFail();if(30===k||31===k)return e.primitiveFail();for(b=0!==n&&0!==f&&T===!1&&W!==K&&(0!==w||re!==q||g!==t),I=M,S=p.bytes,c=m;u>=c;c++){if(C=S[c-1],i=e.fetchIntegerofObject(C,l),0>i||i>v)return e.primitiveFail();if(Se=e.fetchIntegerofObject(i,s),H=e.fetchIntegerofObject(i+1,s)-Se,e.failed())return null;if(bt(),o>0&&h>0&&(b?(st(),Wt(),y=r,O=r+o,F=a,A=a+h):xe()),e.failed())return null;M=M+H+P}y=I,Fe(),e.storeIntegerofObjectwithValue(dt,d,M),e.pop(6)}function wi(){var t,i,r;return i=e.stackValue(2),r=e.stackIntegerValue(1),t=e.stackIntegerValue(0),Qe(i)?(e.failed()||(Qi(r,t),Fe()),void(e.failed()||e.pop(2))):e.primitiveFail()}function Ci(){var p,t,h,r,a,n,d,l,c,f,s,o,i;return s=e.stackIntegerValue(1),o=e.stackIntegerValue(0),t=e.stackValue(2),e.failed()?null:0>s||0>o?(i=0,e.failed()?null:(e.popthenPush(3,i),null)):(t=e.stackValue(e.methodArgumentCount()),e.isPointers(t)&&L(t)>=4?(a=e.fetchPointerofObject(ae,t),e.isWordsOrBytes(a)?(H=e.fetchIntegerofObject(pt,t),Oe=e.fetchIntegerofObject(tt,t),r=e.fetchIntegerofObject(vt,t),e.failed()?null:s>=H||o>=Oe?(i=0,e.failed()?null:(e.popthenPush(3,i),null)):0>r?(e.primitiveFail(),null):(n=v(32,r),l=v(H+(n-1),n),c=rt(a),c!==l*Oe*4?(e.primitiveFail(),null):(d=e.fetchLong32ofObject(o*l+v(s,n),a),f=u(4294967295,32-r),h=32-((s&n-1)+1)*r,p=u(d,h)&f,i=e.positive32BitIntegerFor(p),e.failed()?null:(e.popthenPush(3,i),null)))):(e.primitiveFail(),null)):(e.primitiveFail(),null))}function Pi(){var t;return t=e.stackValue(e.methodArgumentCount()),Ti(t)?(ni(),e.failed()?null:(Fe(),e.failed()?null:void e.pop(e.methodArgumentCount()))):e.primitiveFail()}function Ai(e){return ye||Ge()?ye(e,function(e,i,r,n){fe=e,me=i,t=r,q=n}):!1}function Ii(e){return ye||Ge()?ye(e,function(e,t,i,r){se=e,le=t,g=i,re=r}):!1}function Oi(n,s){var r,e;return 16>t?(e=i(1,t)-1,r=i(v(4294967295,e),t-1),lt(n,s,t,e,r)):16===t?(e=31,r=1108361744,lt(2147450879&n,2147450879&s,5,e,r)):(e=255,r=2155905152,lt(n,s,8,e,r))}function Fi(){var y,F,e,t,k,O,c,I,l,b,g,s,d,v;for(b=h+1,g=m,d=a,e=16*(1&r),q&&(e=16-e),S=i(65535,16-e);0!==--b;){for(k=g*C+4*p,c=d*B+4*(r>>1),y=4*(3&d),v=(3&p)-1,O=o+1,l=S,e=65535===l?16:0;0!==--O;)F=Dt[y+(v=v+1&3)],t=f[k>>>2],I=16777215&t,0!==I&&(s=n[c>>>2],s&=~l,s=u(s,e),s=(31744&s)<<9|(992&s)<<6|((31&s)<<3|4278190080),t=nt(t,s),t=ht(t,F),t=0===t?i(1,e):i(t,e),Be(c,t,l)),k+=4,q?0===e&&(c+=4):0!==e&&(c+=4),e=16^e,l=~l;++g,++d}}function Si(){var i,e,s,t,d,v,l,u,c;for(v=h+1,l=m,c=a;0!==--v;){for(e=l*C+4*p,t=c*B+4*r,s=o+1;0!==--s;)if(i=f[e>>>2],d=16777215&i,0===d){for(e+=4,t+=4;0!==--s&&0===(16777215&(i=f[e>>>2]));)e+=4,t+=4;++s}else u=n[t>>>2],u=nt(i,u),n[t>>>2]=u,e+=4,t+=4;++l,++c}}function nt(v,d){var s,n,c,t,p,f,l,r,a,o,u,h,i,m,e;return i=v,0===i?d:(n=Ze,a=255&ot,h=255&i,i>>>=8,c=255&i,i>>>=8,l=255&i,i>>>=8,f=255&i,255!==a&&(f=f*a>>>8,l=l*a>>>8,c=c*a>>>8,h=h*a>>>8),r=d,t=255&r,e=255&n,J&&(t=J[t],e=J[e]),u=(t*(255-h)>>>8)+(e*h>>>8),u>255&&(u=255),he&&(u=he[u]),r>>>=8,n>>>=8,t=255&r,e=255&n,J&&(t=J[t],e=J[e]),s=(t*(255-c)>>>8)+(e*c>>>8),s>255&&(s=255),he&&(s=he[s]),r>>>=8,n>>>=8,t=255&r,e=255&n,J&&(t=J[t],e=J[e]),o=(t*(255-l)>>>8)+(e*l>>>8),o>255&&(o=255),he&&(o=he[o]),r>>>=8,n>>>=8,p=((255&r)*(255-f)>>>8)+f,p>255&&(p=255),m=(((p<<8)+o<<8)+s<<8)+u)}function yi(){var t,e,b,I,O,k,s,A,d,l,F,g,c,y;for(O=Pt(),A=w&~Ae,F=h+1,g=m,y=a,S=8*(3&r),q&&(S=24-S),E=P^i(255,S),s=0===(1&r)?0:522133279,0===(1&a)&&(s=522133279^s);0!==--F;){for(s=522133279^s,b=g*C+4*p,k=y*B+4*(r>>2),I=o+1,t=S,l=E;0!==--I;)e=(f[b>>>2]&~s)+s,d=16777215&e,d=v((d>>>16)+(d>>>8&255)+(255&d),3),d>31&&(d>224&&(e=4294967295),c=n[k>>>2],c&=~l,c=u(c,t),c=O[c],e=nt(e,c),e=Ke(e,A),e=i(e,t),Be(k,e,l)),b+=4,q?0===t?(k+=4,t=24,l=16777215):(t-=8,l=l>>>8|4278190080):32===t?(k+=4,t=0,l=4294967040):(t+=8,l=l<<8|255),s=522133279^s;++g,++y}}function bi(e,i){var r;return r=e,0===r?i:Wi(e,i,t,c)}function gi(m,p){var f,i,e,s,n,r,o,h,a,l;for(n=x[t],16===t?(i=5,r=31):(i=8,r=255),a=d,o=p,s=m,h=1;c>=h;h++)(a&n)>0&&(l=o&n,f=s&n,16>t?e=f===l?0:1:(e=pe(f,l,i,3),e=(e&r)+(u(e,i)&r)+(u(u(e,i),i)&r)),Z+=e),a=u(a,t),s=u(s,t),o=u(o,t);return p}function ct(e){return(31&e)<<3|(992&e)<<6|(31744&e)<<9}function ki(e){return e}function de(n,o,s){var r,a,t,e;return(r=s-o)>0?(e=i(1,o)-1,t=i(n,r),e=i(e,r),a=t&e,e=i(e,s),t=i(t,r),a+(t&e)+(i(t,r)&i(e,s))):0===r?5===o?32767&n:8===o?16777215&n:n:0===n?n:(r=o-s,e=i(1,s)-1,t=u(n,r),a=t&e,e=i(e,s),t=u(t,r),a=a+(t&e)+(u(t,r)&i(e,s)),0===a?1:a)}function vi(e,i){var t;return t=z(e&te[0],oe[0]),t|=z(e&te[1],oe[1]),t|=z(e&te[2],oe[2]),t|z(e&te[3],oe[3])}function mi(e,i){return 16>t?et(e,i,t,c):16===t?et(e,i,5,3)+(et(e>>>16,i>>>16,5,3)<<16):et(e,i,8,4)}function di(e,i){return 16>t?ce(e,i,t,c):16===t?ce(e,i,5,3)+(ce(e>>>16,i>>>16,5,3)<<16):ce(e,i,8,4)}function pi(r,i){var e;return e=~r,16>t?ce(e,i,t,c):16===t?ce(e,i,5,3)+(ce(e>>>16,i>>>16,5,3)<<16):ce(e,i,8,4)}function hi(e,i){return 16>t?it(e,i,t,c):16===t?it(e,i,5,3)+(it(e>>>16,i>>>16,5,3)<<16):it(e,i,8,4)}function fi(e,i){return 16>t?pe(e,i,t,c):16===t?pe(e,i,5,3)+(pe(e>>>16,i>>>16,5,3)<<16):pe(e,i,8,4)}function ci(i){var t;return e=i,t=e.majorVersion()==ei,t===!1?!1:t=e.minorVersion()>=$t}function Ct(){var i,e;if(i=e=0,8>=g)return null;if(16===g&&(i=5),32===g&&(i=8),0===R){if(8>=t)return null;16===t&&(e=5),32===t&&(e=8)}else e=R;mt(i,e)}function mt(n,a){var e,t,s=[0,0,0,0],r=[0,0,0,0];return e=a-n,0===e?0:(0>=e?(t=i(1,a)-1,r[_e]=i(t,2*n-e),r[Ee]=i(t,n-e),r[Re]=i(t,0-e),r[Xe]=0):(t=i(1,n)-1,r[_e]=i(t,2*n),r[Ee]=i(t,n),r[Re]=t),s[_e]=3*e,s[Ee]=2*e,s[Re]=e,s[Xe]=0,oe=s,te=r,void(w|=ee|Ot))}function Fe(){e.showDisplayBitsLeftTopRightBottom(K,y,F,O,A)}function li(){var e,i,n,s;s=c-1,i=p&s,e=r&s,G>0?(n=Math.min(o,c-e),Je=i+n>s):(n=Math.min(o,e+1),Je=0>i-n+1),V=re?(i-e)*t:(e-i)*t,Je&&(0>V?V+=32:V-=32),I=m*C+4*v(p,v(32,g)),Ue=C*ke-4*(N*G),Je&&(Ue-=4*G)}function ui(e,t){return e}function oi(e,t){return e-t}function ai(l,n){var s,a,e,o,i,r;if((w&(ee|ve))!==(ee|ve))return n;for(s=x[t],e=n,i=d,o=1;c>=o;o++)0!==(i&s)&&(r=e&s,a=16>t?r:16===t?de(r,5,R):de(r,8,R),Le(a,Te(a)+1)),i=u(i,t),e=u(e,t);return n}function Te(e){return Y[e&ne]}function Le(e,t){return Y[e&ne]=t}function si(){return T?!1:34!==k&&41!==k?!1:32!==g?!1:W===K?!1:41===k?32===t?(Si(),y=r,O=r+o,F=a,A=a+h,!0):16===t?(Fi(),y=r,O=r+o,F=a,A=a+h,!0):8===t?(yi(),y=r,O=r+o,F=a,A=a+h,!0):!1:8>t?!1:8===t&&0===(w&ee)?!1:(32===t&&br(),16===t&&yr(),8===t&&gr(),y=r,O=r+o,F=a,A=a+h,!0)}function It(){var t,i,r,s;if(je){if(!ze&&!Ge())return null;r=ze,s=!1,t=e.fetchPointerofObject(ae,K),"number"==typeof t&&(t=t,r(t,y,F,O-y,A-F),n=B=0,s=!0),T||(i=e.fetchPointerofObject(ae,W),"number"==typeof i&&(i=i,s&&i===t||r(i,0,0,0,0),f=C=0)),je=!1}}function ni(){var t;return t=T,T=!0,bt(),T=t,T||0>=o||0>=h?(y=O=F=A=0,null):xt()?(st(),ri(),G>0?(y=r,O=r+o):(y=r-o+1,O=r+1),ke>0?(F=a,A=a+h):(F=a-h+1,A=a+1),void It()):e.primitiveFail()}function ri(){var ne,ee,f,te,u,z,W,Z,ie,K,y,J,V,$,Q,O,G,A,C,x,I,F,re,T,v,B;if(ie=s[k+1],!(L(b)>=ue+12))return e.primitiveFail();if(u=Oe-1,0>=u&&(u=1),I=X(ue,b),f=X(ue+3,b),v=qe(I,f,u),0>v&&(I=f-u*v),O=X(ue+1,b),f=X(ue+4,b),F=qe(O,f,u),0>F&&(O=f-u*F),A=X(ue+9,b),f=X(ue+6,b),K=qe(A,f,u),0>K&&(A=f-u*K),y=X(ue+10,b),f=X(ue+7,b),z=qe(y,f,u),0>z&&(y=f-u*z),e.failed())return!1;if(2===e.methodArgumentCount())if(B=e.stackIntegerValue(1),C=e.stackValue(0),C.isNil){if(16>g)return e.primitiveFail()}else{if(L(C)<i(1,g))return e.primitiveFail();C=C.wordsOrBytes()}else B=1,C=e.nilObject();for(u=H-1,0>=u&&(u=1),Z=c-(r&c-1),re=(r+o-1&c-1)+1,Z>o&&(Z=o),j>D&&(I+=(j-D)*v,O+=(j-D)*F,A+=(j-D)*K,y+=(j-D)*z),wr(),B>1&&0===(w&Ae)&&(Y?mt(8,R):16===t&&mt(8,5)),ne=w&~Ae,q?(G=0-t,ee=32-t):(G=t,ee=0),J=1;h>=J;J++){x=qe(I,A,u),p=x>=0?I:A-u*x,V=qe(O,y,u),m=V>=0?O:y-u*V,U=q?32-((r&c-1)+1)*t:(r&c-1)*t,_>M&&(p+=(_-M)*x,m+=(_-M)*V),$=ge?P:Me(a+J-1),d=S,T=Z,f=N;do te=1===B?ti(T,x,V,v,F,G,ne):ii(T,x,V,v,F,C,B,G),U=ee,d===P?(Q=ie(te&$,n[l>>>2]),n[l>>>2]=d&Q):(W=n[l>>>2],Q=ie(te&$,W&d),W=d&Q|W&~d,n[l>>>2]=W),l+=4,2===f?(d=E,T=re):(d=P,T=c);while(0!==--f);I+=v,O+=F,A+=K,y+=z,l+=Pe}}function wr(){var e,t;for(De=0,t=g;1!==t;)++De,t>>>=1;for(_t=x[g],gt=5-De,kt=i(1,gt)-1,e=0;kt>=e;e++)re?yt[e]=32-i(e+1,De):yt[e]=i(e,De)}function ii(N,c,f,j,A,B,n,M){var P,y,F,q,l,C,I,V,h,e,b,o,S,u,O,s,a,r,d;V=x[t],y=0,2===n?(F=c>>1,l=f>>1,I=j>>1,h=A>>1):(F=v(c,n),l=v(f,n),I=v(j,n),h=v(A,n)),C=N;do{O=p,b=m,s=a=u=o=0,r=0,q=n;do{d=O,S=b,P=n;do e=ft(d,S),(25!==k||0!==e)&&(++r,e=16>g?B[e]:16===g?ct(e):ki(e),o+=255&e,u+=e>>>8&255,a+=e>>>16&255,s+=e>>>24),d+=F,S+=l;while(0!==--P);O+=I,b+=h}while(0!==--q);0===r||25===k&&n*n>>1>r?e=0:(4===r?(a>>>=2,u>>>=2,o>>>=2,s>>>=2):(a=v(a,r),u=v(u,r),o=v(o,r),s=v(s,r)),e=(s<<24)+(a<<16)+(u<<8)+o,0===e&&a+u+o+s>0&&(e=1),e=Ke(e,w)),y|=i(e&V,U),U+=M,p+=c,m+=f}while(0!==--C);return y}function ti(f,u,c,d,h,o,l){var n,a,r,s,e;if(s=x[t],e=0,a=f,l===(ee|ve)){do n=ft(p,m),r=Y[n&ne],e|=i(r&s,U),U+=o,p+=u,m+=c;while(0!==--a)}else do n=ft(p,m),r=Ke(n,l),e|=i(r&s,U),U+=o,p+=u,m+=c;while(0!==--a);return e}var ei=1,$t=11,P=4294967295,Xe=3,Qt=13,Zt=12,Yt=10,Xt=11,Jt=14,Ut=0,dt=4,wt=5,Gt=2,zt=7,Kt=3,Et=1,Rt=8,Bi=9,ue=15,Lt=6,Re=2,Ot=2,ve=4,Ae=8,ee=1,qt=16384,ae=0,vt=3,tt=2,pt=1,Ee=1,Ht=43,_e=0,A=0,y=0,O=0,F=0,h=0,o=0,b=0,Z=0,Ve=0,we=0,_=0,j=0,R=0,w=0,Y=null,ne=0,te=null,oe=null,k=0,ot=0,Ze=0,n=0,Pe=0,t=0,K=0,me=0,l=0,q=0,d=0,c=0,B=0,fe=0,M=0,D=0,He=new Array(4096),Dt=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5],at=[0,2,4,6,8,12,14,16],ut=[0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],U=0,r=0,a=0,he=null,G=0,Ft=0,ie=0,Ne=0,je=0,Oe=0,e=null,St=0,Ie=null,S=0,E=0,x=[0,1,3,0,15,31,0,0,255,0,0,0,0,0,0,0,65535,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1],Yi="BitBltPlugin 3 November 2014 (e)",N=0,ge=0,T=0,s=new Array(43),Je=0,ye=null,V=0,be=0,f=0,Ue=0,g=0,W=0,le=0,I=0,re=0,$=0,C=0,se=0,Se=0,$e=0,We=0,p=0,m=0,J=null,ze=null,ke=0,kt=0,gt=0,yt=new Array(32),_t=0,De=0,H=0;Squeak.registerExternalModule("BitBltPlugin",{primitiveCopyBits:ji,copyBits:xe,moduleUnloaded:Di,primitiveDrawLoop:wi,primitiveDisplayString:Vi,initialiseModule:Gi,loadBitBltFrom:Qe,setInterpreter:ci,primitiveWarpBits:Pi,getModuleName:Hi,primitivePixelValueAt:Ci,copyBitsFromtoat:rr})}),module("users.bert.SqueakJS.plugins.FFTPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function n(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function b(e,t){return 0|Math.floor(e/t)}function v(t,e){return e>31?0:t<<e}function c(t){return e.success(e.isWords(t)),e.failed()?0:t.wordsAsFloat32Array()}function P(t){return e.success(e.isWords(t)),t.words}function A(){return k}function h(h){var o;return e.success(n(h)>=6),e.failed()?!1:(l=e.fetchIntegerofObject(0,h),r=e.fetchIntegerofObject(1,h),o=e.fetchPointerofObject(2,h),p=n(o),s=c(o),o=e.fetchPointerofObject(3,h),m=n(o),u=P(o),o=e.fetchPointerofObject(4,h),a=n(o),t=c(o),o=e.fetchPointerofObject(5,h),f=n(o),i=c(o),e.success(v(1,l)===r&&(r>>2)+1===p&&r===a&&r===f&&a===f),e.failed()===!1)}function o(){var r,n,l,s,o;for(s=0,l=m;l>s;){if(r=u[s]-1,n=u[s+1]-1,!(a>r&&a>n))return e.success(!1);o=t[r],t[r]=t[n],t[n]=o,o=i[r],i[r]=i[n],i[n]=o,s+=2}}function O(){var t;return t=e.stackObjectValue(0),h(t)?(o(),void(e.failed()&&o())):null}function F(){var t;return t=e.stackObjectValue(0),h(t)?void d():null}function y(){var t,i;return t=e.booleanValueOf(e.stackValue(0)),i=e.stackObjectValue(1),h(i)?(C(t),void(e.failed()||e.pop(1))):null}function d(){var e,n;if(1>=r)return null;for(n=1/r,e=0;r-1>=e;e++)t[e]=t[e]*n,i[e]=i[e]*n}function g(i){var t;return e=i,t=e.majorVersion()==S,t===!1?!1:t=e.minorVersion()>=I}function C(t){return o(),e.failed()?(o(),null):(w(t),void(t||d()))}function w(O){var S,F,m,u,n,y,a,e,c,d,k,h,g,f,o;for(F=r>>1,m=r>>2,h=1;l>=h;h++)for(d=v(1,h),k=d>>1,S=b(r,d),c=1;k>=c;c++)for(o=(c-1)*S,m>o?(f=s[p-o-1],a=s[o]):(f=0-s[o-m],a=s[F-o]),O||(a=0-a),u=c;r>=u;)e=u+k-1,n=u-1,g=t[e]*f-i[e]*a,y=t[e]*a+i[e]*f,t[e]=t[n]-g,i[e]=i[n]-y,t[n]=t[n]+g,i[n]=i[n]+y,u+=d}var S=1,I=11,r=0,i=null,f=0,e=null,k="FFTPlugin 3 November 2014 (e)",l=0,u=null,m=0,t=null,a=0,s=null,p=0;Squeak.registerExternalModule("FFTPlugin",{primitiveFFTTransformData:y,setInterpreter:g,primitiveFFTPermuteData:O,primitiveFFTScaleData:F,getModuleName:A})}),module("users.bert.SqueakJS.plugins.FloatArrayPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function t(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function f(){return S}function i(){var r,o,i,s,n,a;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(n)),
e.failed())return null;if(s=t(r),e.success(s===t(n)),e.failed())return null;for(a=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;s-1>=i;i++)a[i]=a[i]+o[i];e.pop(1)}function r(){var i,s,r,n,a;if(a=e.stackFloatValue(0),r=e.stackObjectValue(1),e.failed())return null;if(e.success(e.isWords(r)),e.failed())return null;for(s=t(r),n=r.wordsAsFloat32Array(),i=0;s-1>=i;i++)n[i]=n[i]+a;e.pop(1)}function n(){var n,s,i,r;return i=e.stackIntegerValue(0),r=e.stackObjectValue(1),e.failed()?null:(e.success(e.isWords(r)),e.success(i>0&&i<=t(r)),e.failed()?null:(n=r.wordsAsFloat32Array(),s=n[i-1],e.pop(2),void e.pushFloat(s)))}function s(){var s,a,r,n,i;return i=e.stackValue(0),a="number"==typeof i?i:e.floatValueOf(i),r=e.stackIntegerValue(1),n=e.stackObjectValue(2),e.failed()?null:(e.success(e.isWords(n)),e.success(r>0&&r<=t(n)),e.failed()?null:(s=n.wordsAsFloat32Array(),s[r-1]=a,void(e.failed()||e.popthenPush(3,i))))}function a(){var r,a,i,n,s,o;if(r=e.stackObjectValue(0),s=e.stackObjectValue(1),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(s)),e.failed())return null;if(n=t(r),e.success(n===t(s)),e.failed())return null;for(o=s.wordsAsFloat32Array(),a=r.wordsAsFloat32Array(),i=0;n-1>=i;i++)if(0===a[i])return e.primitiveFail();for(i=0;n-1>=i;i++)o[i]=o[i]/a[i];e.pop(1)}function o(){var i,a,o,r,n,s;if(s=e.stackFloatValue(0),r=e.stackObjectValue(1),e.failed())return null;if(0===s)return e.primitiveFail();if(e.success(e.isWords(r)),e.failed())return null;for(o=t(r),n=r.wordsAsFloat32Array(),a=1/s,i=0;o-1>=i;i++)n[i]=n[i]*a;e.pop(1)}function u(){var r,o,i,s,n,u,a;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(n)),e.failed())return null;if(s=t(r),e.success(s===t(n)),e.failed())return null;for(u=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),a=0,i=0;s-1>=i;i++)a+=u[i]*o[i];e.pop(2),e.pushFloat(a)}function l(){var r,a,i,s,n,o;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(n)),e.failed())return null;if(e.pop(2),s=t(r),s!==t(n))return e.pushBool(!1);for(o=n.wordsAsFloat32Array(),a=r.wordsAsFloat32Array(),i=0;s-1>=i;i++)if(o[i]!==a[i])return e.pushBool(!1);return e.pushBool(!0)}function c(){var i,s,r,a,n;if(r=e.stackObjectValue(0),e.failed())return null;if(e.success(e.isWords(r)),e.failed())return null;for(s=t(r),a=r.wordsAsInt32Array(),n=0,i=0;s-1>=i;i++)n+=a[i];return e.pop(1),e.pushInteger(536870911&n)}function F(){var i,a,n,s,r;if(n=e.stackObjectValue(0),e.failed())return null;if(e.success(e.isWords(n)),e.failed())return null;for(a=t(n),e.success(!0),s=n.wordsAsFloat32Array(),r=0,i=0;a-1>=i;i++)r+=s[i]*s[i];r=Math.sqrt(r),e.popthenPush(1,e.floatObjectOf(r))}function h(){var r,o,i,s,n,a;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(n)),e.failed())return null;if(s=t(r),e.success(s===t(n)),e.failed())return null;for(a=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;s-1>=i;i++)a[i]=a[i]*o[i];e.pop(1)}function p(){var i,s,r,n,a;if(a=e.stackFloatValue(0),r=e.stackObjectValue(1),e.failed())return null;if(e.success(e.isWords(r)),e.failed())return null;for(s=t(r),n=r.wordsAsFloat32Array(),i=0;s-1>=i;i++)n[i]=n[i]*a;e.pop(1)}function d(){var i,r,a,s,n;if(s=e.stackObjectValue(0),e.failed())return null;if(e.success(e.isWords(s)),e.failed())return null;for(a=t(s),e.success(!0),n=s.wordsAsFloat32Array(),r=0,i=0;a-1>=i;i++)r+=n[i]*n[i];if(e.success(r>0),e.failed())return null;for(r=Math.sqrt(r),i=0;a-1>=i;i++)n[i]=n[i]/r}function m(){var r,o,i,s,n,a;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(n)),e.failed())return null;if(s=t(r),e.success(s===t(n)),e.failed())return null;for(a=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;s-1>=i;i++)a[i]=a[i]-o[i];e.pop(1)}function v(){var i,s,r,n,a;if(a=e.stackFloatValue(0),r=e.stackObjectValue(1),e.failed())return null;if(e.success(e.isWords(r)),e.failed())return null;for(s=t(r),n=r.wordsAsFloat32Array(),i=0;s-1>=i;i++)n[i]=n[i]-a;e.pop(1)}function k(){var i,s,r,a,n;if(r=e.stackObjectValue(0),e.failed())return null;if(e.success(e.isWords(r)),e.failed())return null;for(s=t(r),a=r.wordsAsFloat32Array(),n=0,i=0;s-1>=i;i++)n+=a[i];e.popthenPush(1,e.floatObjectOf(n))}function g(i){var t;return e=i,t=e.majorVersion()==b,t===!1?!1:t=e.minorVersion()>=y}var b=1,y=11,e=null,S="FloatArrayPlugin 3 November 2014 (e)";Squeak.registerExternalModule("FloatArrayPlugin",{primitiveMulFloatArray:h,primitiveEqual:l,primitiveAtPut:s,primitiveAt:n,primitiveNormalize:d,primitiveSubFloatArray:m,primitiveDivFloatArray:a,primitiveAddScalar:r,primitiveDotProduct:u,primitiveSubScalar:v,setInterpreter:g,primitiveSum:k,getModuleName:f,primitiveHashArray:c,primitiveMulScalar:p,primitiveLength:F,primitiveAddFloatArray:i,primitiveDivScalar:o})}),module("users.bert.SqueakJS.plugins.GeniePlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function t(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function i(e,t){return new Int32Array(e.buffer,e.byteOffset+4*t)}function r(i,r){var n,s,e,a,o,t;return n=i[0],a=i[1],s=r[0],o=r[1],e=s-n,t=o-a,e*e+t*t}function d(t,i){var e;return e=Math.abs(i-t),e>180&&(e=360-e),e*e>>>6}function u(){return s}function a(){return 2}function o(){return 0}function n(e){console.log(s+": "+e)}function l(){var Z,H,K,o,A,V,w,O,Q,h,J,D,g,y,U,f,S,b,z,Y,u,l,N,I,s,a,p,F,X,E,m,v,$,B,c,k,C,P,T,L,R,x,W,j,G,M,_,q,ee;if(C=e.stackValue(11),P=e.stackValue(10),T=e.stackValue(9),L=e.stackValue(8),R=e.stackValue(7),x=e.stackValue(6),W=e.stackValue(5),j=e.stackValue(4),G=e.stackIntegerValue(3),M=e.stackValue(2),_=e.stackValue(1),q=e.stackValue(0),e.failed())return null;if(e.failed())return n("failed 1"),null;if(e.success(e.isWords(C)&&e.isWords(P)&&e.isWords(T)&&e.isWords(L)&&e.isWords(R)&&e.isWords(x)&&e.isWords(W)&&e.isWords(j)&&e.isWords(M)&&e.isWords(_)&&e.isWords(q)),e.failed())return n("failed 2"),null;if(e.success(e.isMemberOf(C,"PointArray")&&e.isMemberOf(P,"PointArray")),e.failed())return n("failed 3"),null;if(g=C.wordsAsInt32Array(),b=P.wordsAsInt32Array(),Y=T.wordsAsInt32Array(),Q=L.wordsAsInt32Array(),U=R.wordsAsInt32Array(),J=x.wordsAsInt32Array(),$=W.wordsAsInt32Array(),Z=j.wordsAsInt32Array(),l=M.wordsAsInt32Array(),c=_.wordsAsInt32Array(),u=q.wordsAsInt32Array(),z=t(P)>>>1,F=t(T)>>>1,h=t(L)>>>1,H=t(x),D=t(M),e.success(D===t(_)&&D===t(q)&&D>h),e.failed())return n("failed 4"),null;if(e.success(t(R)>=F-1&&t(C)>>>1>=F&&H>=h-1&&z>=h&&t(W)>=F-1&&t(j)>=h-1),e.failed())return n("failed 5"),null;if(K=1&G,E=G>>>1,N=1<<29,f=K?0:E*E>>>10,l[0]=0,c[0]=0,u[0]=2,a=0-f,y=h,!(z>=y-1&&H>=y-1))return e.primitiveFail(),null;for(s=1;y>=s;s++)o=s-1,a=a+(J[o]+r(i(b,o<<1),g)>>>7)+f,c[s]=a,l[s]=a*s,u[s]=s+1;for(a=c[0]-f,p=1;F>=p;p++){for(A=p-1,I=A<<1,v=l[0],a=a+(U[A]+r(i(g,I),b)>>>7)+f,c[0]=a,l[0]=a*p,u[0]=p+1,y=h,s=1;y>=s;s++)o=s-1,V=o<<1,m=l[s],k=l[o],S=U[A]+r(i(g,I),i(b,s<<1))>>>7,0===(a=c[s])?m+=S:(m=m+a+S*u[s],S+=a),O=J[o]+r(i(b,V),i(g,p<<1))>>>7,0===(a=c[o])?k+=O:(k=k+a+O*u[o],O+=a),K?v=N:(X=(r(i(Q,V),i(Y,I))+r(i(b,V),i(g,I)))*(16+d(Z[o],$[A]))>>>11,v+=X),m>=v&&k>=v?(w=v,a=0,B=1):k>=m?(w=m,a=S+f,B=u[s]+1):(w=k,a=O+f,B=u[o]+1),v=l[s],l[s]=Math.min(w,N),c[s]=Math.min(a,N),u[s]=B;a=c[0]}return ee=w,e.failed()?null:(e.popthenPush(13,ee),null)}function c(){var t;return t=1e3*a()+o(),e.failed()?null:(e.popthenPush(1,t),null)}function f(i){var t;return e=i,t=e.majorVersion()==h,t===!1?!1:t=e.minorVersion()>=p}var h=1,p=11,e=null,s="GeniePlugin v2.0 14 November 2014 (e)";Squeak.registerExternalModule("GeniePlugin",{primVersionNO:c,setInterpreter:f,primSameClassAbsoluteStrokeDistanceMyPoints_otherPoints_myVectors_otherVectors_mySquaredLengths_otherSquaredLengths_myAngles_otherAngles_maxSizeAndReferenceFlag_rowBase_rowInsertRemove_rowInsertRemoveCount:l,getModuleName:u})}),module("users.bert.SqueakJS.plugins.JPEGReaderPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function n(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function ue(e){return e.bytes?e.bytes.length:e.words?4*e.words.length:0}function v(e,t){return 0|Math.floor(e/t)}function V(t,e){return e>31?0:t<<e}function fe(t,e){return e>31?0:t>>>e}function he(e){return P(u,e)&&w(re,e)}function P(i,t){return"number"==typeof t?!1:e.isPointers(t)?n(t)<U?!1:(i[s]=e.fetchIntegerofObject(s,t),i[o]=e.fetchIntegerofObject(o,t),i[b]=e.fetchIntegerofObject(b,t),i[F]=e.fetchIntegerofObject(F,t),i[y]=e.fetchIntegerofObject(y,t),i[g]=e.fetchIntegerofObject(g,t),i[k]=e.fetchIntegerofObject(k,t),!e.failed()):!1}function w(o,s){var t,i,r,a;if("number"==typeof s)return!1;if(!e.isPointers(s))return!1;if(n(s)<U)return!1;if(t=e.fetchPointerofObject(se,s),"number"==typeof t)return!1;if(!e.isPointers(t))return!1;if(a=n(t),a>be)return!1;for(r=0;a-1>=r;r++){if(i=e.fetchPointerofObject(r,t),"number"==typeof i)return!1;if(!e.isWords(i))return!1;if(n(i)!==d)return!1;o[r]=i.wordsAsInt32Array()}return!e.failed()}function qe(){var t,e;for(i[s]=0,i[o]=0,t=0;I-1>=t;t++)e=q(),e+=p[A],e=Math.min(e,r),p[A]=e&h,e&=r-h,e=Math.max(e,1),O[t]=4278190080+(e<<16)+(e<<8)+e}function xe(){var e,l,c,t,d,n,m;for(i[s]=0,i[o]=0,u[s]=0,u[o]=0,a[s]=0,a[o]=0,d=0;I-1>=d;d++)m=q(),l=Fe(),l-=f,c=Se(),c-=f,n=m+(oe*c>>16)+p[E],n=Math.min(n,r),n=Math.max(n,0),p[E]=n&h,n&=r-h,n=Math.max(n,1),t=m-(ce*l>>16)-(le*c>>16)+p[A],t=Math.min(t,r),t=Math.max(t,0),p[A]=t&h,t&=r-h,t=Math.max(t,1),e=m+(ae*l>>16)+p[M],e=Math.min(e,r),e=Math.max(e,0),p[M]=e&h,e&=r-h,e=Math.max(e,1),O[d]=4278190080+(n<<16)+(t<<8)+e}function Ve(e){return P(a,e)&&w(J,e)}function we(a,o){var r,t,n,i,s;if(t=ee(W,_),0>t)return e.primitiveFail();for(0!==t&&(r=C(t),t=z(r,t)),t=o[k]=o[k]+t,a[0]=t,n=1;d-1>=n;n++)a[n]=0;for(i=1;d>i;){if(t=ee(B,x),0>t)return e.primitiveFail();if(s=t>>>4,t=15&t,0!==t){if(i+=s,r=C(t),t=z(r,t),0>i||i>=d)return e.primitiveFail();a[Ie[i]]=t}else{if(15!==s)return null;i+=s}++i}}function Ce(){for(var e;16>=l;){if(!(S>c))return l;if(e=j[c],++c,255===e){if(!(S>c&&0===j[c]))return--c,l;++c}m=m<<8|e,l+=8}return l}function C(e){var t;return e>l&&(Ce(),e>l)?-1:(l-=e,t=fe(m,l),m&=V(1,l)-1,t)}function Pe(){return je}function Ae(c,v){var O,A,e,I,F,a,o,k,b,g,y,s,n,i,p,h,u,m,S,l=new Array(64);for(e=0;t-1>=e;e++){for(O=-1,F=1;t-1>=F;F++)-1===O&&0!==c[F*t+e]&&(O=F);if(-1===O)for(A=c[e]*v[0]<<2,I=0;t-1>=I;I++)l[I*t+e]=A;else h=c[2*t+e]*v[2*t+e],u=c[6*t+e]*v[6*t+e],p=(h+u)*R,s=p+u*(0-X),n=p+h*K,h=c[e]*v[e],u=c[4*t+e]*v[4*t+e],a=h+u<<13,o=h-u<<13,k=a+n,y=a-n,b=o+s,g=o-s,a=c[7*t+e]*v[7*t+e],o=c[5*t+e]*v[5*t+e],s=c[3*t+e]*v[3*t+e],n=c[t+e]*v[t+e],p=a+n,h=o+s,u=a+s,m=o+n,S=(u+m)*G,a*=D,o*=Z,s*=$,n*=ne,p*=0-T,h*=0-Q,u*=0-Y,m*=0-L,u+=S,m+=S,a=a+p+u,o=o+h+m,s=s+h+u,n=n+p+m,l[e]=k+n>>11,l[7*t+e]=k-n>>11,l[1*t+e]=b+s>>11,l[6*t+e]=b-s>>11,l[2*t+e]=g+o>>11,l[5*t+e]=g-o>>11,l[3*t+e]=y+a>>11,l[4*t+e]=y-a>>11}for(e=0;d-t>=e;e+=t)h=l[e+2],u=l[e+6],p=(h+u)*R,s=p+u*(0-X),n=p+h*K,a=l[e]+l[e+4]<<13,o=l[e]-l[e+4]<<13,k=a+n,y=a-n,b=o+s,g=o-s,a=l[e+7],o=l[e+5],s=l[e+3],n=l[e+1],p=a+n,h=o+s,u=a+s,m=o+n,S=(u+m)*G,a*=D,o*=Z,s*=$,n*=ne,p*=0-T,h*=0-Q,u*=0-Y,m*=0-L,u+=S,m+=S,a=a+p+u,o=o+h+m,s=s+h+u,n=n+p+m,i=(k+n>>18)+f,i=Math.min(i,r),i=Math.max(i,0),c[e]=i,i=(k-n>>18)+f,i=Math.min(i,r),i=Math.max(i,0),c[e+7]=i,i=(b+s>>18)+f,i=Math.min(i,r),i=Math.max(i,0),c[e+1]=i,i=(b-s>>18)+f,i=Math.min(i,r),i=Math.max(i,0),c[e+6]=i,i=(g+o>>18)+f,i=Math.min(i,r),i=Math.max(i,0),c[e+2]=i,i=(g-o>>18)+f,i=Math.min(i,r),i=Math.max(i,0),c[e+5]=i,i=(y+a>>18)+f,i=Math.min(i,r),i=Math.max(i,0),c[e+3]=i,i=(y-a>>18)+f,i=Math.min(i,r),i=Math.max(i,0),c[e+4]=i}function ee(s,a){var i,e,r,n,t;if(e=s[0]>>>24,e>ie)return-1;for(n=2;;){if(i=C(e),0>i)return-1;if(r=n+i-1,r>=a)return-1;if(t=s[r],0===(1056964608&t))return t;if(n=65535&t,e=t>>>24&255,e>ie)return-1}return-1}function Oe(t){var i,r;return n(t)<5?!1:e.isPointers(t)?(i=e.fetchPointerofObject(0,t),"number"==typeof i?!1:e.isBytes(i)?(j=i.bytes,r=ue(i),c=e.fetchIntegerofObject(1,t),S=e.fetchIntegerofObject(2,t),m=e.fetchIntegerofObject(3,t),l=e.fetchIntegerofObject(4,t),e.failed()?!1:S>r?!1:0>c||c>=S?!1:!0):!1):!1}function Fe(){var a,i,e,t,l,c,r,n;return e=i=u[s],t=u[o],r=u[b],n=u[F],0!==r&&0!==n&&(e=v(e,r),t=v(t,n)),a=(t>>>3)*u[y]+(e>>>3),c=((7&t)<<3)+(7&e),l=re[a][c],++i,i<8*u[g]?u[s]=i:(u[s]=0,u[o]++),l}function Se(){var u,i,e,t,l,c,r,n;return e=i=a[s],t=a[o],r=a[b],n=a[F],0!==r&&0!==n&&(e=v(e,r),t=v(t,n)),u=(t>>>3)*a[y]+(e>>>3),c=((7&t)<<3)+(7&e),l=J[u][c],++i,i<8*a[g]?a[s]=i:(a[s]=0,a[o]++),l}function q(){var u,r,e,t,l,c,n,a;return e=r=i[s],t=i[o],n=i[b],a=i[F],0!==n&&0!==a&&(e=v(e,n),t=v(t,a)),u=(t>>>3)*i[y]+(e>>>3),c=((7&t)<<3)+(7&e),l=N[u][c],++r,r<8*i[g]?i[s]=r:(i[s]=0,i[o]++),l}function ye(){var t;return H(),4!==e.methodArgumentCount()?e.primitiveFail():(h=e.stackIntegerValue(0),t=e.stackObjectValue(1),e.failed()?null:e.isWords(t)&&3===n(t)?(p=t.wordsAsInt32Array(),t=e.stackObjectValue(2),e.failed()?null:e.isWords(t)?(I=n(t),O=t.wordsAsInt32Array(),t=e.stackObjectValue(3),e.failed()?null:te(t)?(qe(),void e.pop(4)):e.primitiveFail()):e.primitiveFail()):e.primitiveFail())}function Me(){var t;return H(),4!==e.methodArgumentCount()?e.primitiveFail():(h=e.stackIntegerValue(0),t=e.stackObjectValue(1),e.failed()?null:e.isWords(t)&&3===n(t)?(p=t.wordsAsInt32Array(),t=e.stackObjectValue(2),e.failed()?null:e.isWords(t)?(I=n(t),O=t.wordsAsInt32Array(),t=e.stackObjectValue(3),e.failed()?null:e.isPointers(t)&&3===n(t)&&te(e.fetchPointerofObject(0,t))&&he(e.fetchPointerofObject(1,t))&&Ve(e.fetchPointerofObject(2,t))?(xe(),void e.pop(4)):e.primitiveFail()):e.primitiveFail()):e.primitiveFail())}function ge(){var s,t,r;return 5!==e.methodArgumentCount()?e.primitiveFail():(r=e.stackObjectValue(0),e.failed()?null:Oe(r)?(t=e.stackObjectValue(1),e.failed()?null:e.isWords(t)?(x=n(t),B=t.wordsAsInt32Array(),t=e.stackObjectValue(2),e.failed()?null:e.isWords(t)?(_=n(t),W=t.wordsAsInt32Array(),r=e.stackObjectValue(3),e.failed()?null:P(i,r)?(t=e.stackObjectValue(4),e.failed()?null:e.isWords(t)?n(t)!==d?e.primitiveFail():(s=t.wordsAsInt32Array(),e.failed()?null:(we(s,i),e.failed()?null:(me(e.stackValue(0)),e.storeIntegerofObjectwithValue(k,e.stackValue(3),i[k]),void e.pop(5)))):e.primitiveFail()):e.primitiveFail()):e.primitiveFail()):e.primitiveFail()):e.primitiveFail())}function ke(){var i,t,r;return 2!==e.methodArgumentCount()?e.primitiveFail():(t=e.stackObjectValue(0),e.failed()?null:e.isWords(t)&&n(t)===d?(r=t.wordsAsInt32Array(),t=e.stackObjectValue(1),e.failed()?null:e.isWords(t)&&n(t)===d?(i=t.wordsAsInt32Array(),Ae(i,r),void e.pop(2)):e.primitiveFail()):e.primitiveFail())}function z(e,t){return e<V(1,t-1)?e-V(1,t)+1:e}function ve(i){var t;return e=i,t=e.majorVersion()==de,t===!1?!1:t=e.minorVersion()>=pe}function H(){}function me(t){e.storeIntegerofObjectwithValue(1,t,c),e.storeIntegerofObjectwithValue(3,t,m),e.storeIntegerofObjectwithValue(4,t,l)}function te(e){return P(i,e)&&w(N,e)}var de=1,pe=11,y=5,M=2,s=0,o=1,t=8,d=64,D=2446,ce=22554,L=3196,R=4433,le=46802,K=6270,T=7373,G=9633,oe=91881,ne=12299,ae=116130,X=15137,Y=16069,Z=16819,Q=20995,$=25172,A=1,b=2,se=4,g=8,ie=16,be=128,r=255,U=11,k=10,E=0,f=127,F=3,B=null,x=0,re=new Array(128),u=new Array(11),J=new Array(128),a=new Array(11),W=null,_=0,h=0,e=null,O=null,I=0,Ie=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63],m=0,l=0,j=null,c=0,S=0,je="JPEGReaderPlugin 3 November 2014 (e)",p=null,N=new Array(128),i=new Array(11);Squeak.registerExternalModule("JPEGReaderPlugin",{setInterpreter:ve,primitiveIdctInt:ke,primitiveColorConvertMCU:Me,primitiveColorConvertGrayscaleMCU:ye,primitiveDecodeMCU:ge,getModuleName:Pe})}),module("users.bert.SqueakJS.plugins.KedamaPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function t(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function a(e,t){return 0|Math.floor(e/t)}function h(e,t){return e-a(e,t)*t|0}function re(t,e){return 0>e?-31>e?0:t>>>0-e:e>31?0:t<<e}function c(t,i){var r,e;return 0===t?i>=0?90:270:(r=i/t,e=Math.atan(r),t>=0?i>=0?e/.0174532925199433:360+e/.0174532925199433:180+e/.0174532925199433)}function o(i){var e,r,t;return e=90-i,t=e/360|0,0>e&&--t,r=.0174532925199433*(e-360*t)}function ie(){var d,v,o,p,h,s,a,i,r,b,k,l,c,m,n,f,g,u;if(l=e.stackValue(0),o=e.stackValue(1),u=e.stackValue(2),n=e.stackValue(3),h=e.stackIntegerValue(4),a=e.stackIntegerValue(5),s=e.stackValue(6),e.failed())return null;if(!e.isWords(s))return e.primitiveFail(),null;if(!e.isWords(n))return e.primitiveFail(),null;if(!e.isWords(u))return e.primitiveFail(),null;if(!e.isWords(o))return e.primitiveFail(),null;if(!e.isBytes(l))return e.primitiveFail(),null;if(h*a!==t(s))return e.primitiveFail(),null;if(r=t(n),t(u)!==r)return e.primitiveFail(),null;if(t(o)!==r)return e.primitiveFail(),null;if(t(l)!==r)return e.primitiveFail(),null;for(m=n.wordsAsFloat32Array(),g=u.wordsAsFloat32Array(),v=o.words,k=l.bytes,p=s.words,i=0;r-1>=i;i++)c=0|m[i],f=0|g[i],b=k[i],0!==b&&c>=0&&f>=0&&a>c&&h>f&&(d=f*a+c,p[d]=v[i]);return e.failed()?null:void e.pop(7)}function te(){var i,o,n,r,u,s,a;if(s=e.stackValue(0),n=e.stackValue(1),e.failed())return null;if(!e.isWords(n))return e.primitiveFail(),null;if(!e.isWords(s))return e.primitiveFail(),null;if(a=t(n),t(s)!==a)return e.primitiveFail(),null;for(o=n.wordsAsFloat32Array(),u=s.wordsAsFloat32Array(),r=0;a-1>=r;r++)i=o[r],i/=.0174532925199433,i=90-i,i>0||(i+=360),u[r]=i;return e.failed()?null:void e.pop(2)}function $(){return ee}function Q(){var i,s,r,n;return r=e.stackValue(0),n=e.stackIntegerValue(1),e.failed()?null:e.isWords(r)?t(r)<n?(e.primitiveFail(),null):(s=r.wordsAsFloat32Array(),i=s[n-1],i=p(i),e.failed()?null:(e.pop(3),void e.pushFloat(i))):(e.primitiveFail(),null)}function D(){i=17,r=16807,u=2147483647,l=a(u,r),d=h(u,r)}function f(e){var n,s,o,u,t;return o=0>e?0-e:e,n=a(i,l),s=h(i,l),i=r*s-d*n,u=65535&i,t=u*(o+1)>>>16,0>e?0-t:t}function m(){var t;return t=e.stackIntegerValue(0),e.failed()?null:(i=65536&t,void e.pop(1))}function x(){var i,c,u,s,a,l,r,f,o,h,p,n;if(n=e.stackIntegerValue(0),p=e.stackIntegerValue(1),o=e.stackValue(2),s=e.stackValue(3),e.failed())return null;if(a=t(s),h=t(o),a!==h)return e.primitiveFail(),null;if(-32>n)return e.primitiveFail(),null;if(n>8)return e.primitiveFail(),null;for(c=s.words,f=o.words,l=4278190080,r=0;a-1>=r;r++)u=c[r],i=re(u,n),i>255&&(i=255),0>i&&(i=0),f[r]=i<<24&l|p;e.pop(4)}function V(){var r,l,n,s,a,c,i,v,o,f,h,p,d,m,u;if(m=e.stackValue(0),u=e.stackIntegerValue(1),o=e.stackValue(2),s=e.stackValue(3),e.failed())return null;if(p=m.words,h=p[0],e.failed())return null;if(d=Math.log(h),a=t(s),f=t(o),a!==f)return e.primitiveFail(),null;for(l=s.words,v=o.words,c=4278190080,i=0;a-1>=i;i++)n=l[i],r=0===n?0:255/d*Math.log(n)|0,r>255&&(r=255),v[i]=r<<24&c|u;e.pop(4)}function v(){var u,i,f,s,a,o,h,n,r,p,d,l,m,v,c;if(u=e.stackIntegerValue(0),r=e.stackIntegerValue(1),c=e.stackValue(2),l=e.stackValue(3),n=e.stackValue(4),a=e.stackValue(5),!e.isWords(c))return e.primitiveFail(),null;if(!e.isWords(l))return e.primitiveFail(),null;if(!e.isWords(n))return e.primitiveFail(),null;if(!e.isWords(a))return e.primitiveFail(),null;if(o=t(n),t(l)!==o)return e.primitiveFail(),null;if(t(c)!==o)return e.primitiveFail(),null;if(t(a)!==u*r)return e.primitiveFail(),null;for(d=l.wordsAsFloat32Array(),v=c.wordsAsFloat32Array(),h=n.words,f=a.words,i=0;u*r-1>=i;i++)f[i]=0;for(i=0;o-1>=i;i++)p=d[i],m=v[i],s=r*m+p,s>=0&&u*r>s&&(f[s]=h[i]);return e.failed()?null:void e.pop(6)}function W(){var u,i,a,l,o,r,n,c,s,f;return a=e.stackIntegerValue(0),r=e.stackIntegerValue(1),f=e.stackFloatValue(2),c=e.stackFloatValue(3),i=e.stackValue(4),e.failed()?null:e.isWords(i)?t(i)!==a*r?(e.primitiveFail(),null):(n=0|c,s=0|f,u=i.words,n>=0&&r>n&&s>=0&&a>s?(l=s*r+n,o=u[l]):o=0,e.failed()?null:(e.pop(6),void e.pushInteger(o))):(e.primitiveFail(),null)}function k(){var f,r,o,l,i,u,n,s,c,a,h;return o=e.stackIntegerValue(0),n=e.stackIntegerValue(1),u=e.stackIntegerValue(2),h=e.stackFloatValue(3),c=e.stackFloatValue(4),r=e.stackValue(5),e.failed()?null:e.isWords(r)?t(r)!==o*n?(e.primitiveFail(),null):(s=0|c,a=0|h,i=u,i>1073741823&&(i=1073741823),0>i&&(i=0),f=r.words,s>=0&&n>s&&a>=0&&o>a&&(l=a*n+s,f[l]=i),e.failed()?null:void e.pop(6)):(e.primitiveFail(),null)}function g(){var v,f,d,s,a,p,u,i,c,l,h,o,n,m,r;if(u=e.stackValue(0),f=e.stackIntegerValue(1),a=e.stackIntegerValue(2),s=e.stackValue(3),r=e.stackValue(4),o=e.stackValue(5),e.failed())return null;if(!e.isWords(u))return e.primitiveFail(),null;if(!e.isWords(o))return e.primitiveFail(),null;if(!e.isWords(r))return e.primitiveFail(),null;if(!e.isWords(s))return e.primitiveFail(),null;if(f*a!==t(s))return e.primitiveFail(),null;if(c=t(o),t(r)!==c)return e.primitiveFail(),null;if(t(u)!==c)return e.primitiveFail(),null;for(h=o.wordsAsFloat32Array(),m=r.wordsAsFloat32Array(),p=u.words,v=s.words,i=0;c-1>=i;i++)l=0|h[i],n=0|m[i],l>=0&&n>=0&&a>l&&f>n&&(d=n*a+l,p[i]=v[d]);return e.failed()?null:void e.pop(6)}function b(){var v,p,b,l,r,o,i,y,S,F,d,m,c,k,g,f,u,h,a;return v=e.stackIntegerValue(0),k=e.stackIntegerValue(1),m=e.stackIntegerValue(2),S=e.stackIntegerValue(3),p=e.stackFloatValue(4),b=e.stackFloatValue(5),g=e.stackFloatValue(6),o=e.stackValue(7),a=e.stackValue(8),u=e.stackValue(9),y=e.stackIntegerValue(10),e.failed()?null:e.isWords(u)&&e.isWords(a)&&e.isWords(o)?(c=t(u),t(a)!==c?(e.primitiveFail(),null):t(o)!==c?(e.primitiveFail(),null):(f=u.wordsAsFloat32Array(),h=a.wordsAsFloat32Array(),r=o.wordsAsFloat32Array(),l=g,i=y-1,F=f[i]+l*Math.cos(r[i]),d=h[i]-l*Math.sin(r[i]),s(i,f,r,F,b,S,m),n(i,h,r,d,p,k,v),e.failed()?null:void e.pop(11))):(e.primitiveFail(),null)}function y(){var b,p,k,o,u,i,v,r,c,h,n,d,f,m,l,a,g,s;if(n=e.stackValue(0),p=e.stackIntegerValue(1),u=e.stackIntegerValue(2),o=e.stackValue(3),s=e.stackValue(4),l=e.stackValue(5),e.failed())return null;if(!e.isWords(l))return e.primitiveFail(),null;if(!e.isWords(s))return e.primitiveFail(),null;if(!e.isWords(o))return e.primitiveFail(),null;if(p*u!==t(o))return e.primitiveFail(),null;if(c=t(l),t(s)!==c)return e.primitiveFail(),null;if(r="number"==typeof n,r&&(v=n),!r){if(!e.isMemberOf(n,"WordArray"))return e.primitiveFail(),null;if(t(n)!==c)return e.primitiveFail(),null}for(m=l.wordsAsFloat32Array(),g=s.wordsAsFloat32Array(),r||(d=n.words),b=o.words,r&&(h=v),i=0;c-1>=i;i++)f=0|m[i],a=0|g[i],f>=0&&a>=0&&u>f&&p>a&&(k=a*u+f,r||(h=d[i]),b[k]=h);return e.failed()?null:void e.pop(6)}function S(){var y,O,v,p,o,c,i,a,S,F,I,m,u,k,g,b,r,h,l,d,f;if(y=e.stackIntegerValue(0),k=e.stackIntegerValue(1),m=e.stackIntegerValue(2),S=e.stackIntegerValue(3),O=e.stackFloatValue(4),v=e.stackFloatValue(5),r=e.stackValue(6),c=e.stackValue(7),f=e.stackValue(8),l=e.stackValue(9),e.failed())return null;if(!e.isWords(l))return e.primitiveFail(),null;if(!e.isWords(f))return e.primitiveFail(),null;if(!e.isWords(c))return e.primitiveFail(),null;if(r.isFloat)a=!1;else{if(!e.isWords(r))return e.primitiveFail(),null;a=!0}if(u=t(l),t(f)!==u)return e.primitiveFail(),null;if(t(c)!==u)return e.primitiveFail(),null;if(a&&t(r)!==u)return e.primitiveFail(),null;for(h=l.wordsAsFloat32Array(),d=f.wordsAsFloat32Array(),o=c.wordsAsFloat32Array(),a?b=r.wordsAsFloat32Array():g=e.floatValueOf(r),i=0;u-1>=i;i++)p=a?b[i]:g,F=h[i]+p*Math.cos(o[i]),I=d[i]-p*Math.sin(o[i]),s(i,h,o,F,v,S,m),n(i,d,o,I,O,k,y);return e.failed()?null:void e.pop(10)}function F(){var m,f,I,O,u,d,l,F,S,y,o,A,v,k,g,b,h,r,i,n,a,s;if(o=e.stackIntegerValue(0),u=e.stackIntegerValue(1),n=e.stackIntegerValue(2),f=e.stackValue(3),k=e.stackFloatValue(4),b=e.stackFloatValue(5),g=e.stackFloatValue(6),e.failed())return null;if(!e.isWords(f))return e.primitiveFail(),null;if(t(f)!==u*n)return e.primitiveFail(),null;for(m=f.words,r=g,i=b,r=Math.max(r,0),i=Math.max(i,0),r=Math.min(r,n-1),i=Math.min(i,u-1),A=Math.max(r-o,0),I=Math.min(r+o,n-1),v=Math.max(i-o,0),O=Math.min(i+o,u-1),d=m[i*n+r],l=-1,s=v;O>=s;s++)for(y=s*n,a=A;I>=a;a++)h=m[y+a],h>d&&(l=a,F=s,d=h);return S=-1===l?p(k):c(l-r,F-i)+90|0,e.failed()?null:(e.pop(8),void e.pushFloat(S))}function O(){var n,h,c,o,i,l,p,a,s,r,f,u,d;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(s)),e.success(e.isWords(r)),e.failed())return null;if(a=t(n),e.success(a===t(s)),e.success(a===t(r)),e.failed())return null;if(l=e.isMemberOf(n,"WordArray"),p=e.isMemberOf(s,"WordArray"),l&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(l)for(u=s.words,f=n.words,d=r.words,i=0;a-1>=i;i++)d[i]=u[i]+f[i];else for(u=s.words,h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=u[i]+h[i];else if(l)for(c=s.wordsAsFloat32Array(),f=n.words,o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]+f[i];else for(c=s.wordsAsFloat32Array(),h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]+h[i];e.pop(4),e.push(r)}function I(){var s,u,f,a,i,h,c,p,o,n,r,l,d;if(r=e.stackObjectValue(0),s=e.stackValue(1),n=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(r)),e.failed())return null;if(o=t(n),e.success(o===t(r)),e.failed())return null;if(c="number"==typeof s,p=e.isMemberOf(n,"WordArray"),c&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(c)for(l=n.words,h=s,d=r.words,i=0;o-1>=i;i++)d[i]=l[i]+h;else for(l=n.words,u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=l[i]+u;else if(c)for(f=n.wordsAsFloat32Array(),h=s,a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]+h;else for(f=n.wordsAsFloat32Array(),u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]+u;e.pop(4),e.push(r)}function A(){var n,h,c,o,i,l,p,a,s,r,f,u,d;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(s)),e.success(e.isWords(r)),e.failed())return null;if(a=t(n),e.success(a===t(s)),e.success(a===t(r)),e.failed())return null;if(l=e.isMemberOf(n,"WordArray"),p=e.isMemberOf(s,"WordArray"),l&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(l)for(u=s.words,f=n.words,d=r.words,i=0;a-1>=i;i++)d[i]=u[i]/f[i];else for(u=s.words,h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=u[i]/h[i];else if(l)for(c=s.wordsAsFloat32Array(),f=n.words,o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]/f[i];else for(c=s.wordsAsFloat32Array(),h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]/h[i];e.pop(4),e.push(r)}function P(){var s,l,h,o,i,p,f,d,u,n,r,c,m;if(r=e.stackObjectValue(0),s=e.stackValue(1),n=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(r)),e.failed())return null;if(u=t(n),e.success(u===t(r)),e.failed())return null;if(f="number"==typeof s,d=e.isMemberOf(n,"WordArray"),f&&d){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(d)if(f)for(c=n.words,p=s,m=r.words,i=0;u-1>=i;i++)m[i]=a(c[i],p);else for(c=n.words,l=e.floatValueOf(s),o=r.wordsAsFloat32Array(),i=0;u-1>=i;i++)o[i]=c[i]/l;else if(f)for(h=n.wordsAsFloat32Array(),p=s,o=r.wordsAsFloat32Array(),i=0;u-1>=i;i++)o[i]=h[i]/p;else for(h=n.wordsAsFloat32Array(),l=e.floatValueOf(s),o=r.wordsAsFloat32Array(),i=0;u-1>=i;i++)o[i]=h[i]/l;e.pop(4),e.push(r)}function C(){var n,h,c,o,i,l,p,a,s,r,f,u,d;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(s)),e.success(e.isWords(r)),e.failed())return null;if(a=t(n),e.success(a===t(s)),e.success(a===t(r)),e.failed())return null;if(l=e.isMemberOf(n,"WordArray"),p=e.isMemberOf(s,"WordArray"),l&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(l)for(u=s.words,f=n.words,d=r.words,i=0;a-1>=i;i++)d[i]=u[i]*f[i];else for(u=s.words,h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=u[i]*h[i];else if(l)for(c=s.wordsAsFloat32Array(),f=n.words,o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]*f[i];else for(c=s.wordsAsFloat32Array(),h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]*h[i];e.pop(4),e.push(r)}function w(){var s,u,f,a,i,h,c,p,o,n,r,l,d;if(r=e.stackObjectValue(0),s=e.stackValue(1),n=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(r)),e.failed())return null;if(o=t(n),e.success(o===t(r)),e.failed())return null;if(c="number"==typeof s,p=e.isMemberOf(n,"WordArray"),c&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(c)for(l=n.words,h=s,d=r.words,i=0;o-1>=i;i++)d[i]=l[i]*h;else for(l=n.words,u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=l[i]*u;else if(c)for(f=n.wordsAsFloat32Array(),h=s,a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]*h;else for(f=n.wordsAsFloat32Array(),u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]*u;e.pop(4),e.push(r)}function ne(){var n,h,c,o,i,l,p,a,s,r,f,u,d;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(s)),e.success(e.isWords(r)),e.failed())return null;if(a=t(n),e.success(a===t(s)),e.success(a===t(r)),e.failed())return null;if(l=e.isMemberOf(n,"WordArray"),p=e.isMemberOf(s,"WordArray"),l&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(l)for(u=s.words,f=n.words,d=r.words,i=0;a-1>=i;i++)d[i]=u[i]-f[i];else for(u=s.words,h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=u[i]-h[i];else if(l)for(c=s.wordsAsFloat32Array(),f=n.words,o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]-f[i];else for(c=s.wordsAsFloat32Array(),h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]-h[i];e.pop(4),e.push(r)}function j(){var s,u,f,a,i,h,c,p,o,n,r,l,d;if(r=e.stackObjectValue(0),s=e.stackValue(1),n=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(r)),e.failed())return null;if(o=t(n),e.success(o===t(r)),e.failed())return null;if(c="number"==typeof s,p=e.isMemberOf(n,"WordArray"),c&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(c)for(l=n.words,h=s,d=r.words,i=0;o-1>=i;i++)d[i]=l[i]-h;else for(l=n.words,u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=l[i]-u;else if(c)for(f=n.wordsAsFloat32Array(),h=s,a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]-h;else for(f=n.wordsAsFloat32Array(),u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]-u;e.pop(4),e.push(r)}function p(i){var e,t;return t=i/.0174532925199433,e=90-t,e>0||(e+=360),e}function q(){var a,o,i,r,n,u,l,s;if(a=e.stackFloatValue(0),i=e.stackValue(1),s=e.stackIntegerValue(2),r=e.stackIntegerValue(3),u=e.stackIntegerValue(4),e.failed())return null;if(!e.isWords(i))return e.primitiveFail(),null;if(l=t(i),!(l>=s&&r>=1&&s>=r))return e.primitiveFail(),null;if(o=i.wordsAsFloat32Array(),e.failed())return null;for(n=r;s>=n;n++)o[n-1]=f(u)*a;e.pop(5)}function M(){var a,i,r,o,n,u,l,s;if(a=e.stackFloatValue(0),n=e.stackValue(1),s=e.stackIntegerValue(2),i=e.stackIntegerValue(3),u=e.stackIntegerValue(4),e.failed())return null;if(!e.isWords(n))return e.primitiveFail(),null;if(l=t(n),
!(l>=s&&i>=1&&s>=i))return e.primitiveFail(),null;if(o=n.words,e.failed())return null;for(r=i;s>=r;r++)o[r-1]=f(u)*a|0;e.pop(5)}function B(){var t,i;return t=e.stackIntegerValue(0),e.failed()?null:(i=f(t),e.failed()?null:(e.pop(2),void e.pushInteger(i)))}function N(){var i,r,t,n,s,a,o;return r=e.stackFloatValue(0),i=e.stackFloatValue(1),s=e.stackFloatValue(2),n=e.stackFloatValue(3),e.failed()?null:(a=n-i,o=s-r,t=c(a,o),t+=90,t>360&&(t-=360),e.failed()?null:(e.pop(5),void e.pushFloat(t)))}function _(){var r,n,s,a,o,t,i;return n=e.stackFloatValue(0),r=e.stackFloatValue(1),o=e.stackFloatValue(2),a=e.stackFloatValue(3),e.failed()?null:(t=r-a,i=n-o,s=Math.sqrt(t*t+i*i),e.failed()?null:(e.pop(5),void e.pushFloat(s)))}function s(i,o,r,u,n,s,a){var t,e;e=u,0>e&&(1===s&&(e+=n),2===s&&(e=0),3===s&&(e=0-e,t=r[i],3.141592653589793>t?r[i]=3.141592653589793-t:r[i]=9.42477796076938-t)),e>=n&&(1===a&&(e-=n),2===a&&(e=n-1e-6),3===a&&(e=n-1e-6-(e-n),t=r[i],3.141592653589793>t?r[i]=3.141592653589793-t:r[i]=9.42477796076938-t)),o[i]=e}function n(i,a,r,o,t,n,s){var e;e=o,0>e&&(1===n&&(e+=t),2===n&&(e=0),3===n&&(e=0-e,r[i]=6.283185307179586-r[i])),e>=t&&(1===s&&(e-=t),2===s&&(e=t-1e-6),3===s&&(e=t-1e-6-(e-t),r[i]=6.283185307179586-r[i])),a[i]=e}function T(){var i,l,s,n,a,c,r,u;if(r=e.stackValue(0),s=e.stackValue(1),e.failed())return null;if(!e.isWords(s))return e.primitiveFail(),null;if(u=t(s),r.isFloat)a=!1;else{if(!e.isWords(r))return e.primitiveFail(),null;if(t(r)!==u)return e.primitiveFail(),null;a=!0}for(l=s.wordsAsFloat32Array(),a?c=r.wordsAsFloat32Array():(i=e.floatValueOf(r),i=o(i)),n=0;u-1>=n;n++)a&&(i=c[n],i=o(i)),l[n]=i;return e.failed()?null:void e.pop(2)}function L(i){var t;return e=i,t=e.majorVersion()==Y,t===!1?!1:t=e.minorVersion()>=Z}function R(){var n,s,i,r;return n=e.stackFloatValue(0),i=e.stackValue(1),r=e.stackIntegerValue(2),e.failed()?null:e.isWords(i)?t(i)<r?(e.primitiveFail(),null):(s=i.wordsAsFloat32Array(),s[r-1]=o(n),e.failed()?null:void e.pop(3)):(e.primitiveFail(),null)}function E(){return!0}function K(){var n,a,i,o,u,l,c,f,h,r;return u=e.stackIntegerValue(0),o=e.stackIntegerValue(1),n=e.stackFloatValue(2),c=e.stackFloatValue(3),i=e.stackValue(4),h=e.stackIntegerValue(5),r=e.stackValue(6),e.failed()?null:e.isWords(r)&&e.isWords(i)?(l=t(r),t(i)!==l?(e.primitiveFail(),null):(f=r.wordsAsFloat32Array(),a=i.wordsAsFloat32Array(),s(h-1,f,a,c,n,o,u),e.failed()?null:void e.pop(7))):(e.primitiveFail(),null)}function z(){var s,a,o,i,u,l,c,f,h,r;return s=e.stackIntegerValue(0),l=e.stackIntegerValue(1),a=e.stackFloatValue(2),c=e.stackFloatValue(3),i=e.stackValue(4),h=e.stackIntegerValue(5),r=e.stackValue(6),e.failed()?null:e.isWords(r)&&e.isWords(i)?(u=t(r),t(i)!==u?(e.primitiveFail(),null):(f=r.wordsAsFloat32Array(),o=i.wordsAsFloat32Array(),n(h-1,f,o,c,a,l,s),e.failed()?null:void e.pop(7))):(e.primitiveFail(),null)}function G(){var f,c,o,r,n,d,l,v,u,h,p,i,m,a;if(v=e.stackIntegerValue(0),d=e.stackIntegerValue(1),f=e.stackFloatValue(2),i=e.stackValue(3),o=e.stackValue(4),a=e.stackValue(5),e.failed())return null;if(!e.isWords(a))return e.primitiveFail(),null;if(!e.isWords(o))return e.primitiveFail(),null;if(i.isFloat)n=!1;else{if(!e.isWords(i))return e.primitiveFail(),null;n=!0}if(u=t(a),t(o)!==u)return e.primitiveFail(),null;if(n&&t(i)!==u)return e.primitiveFail(),null;for(m=a.wordsAsFloat32Array(),c=o.wordsAsFloat32Array(),n?p=i.wordsAsFloat32Array():h=e.floatValueOf(i),r=0;u-1>=r;r++)l=n?p[r]:h,s(r,m,c,l,f,d,v);return e.failed()?null:void e.pop(6)}function U(){var v,c,d,u,r,s,l,a,f,h,p,i,m,o;if(v=e.stackIntegerValue(0),f=e.stackIntegerValue(1),c=e.stackFloatValue(2),i=e.stackValue(3),u=e.stackValue(4),o=e.stackValue(5),e.failed())return null;if(!e.isWords(o))return e.primitiveFail(),null;if(!e.isWords(u))return e.primitiveFail(),null;if(i.isFloat)s=!1;else{if(!e.isWords(i))return e.primitiveFail(),null;s=!0}if(a=t(o),t(u)!==a)return e.primitiveFail(),null;if(s&&t(i)!==a)return e.primitiveFail(),null;for(m=o.wordsAsFloat32Array(),d=u.wordsAsFloat32Array(),s?p=i.wordsAsFloat32Array():h=e.floatValueOf(i),r=0;a-1>=r;r++)l=s?p[r]:h,n(r,m,d,l,c,f,v);return e.failed()?null:void e.pop(6)}function J(){var i,s,k,a,d,n,p,h,u,y,o,r,m,v,f,g,b,l;if(o=e.stackValue(0),l=e.stackValue(1),f=e.stackValue(2),n=e.stackValue(3),a=e.stackValue(4),e.failed())return null;if(!e.isWords(o))return e.primitiveFail(),null;if(!e.isWords(f))return e.primitiveFail(),null;if(!e.isWords(l))return e.primitiveFail(),null;if(r=t(o),0>r)return e.primitiveFail(),null;if(t(f)!==r)return e.primitiveFail(),null;if(t(l)!==r)return e.primitiveFail(),null;if(a.isFloat){if(!n.isFloat)return e.primitiveFail(),null;s=!1}else{if(n.isFloat)return e.primitiveFail(),null;s=!0}if(s){if(t(a)!==r)return e.primitiveFail(),null;if(t(n)!==r)return e.primitiveFail(),null}for(y=o.wordsAsFloat32Array(),v=f.wordsAsFloat32Array(),b=l.wordsAsFloat32Array(),s&&(k=a.wordsAsFloat32Array(),d=n.wordsAsFloat32Array()),s||(p=e.floatValueOf(a),h=e.floatValueOf(n)),i=0;r-1>=i;i++)s&&(p=k[i],h=d[i]),m=p-v[i],g=h-b[i],u=c(m,g),u+=90,u>360&&(u-=360),y[i]=u;return e.failed()?null:(e.pop(6),void e.push(o))}function H(){var i,s,v,a,d,n,f,c,g,o,r,h,m,u,p,k,l;if(o=e.stackValue(0),l=e.stackValue(1),u=e.stackValue(2),n=e.stackValue(3),a=e.stackValue(4),e.failed())return null;if(!e.isWords(o))return e.primitiveFail(),null;if(!e.isWords(u))return e.primitiveFail(),null;if(!e.isWords(l))return e.primitiveFail(),null;if(r=t(o),0>r)return e.primitiveFail(),null;if(t(u)!==r)return e.primitiveFail(),null;if(t(l)!==r)return e.primitiveFail(),null;if(a.isFloat){if(!n.isFloat)return e.primitiveFail(),null;s=!1}else{if(n.isFloat)return e.primitiveFail(),null;s=!0}if(s){if(t(a)!==r)return e.primitiveFail(),null;if(t(n)!==r)return e.primitiveFail(),null}for(g=o.wordsAsFloat32Array(),m=u.wordsAsFloat32Array(),k=l.wordsAsFloat32Array(),s&&(v=a.wordsAsFloat32Array(),d=n.wordsAsFloat32Array()),s||(f=e.floatValueOf(a),c=e.floatValueOf(n)),i=0;r-1>=i;i++)s&&(f=v[i],c=d[i]),h=f-m[i],p=c-k[i],g[i]=Math.sqrt(h*h+p*p);return e.failed()?null:(e.pop(6),void e.push(o))}function X(){var b,v,h,p,g,o,u,k,r,s,i,n,d,m,f,l,a,c;if(c=e.stackIntegerValue(0),l=e.stackIntegerValue(1),u=e.stackIntegerValue(2),r=e.stackIntegerValue(3),h=e.stackValue(4),s=e.stackValue(5),e.failed())return null;if(d=t(s),g=t(h),r*u!==d)return e.primitiveFail(),null;if(d*l*c!==g)return e.primitiveFail(),null;for(k=s.words,v=h.words,i=0,n=0,p=0,f=0;u-1>=f;f++){for(a=0;c-1>=a;a++){for(m=0;r-1>=m;m++)for(b=k[i],++i,o=0;l-1>=o;o++)v[p]=b,++p;i=n}n+=r,i=n}e.pop(6)}var Y=1,Z=11,e=null,i=0,ee="KedamaPlugin 3 November 2014 (e)",r=0,u=0,l=0,d=0;Squeak.registerExternalModule("KedamaPlugin",{makeMaskLog:V,vectorGetDistanceTo:H,getScalarHeading:Q,shutdownModule:E,primitiveAddScalar:I,primSetPixelsAtXY:y,turtleScalarSetX:K,primPixelAtXY:W,primUpHill:F,primScalarForward:b,primitiveDivArrays:A,getModuleName:$,primitiveSubArrays:ne,scalarGetAngleTo:N,randomRange:B,setInterpreter:L,kedamaSetRandomSeed:m,drawTurtlesInArray:ie,turtleScalarSetY:z,randomIntoIntegerArray:M,getHeadingArrayInto:te,makeTurtlesMap:v,setHeadingArrayFrom:T,turtlesSetX:G,setScalarHeading:R,makeMask:x,primitiveDivScalar:P,primitiveSubScalar:j,primPixelsAtXY:g,vectorGetAngleTo:J,primitiveMulArrays:C,primPixelAtXYPut:k,zoomBitmap:X,initialiseModule:D,primitiveAddArrays:O,scalarGetDistanceTo:_,turtlesSetY:U,randomIntoFloatArray:q,primTurtlesForward:S,primitiveMulScalar:w})}),module("users.bert.SqueakJS.plugins.KedamaPlugin2").requires("users.bert.SqueakJS.vm").toRun(function(){function t(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function n(e,t){return 0|Math.floor(e/t)}function a(e,t){return e-n(e,t)*t|0}function Pe(t,e){return 0>e?-31>e?0:t>>>0-e:e>31?0:t<<e}function c(t,i){var r,e;return 0===t?i>=0?90:270:(r=i/t,e=Math.atan(r),t>=0?i>=0?e/.0174532925199433:360+e/.0174532925199433:180+e/.0174532925199433)}function l(i){var e,r,t;return e=90-i,t=e/360|0,0>e&&--t,r=.0174532925199433*(e-360*t)}function Ae(){var d,v,o,p,h,s,a,i,r,b,k,l,c,m,n,f,g,u;if(l=e.stackValue(0),o=e.stackValue(1),u=e.stackValue(2),n=e.stackValue(3),h=e.stackIntegerValue(4),a=e.stackIntegerValue(5),s=e.stackValue(6),e.failed())return null;if(!e.isWords(s))return e.primitiveFail(),null;if(!e.isWords(n))return e.primitiveFail(),null;if(!e.isWords(u))return e.primitiveFail(),null;if(!e.isWords(o))return e.primitiveFail(),null;if(!e.isBytes(l))return e.primitiveFail(),null;if(h*a!==t(s))return e.primitiveFail(),null;if(r=t(n),t(u)!==r)return e.primitiveFail(),null;if(t(o)!==r)return e.primitiveFail(),null;if(t(l)!==r)return e.primitiveFail(),null;for(m=n.wordsAsFloat32Array(),g=u.wordsAsFloat32Array(),v=o.words,k=l.bytes,p=s.words,i=0;r-1>=i;i++)c=0|m[i],f=0|g[i],b=k[i],0!==b&&c>=0&&f>=0&&a>c&&h>f&&(d=f*a+c,p[d]=v[i]);return e.failed()?null:void e.pop(7)}function Ie(){var i,o,n,r,u,s,a;if(s=e.stackValue(0),n=e.stackValue(1),e.failed())return null;if(!e.isWords(n))return e.primitiveFail(),null;if(!e.isWords(s))return e.primitiveFail(),null;if(a=t(n),t(s)!==a)return e.primitiveFail(),null;for(o=n.wordsAsFloat32Array(),u=s.wordsAsFloat32Array(),r=0;a-1>=r;r++)i=o[r],i/=.0174532925199433,i=90-i,i>0||(i+=360),u[r]=i;return e.failed()?null:void e.pop(2)}function Fe(){return Oe}function Se(){var i,s,r,n;return r=e.stackValue(0),n=e.stackIntegerValue(1),e.failed()?null:e.isWords(r)?t(r)<n?(e.primitiveFail(),null):(s=r.wordsAsFloat32Array(),i=s[n-1],i=p(i),e.failed()?null:(e.pop(3),void e.pushFloat(i))):(e.primitiveFail(),null)}function oe(){i=17,o=16807,u=2147483647,h=n(u,o),d=a(u,o)}function f(e){var r,s,u,l,t;return u=0>e?0-e:e,r=n(i,h),s=a(i,h),i=o*s-d*r,l=65535&i,t=l*(u+1)>>>16,0>e?0-t:t}function ae(){var t;return t=e.stackIntegerValue(0),e.failed()?null:(i=65536&t,void e.pop(1))}function ee(){var i,c,u,s,a,l,r,f,o,h,p,n;if(n=e.stackIntegerValue(0),p=e.stackIntegerValue(1),o=e.stackValue(2),s=e.stackValue(3),e.failed())return null;if(a=t(s),h=t(o),a!==h)return e.primitiveFail(),null;if(-32>n)return e.primitiveFail(),null;if(n>8)return e.primitiveFail(),null;for(c=s.words,f=o.words,l=4278190080,r=0;a-1>=r;r++)u=c[r],i=Pe(u,n),i>255&&(i=255),0>i&&(i=0),f[r]=i<<24&l|p;e.pop(4)}function R(){var r,l,n,s,a,c,i,v,o,f,h,p,d,m,u;if(m=e.stackValue(0),u=e.stackIntegerValue(1),o=e.stackValue(2),s=e.stackValue(3),e.failed())return null;if(p=m.words,h=p[0],e.failed())return null;if(d=Math.log(h),a=t(s),f=t(o),a!==f)return e.primitiveFail(),null;for(l=s.words,v=o.words,c=4278190080,i=0;a-1>=i;i++)n=l[i],r=0===n?0:255/d*Math.log(n)|0,r>255&&(r=255),v[i]=r<<24&c|u;e.pop(4)}function v(){var u,i,f,s,a,o,h,n,r,p,d,l,m,v,c;if(u=e.stackIntegerValue(0),r=e.stackIntegerValue(1),c=e.stackValue(2),l=e.stackValue(3),n=e.stackValue(4),a=e.stackValue(5),!e.isWords(c))return e.primitiveFail(),null;if(!e.isWords(l))return e.primitiveFail(),null;if(!e.isWords(n))return e.primitiveFail(),null;if(!e.isWords(a))return e.primitiveFail(),null;if(o=t(n),t(l)!==o)return e.primitiveFail(),null;if(t(c)!==o)return e.primitiveFail(),null;if(t(a)!==u*r)return e.primitiveFail(),null;for(d=l.wordsAsFloat32Array(),v=c.wordsAsFloat32Array(),h=n.words,f=a.words,i=0;u*r-1>=i;i++)f[i]=0;for(i=0;o-1>=i;i++)p=d[i],m=v[i],s=r*m+p,s>=0&&u*r>s&&(f[s]=h[i]);return e.failed()?null:void e.pop(6)}function H(){var u,i,a,l,o,r,n,c,s,f;return a=e.stackIntegerValue(0),r=e.stackIntegerValue(1),f=e.stackFloatValue(2),c=e.stackFloatValue(3),i=e.stackValue(4),e.failed()?null:e.isWords(i)?t(i)!==a*r?(e.primitiveFail(),null):(n=0|c,s=0|f,u=i.words,n>=0&&r>n&&s>=0&&a>s?(l=s*r+n,o=u[l]):o=0,e.failed()?null:(e.pop(6),void e.pushInteger(o))):(e.primitiveFail(),null)}function k(){var f,r,o,l,i,u,n,s,c,a,h;return o=e.stackIntegerValue(0),n=e.stackIntegerValue(1),u=e.stackIntegerValue(2),h=e.stackFloatValue(3),c=e.stackFloatValue(4),r=e.stackValue(5),e.failed()?null:e.isWords(r)?t(r)!==o*n?(e.primitiveFail(),null):(s=0|c,a=0|h,i=u,i>1073741823&&(i=1073741823),0>i&&(i=0),f=r.words,s>=0&&n>s&&a>=0&&o>a&&(l=a*n+s,f[l]=i),e.failed()?null:void e.pop(6)):(e.primitiveFail(),null)}function g(){var v,f,d,s,a,p,u,i,c,l,h,o,n,m,r;if(u=e.stackValue(0),f=e.stackIntegerValue(1),a=e.stackIntegerValue(2),s=e.stackValue(3),r=e.stackValue(4),o=e.stackValue(5),e.failed())return null;if(!e.isWords(u))return e.primitiveFail(),null;if(!e.isWords(o))return e.primitiveFail(),null;if(!e.isWords(r))return e.primitiveFail(),null;if(!e.isWords(s))return e.primitiveFail(),null;if(f*a!==t(s))return e.primitiveFail(),null;if(c=t(o),t(r)!==c)return e.primitiveFail(),null;if(t(u)!==c)return e.primitiveFail(),null;for(h=o.wordsAsFloat32Array(),m=r.wordsAsFloat32Array(),p=u.words,v=s.words,i=0;c-1>=i;i++)l=0|h[i],n=0|m[i],l>=0&&n>=0&&a>l&&f>n&&(d=n*a+l,p[i]=v[d]);return e.failed()?null:void e.pop(6)}function b(){var v,p,b,l,n,o,i,y,S,F,d,m,c,k,g,f,u,h,a;return v=e.stackIntegerValue(0),k=e.stackIntegerValue(1),m=e.stackIntegerValue(2),S=e.stackIntegerValue(3),p=e.stackFloatValue(4),b=e.stackFloatValue(5),g=e.stackFloatValue(6),o=e.stackValue(7),a=e.stackValue(8),u=e.stackValue(9),y=e.stackIntegerValue(10),e.failed()?null:e.isWords(u)&&e.isWords(a)&&e.isWords(o)?(c=t(u),t(a)!==c?(e.primitiveFail(),null):t(o)!==c?(e.primitiveFail(),null):(f=u.wordsAsFloat32Array(),h=a.wordsAsFloat32Array(),n=o.wordsAsFloat32Array(),l=g,i=y-1,F=f[i]+l*Math.cos(n[i]),d=h[i]-l*Math.sin(n[i]),s(i,f,n,F,b,S,m),r(i,h,n,d,p,k,v),e.failed()?null:void e.pop(11))):(e.primitiveFail(),null)}function y(){var s,d,f,h,a,F,S,i,I,k,m,b,p,n,v,r,g,c,y,u,o,O,l;if(r=e.stackValue(0),d=e.stackIntegerValue(1),a=e.stackIntegerValue(2),h=e.stackValue(3),l=e.stackValue(4),u=e.stackValue(5),p=e.stackValue(6),e.failed())return null;if(!e.isBytes(p))return e.primitiveFail(),null;if(!e.isWords(u))return e.primitiveFail(),null;if(!e.isWords(l))return e.primitiveFail(),null;if(!e.isWords(h))return e.primitiveFail(),null;if(d*a!==t(h))return e.primitiveFail(),null;if(n=t(u),t(p)!==n)return e.primitiveFail(),null;if(t(l)!==n)return e.primitiveFail(),null;if(b=p.bytes,y=u.wordsAsFloat32Array(),O=l.wordsAsFloat32Array(),k="number"==typeof r)I=r,v=I;else{if(t(r)!==n)return e.primitiveFail(),null;m=e.isMemberOf(r,"WordArray"),m?g=r.words:F=r.wordsAsFloat32Array()}for(s=h.words,i=0;n-1>=i;i++)1===b[i]&&(c=0|y[i],o=0|O[i],c>=0&&o>=0&&a>c&&d>o&&(f=o*a+c,k?s[f]=v:m?s[f]=g[i]:(S=F[i],s[f]=S)));return e.failed()?null:void e.pop(7)}function S(){var g,A,v,d,o,h,i,u,F,O,I,P,l,k,n,b,y,S,a,p,c,m,f;if(g=e.stackIntegerValue(0),b=e.stackIntegerValue(1),k=e.stackIntegerValue(2),F=e.stackIntegerValue(3),A=e.stackFloatValue(4),v=e.stackFloatValue(5),a=e.stackValue(6),h=e.stackValue(7),f=e.stackValue(8),c=e.stackValue(9),l=e.stackValue(10),e.failed())return null;if(!e.isBytes(l))return e.primitiveFail(),null;if(!e.isWords(c))return e.primitiveFail(),null;if(!e.isWords(f))return e.primitiveFail(),null;if(!e.isWords(h))return e.primitiveFail(),null;if(a.isFloat)u=!1;else{if(!e.isWords(a))return e.primitiveFail(),null;u=!0}if(n=t(c),t(f)!==n)return e.primitiveFail(),null;if(t(h)!==n)return e.primitiveFail(),null;if(t(l)!==n)return e.primitiveFail(),null;if(u&&t(a)!==n)return e.primitiveFail(),null;for(P=l.bytes,p=c.wordsAsFloat32Array(),m=f.wordsAsFloat32Array(),o=h.wordsAsFloat32Array(),u?S=a.wordsAsFloat32Array():y=e.floatValueOf(a),i=0;n-1>=i;i++)1===P[i]&&(d=u?S[i]:y,O=p[i]+d*Math.cos(o[i]),I=m[i]-d*Math.sin(o[i]),s(i,p,o,O,v,F,k),r(i,m,o,I,A,b,g));return e.failed()?null:void e.pop(11)}function F(){var m,f,I,O,u,d,l,F,S,y,o,A,v,k,g,b,h,r,i,n,a,s;if(o=e.stackIntegerValue(0),u=e.stackIntegerValue(1),n=e.stackIntegerValue(2),f=e.stackValue(3),k=e.stackFloatValue(4),b=e.stackFloatValue(5),g=e.stackFloatValue(6),e.failed())return null;if(!e.isWords(f))return e.primitiveFail(),null;if(t(f)!==u*n)return e.primitiveFail(),null;for(m=f.words,r=g,i=b,r=Math.max(r,0),i=Math.max(i,0),r=Math.min(r,n-1),i=Math.min(i,u-1),A=Math.max(r-o,0),I=Math.min(r+o,n-1),v=Math.max(i-o,0),O=Math.min(i+o,u-1),d=m[i*n+r],l=-1,s=v;O>=s;s++)for(y=s*n,a=A;I>=a;a++)h=m[y+a],h>d&&(l=a,F=s,d=h);return S=-1===l?p(k):c(l-r,F-i)+90|0,e.failed()?null:(e.pop(8),void e.pushFloat(S))}function O(){var n,h,c,o,i,l,p,a,s,r,f,u,d;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(s)),e.success(e.isWords(r)),e.failed())return null;if(a=t(n),e.success(a===t(s)),e.success(a===t(r)),e.failed())return null;if(l=e.isMemberOf(n,"WordArray"),p=e.isMemberOf(s,"WordArray"),l&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(l)for(u=s.words,f=n.words,d=r.words,i=0;a-1>=i;i++)d[i]=u[i]+f[i];else for(u=s.words,h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=u[i]+h[i];else if(l)for(c=s.wordsAsFloat32Array(),f=n.words,o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]+f[i];else for(c=s.wordsAsFloat32Array(),h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]+h[i];e.pop(4),e.push(r)}function I(){var s,u,f,a,i,h,c,p,o,n,r,l,d;if(r=e.stackObjectValue(0),s=e.stackValue(1),n=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(r)),e.failed())return null;if(o=t(n),e.success(o===t(r)),e.failed())return null;if(c="number"==typeof s,p=e.isMemberOf(n,"WordArray"),c&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(c)for(l=n.words,h=s,d=r.words,i=0;o-1>=i;i++)d[i]=l[i]+h;else for(l=n.words,u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=l[i]+u;else if(c)for(f=n.wordsAsFloat32Array(),h=s,a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]+h;else for(f=n.wordsAsFloat32Array(),u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]+u;e.pop(4),e.push(r)}function A(){var i,s,a,o,l,r,u,n;if(r=e.stackObjectValue(0),n=e.stackValue(1),e.failed())return null;if(e.success(e.isBytes(n)),e.success(e.isBytes(r)),e.failed())return null;if(a=t(n),o=t(r),e.failed())return null;for(s=a,a>o&&(s=o),l=r.bytes,u=n.bytes,i=0;s-1>=i;i++)u[i]=u[i]+l[i]===2;e.pop(1)}function P(){var n,h,c,o,i,l,p,a,s,r,f,u,d;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(s)),e.success(e.isWords(r)),e.failed())return null;if(a=t(n),e.success(a===t(s)),e.success(a===t(r)),e.failed())return null;if(l=e.isMemberOf(n,"WordArray"),p=e.isMemberOf(s,"WordArray"),l&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(l)for(u=s.words,f=n.words,d=r.words,i=0;a-1>=i;i++)d[i]=u[i]/f[i];else for(u=s.words,h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=u[i]/h[i];else if(l)for(c=s.wordsAsFloat32Array(),f=n.words,o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]/f[i];else for(c=s.wordsAsFloat32Array(),h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]/h[i];e.pop(4),e.push(r)}function C(){var a,l,h,o,i,p,f,d,u,s,r,c,m;if(r=e.stackObjectValue(0),a=e.stackValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(s)),e.success(e.isWords(r)),e.failed())return null;if(u=t(s),e.success(u===t(r)),e.failed())return null;if(f="number"==typeof a,d=e.isMemberOf(s,"WordArray"),f&&d){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(d)if(f)for(c=s.words,p=a,m=r.words,i=0;u-1>=i;i++)m[i]=n(c[i],p);else for(c=s.words,l=e.floatValueOf(a),o=r.wordsAsFloat32Array(),i=0;u-1>=i;i++)o[i]=c[i]/l;else if(f)for(h=s.wordsAsFloat32Array(),p=a,o=r.wordsAsFloat32Array(),i=0;u-1>=i;i++)o[i]=h[i]/p;else for(h=s.wordsAsFloat32Array(),l=e.floatValueOf(a),o=r.wordsAsFloat32Array(),i=0;u-1>=i;i++)o[i]=h[i]/l;e.pop(4),e.push(r)}function w(){var r,n,u,l,i,h,p,o,s,a,f,c;if(a=e.stackObjectValue(0),r=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(s)),e.success(e.isBytes(a)),e.failed())return null;if(o=t(r),e.success(o===t(s)),e.success(o===t(a)),e.failed())return null;if(h=e.isMemberOf(r,"WordArray"),p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]===f[i];else for(c=s.words,u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]===u[i];else if(h)for(l=s.wordsAsFloat32Array(),f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]===f[i];else for(l=s.wordsAsFloat32Array(),u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]===u[i];e.pop(4),e.push(a)}function V(){var a,r,u,l,i,f,h,p,o,s,n,c;if(n=e.stackObjectValue(0),a=e.stackValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(s)),e.success(e.isBytes(n)),e.failed())return null;if(o=t(s),e.success(o===t(n)),e.failed())return null;if(h="number"==typeof a,p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]===f;else for(c=s.words,u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]===u;else if(h)for(l=s.wordsAsFloat32Array(),f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]===f;else for(l=s.wordsAsFloat32Array(),u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]===u;e.pop(4),e.push(n)}function j(){var r,n,u,l,i,h,p,o,s,a,f,c;if(a=e.stackObjectValue(0),r=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(s)),e.success(e.isBytes(a)),e.failed())return null;if(o=t(r),e.success(o===t(s)),e.success(o===t(a)),e.failed())return null;if(h=e.isMemberOf(r,"WordArray"),p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]>=f[i];else for(c=s.words,u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]>=u[i];else if(h)for(l=s.wordsAsFloat32Array(),f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]>=f[i];else for(l=s.wordsAsFloat32Array(),u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]>=u[i];e.pop(4),e.push(a)}function x(){var a,r,u,l,i,f,h,p,o,s,n,c;if(n=e.stackObjectValue(0),a=e.stackValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(s)),e.success(e.isBytes(n)),e.failed())return null;if(o=t(s),e.success(o===t(n)),e.failed())return null;if(h="number"==typeof a,p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]>=f;else for(c=s.words,u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]>=u;else if(h)for(l=s.wordsAsFloat32Array(),f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]>=f;else for(l=s.wordsAsFloat32Array(),u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]>=u;e.pop(4),e.push(n)}function q(){var r,n,u,l,i,h,p,o,s,a,f,c;if(a=e.stackObjectValue(0),r=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(s)),e.success(e.isBytes(a)),e.failed())return null;if(o=t(r),e.success(o===t(s)),e.success(o===t(a)),e.failed())return null;if(h=e.isMemberOf(r,"WordArray"),p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]>f[i];else for(c=s.words,u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]>u[i];else if(h)for(l=s.wordsAsFloat32Array(),f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]>f[i];else for(l=s.wordsAsFloat32Array(),u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]>u[i];e.pop(4),e.push(a)}function M(){var a,r,u,l,i,f,h,p,o,s,n,c;if(n=e.stackObjectValue(0),a=e.stackValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(s)),e.success(e.isBytes(n)),e.failed())return null;if(o=t(s),e.success(o===t(n)),e.failed())return null;if(h="number"==typeof a,p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]>f;else for(c=s.words,u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]>u;else if(h)for(l=s.wordsAsFloat32Array(),f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]>f;else for(l=s.wordsAsFloat32Array(),u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]>u;e.pop(4),e.push(n)}function B(){var r,n,u,l,i,h,p,o,s,a,f,c;if(a=e.stackObjectValue(0),r=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(s)),e.success(e.isBytes(a)),e.failed())return null;if(o=t(r),e.success(o===t(s)),e.success(o===t(a)),e.failed())return null;if(h=e.isMemberOf(r,"WordArray"),p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]<=f[i];else for(c=s.words,u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]<=u[i];else if(h)for(l=s.wordsAsFloat32Array(),f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]<=f[i];else for(l=s.wordsAsFloat32Array(),u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]<=u[i];e.pop(4),e.push(a)}function N(){var a,r,u,l,i,f,h,p,o,s,n,c;if(n=e.stackObjectValue(0),a=e.stackValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(s)),e.success(e.isBytes(n)),e.failed())return null;if(o=t(s),e.success(o===t(n)),e.failed())return null;if(h="number"==typeof a,p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]<=f;else for(c=s.words,u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]<=u;else if(h)for(l=s.wordsAsFloat32Array(),f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]<=f;else for(l=s.wordsAsFloat32Array(),u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]<=u;e.pop(4),e.push(n)}function _(){var r,n,u,l,i,h,p,o,s,a,f,c;if(a=e.stackObjectValue(0),r=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(s)),e.success(e.isBytes(a)),e.failed())return null;if(o=t(r),e.success(o===t(s)),e.success(o===t(a)),e.failed())return null;if(h=e.isMemberOf(r,"WordArray"),p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]<f[i];else for(c=s.words,u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]<u[i];else if(h)for(l=s.wordsAsFloat32Array(),f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]<f[i];else for(l=s.wordsAsFloat32Array(),u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]<u[i];e.pop(4),e.push(a)}function W(){var a,r,u,l,i,f,h,p,o,s,n,c;if(n=e.stackObjectValue(0),a=e.stackValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(s)),e.success(e.isBytes(n)),e.failed())return null;if(o=t(s),e.success(o===t(n)),e.failed())return null;if(h="number"==typeof a,p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]<f;else for(c=s.words,u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]<u;else if(h)for(l=s.wordsAsFloat32Array(),f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]<f;else for(l=s.wordsAsFloat32Array(),u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]<u;e.pop(4),e.push(n)}function D(){var n,h,c,o,i,l,p,a,s,r,f,u,d;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(s)),e.success(e.isWords(r)),e.failed())return null;if(a=t(n),e.success(a===t(s)),e.success(a===t(r)),e.failed())return null;if(l=e.isMemberOf(n,"WordArray"),p=e.isMemberOf(s,"WordArray"),l&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(l)for(u=s.words,f=n.words,d=r.words,i=0;a-1>=i;i++)d[i]=u[i]*f[i];else for(u=s.words,h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=u[i]*h[i];else if(l)for(c=s.wordsAsFloat32Array(),f=n.words,o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]*f[i];else for(c=s.wordsAsFloat32Array(),h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]*h[i];e.pop(4),e.push(r)}function T(){var s,u,f,a,i,h,c,p,o,n,r,l,d;if(r=e.stackObjectValue(0),s=e.stackValue(1),n=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(r)),e.failed())return null;if(o=t(n),e.success(o===t(r)),e.failed())return null;if(c="number"==typeof s,p=e.isMemberOf(n,"WordArray"),c&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(c)for(l=n.words,h=s,d=r.words,i=0;o-1>=i;i++)d[i]=l[i]*h;else for(l=n.words,u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=l[i]*u;else if(c)for(f=n.wordsAsFloat32Array(),h=s,a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]*h;else for(f=n.wordsAsFloat32Array(),u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]*u;e.pop(4),e.push(r)}function L(){var r,n,u,l,i,h,p,o,s,a,f,c;if(a=e.stackObjectValue(0),r=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(r)),e.success(e.isWords(s)),e.success(e.isBytes(a)),e.failed())return null;if(o=t(r),e.success(o===t(s)),e.success(o===t(a)),e.failed())return null;if(h=e.isMemberOf(r,"WordArray"),p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]!==f[i];else for(c=s.words,u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=c[i]!==u[i];else if(h)for(l=s.wordsAsFloat32Array(),f=r.words,n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]!==f[i];else for(l=s.wordsAsFloat32Array(),u=r.wordsAsFloat32Array(),n=a.bytes,i=0;o-1>=i;i++)n[i]=l[i]!==u[i];e.pop(4),e.push(a)}function Ce(){var a,r,u,l,i,f,h,p,o,s,n,c;if(n=e.stackObjectValue(0),a=e.stackValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(s)),e.success(e.isBytes(n)),e.failed())return null;if(o=t(s),e.success(o===t(n)),e.failed())return null;if(h="number"==typeof a,p=e.isMemberOf(s,"WordArray"))if(h)for(c=s.words,f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]!==f;else for(c=s.words,u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=c[i]!==u;else if(h)for(l=s.wordsAsFloat32Array(),f=a,r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]!==f;else for(l=s.wordsAsFloat32Array(),u=e.floatValueOf(a),r=n.bytes,i=0;o-1>=i;i++)r[i]=l[i]!==u;e.pop(4),e.push(n)}function E(){var i,s,r,n;if(n=e.stackValue(0),e.failed())return null;if(e.success(e.isBytes(n)),e.failed())return null;if(s=t(n),e.failed())return null;for(r=n.bytes,i=0;s-1>=i;i++)0===r[i]?r[i]=1:r[i]=0}function K(){var i,s,a,o,l,r,u,n;if(r=e.stackObjectValue(0),n=e.stackValue(1),e.failed())return null;if(e.success(e.isBytes(n)),e.success(e.isBytes(r)),e.failed())return null;if(a=t(n),o=t(r),e.failed())return null;for(s=a,a>o&&(s=o),l=r.bytes,u=n.bytes,i=0;s-1>=i;i++)u[i]=u[i]+l[i]>0;e.pop(1)}function z(){var i,o,s,a,u,r,l,n;if(r=e.stackValue(0),a=e.stackObjectValue(1),e.failed())return null;if(u=e.isIntegerValue(r)?r:e.booleanValueOf(r),n=e.fetchPointerofObject(1,a),s=e.fetchPointerofObject(0,a),e.failed())return null;if(!e.isBytes(s))return e.primitiveFail(),null;if(!e.isBytes(n))return e.primitiveFail(),null;for(l=n.bytes,o=s.bytes,i=0;i<=t(n)-1;i++)1===o[i]&&(l[i]=u);e.pop(1)}function G(){var i,o,s,a,r,u,n;if(r=e.stackIntegerValue(0),a=e.stackObjectValue(1),e.failed())return null;if(r=4278190080|r,n=e.fetchPointerofObject(1,a),s=e.fetchPointerofObject(0,a),e.failed())return null;if(!e.isBytes(s))return e.primitiveFail(),null;if(!e.isWords(n))return e.primitiveFail(),null;for(u=n.words,o=s.bytes,i=0;i<=t(n)-1;i++)1===o[i]&&(u[i]=r);e.pop(1)}function U(){var i,a,n,s,o,u,r;if(o=e.stackFloatValue(0),s=e.stackObjectValue(1),e.failed())return null;if(r=e.fetchPointerofObject(1,s),n=e.fetchPointerofObject(0,s),e.failed())return null;if(!e.isBytes(n))return e.primitiveFail(),null;if(!e.isWords(r))return e.primitiveFail(),null;for(u=r.wordsAsFloat32Array(),a=n.bytes,i=0;i<=t(r)-1;i++)1===a[i]&&(u[i]=o);e.pop(1)}function J(){var i,a,n,s,o,u,r;if(o=e.stackValue(0),s=e.stackObjectValue(1),e.failed())return null;if(r=e.fetchPointerofObject(1,s),n=e.fetchPointerofObject(0,s),e.failed())return null;if(!e.isBytes(n))return e.primitiveFail(),null;if(!e.isPointers(r))return e.primitiveFail(),null;for(u=r.wordsAsInt32Array(),a=n.bytes,i=0;i<=t(r)-1;i++)1===a[i]&&(u[i]=o);
e.pop(1)}function m(){var r,d,a,h,l,o,s,m,c,i,n,p,u,f;if(s=e.stackIntegerValue(0),o=e.stackObjectValue(1),n=e.stackIntegerValue(2),i=e.stackIntegerValue(3),l=e.stackObjectValue(4),e.failed())return null;if(u=e.fetchPointerofObject(1,l),a=e.fetchPointerofObject(0,l),e.failed())return null;if(!e.isBytes(a))return e.primitiveFail(),null;if(!e.isBytes(u)||!e.isBytes(o))return e.primitiveFail(),null;if(p=u.bytes,d=a.bytes,m=o.bytes,f=t(u),h=t(a),c=t(o),i>n)return e.primitiveFail(),null;if(1>i)return e.primitiveFail(),null;if(i>f)return e.primitiveFail(),null;if(i>h)return e.primitiveFail(),null;if(n>f)return e.primitiveFail(),null;if(n>h)return e.primitiveFail(),null;if(1>s)return e.primitiveFail(),null;if(s>c)return e.primitiveFail(),null;if(n-i+1>c-s+1)return e.primitiveFail(),null;for(r=i-1;n-1>=r;r++)1===d[r]&&(p[r]=m[s+r-i]);e.pop(4)}function X(){var d,f,y,i,u,m,g,l,k,n,o,p,v,r,a,c,h,s,b;if(o=e.stackIntegerValue(0),n=e.stackObjectValue(1),a=e.stackIntegerValue(2),r=e.stackIntegerValue(3),k=e.stackObjectValue(4),e.failed())return null;if(s=e.fetchPointerofObject(1,k),m=e.fetchPointerofObject(0,k),e.failed())return null;if(!e.isBytes(m))return e.primitiveFail(),null;if(!(e.isWords(s)&&e.isWords(n)||e.isPointers(s)&&e.isPointers(n)))return e.primitiveFail(),null;if(u=m.bytes,b=t(s),g=t(m),v=t(n),r>a)return e.primitiveFail(),null;if(1>r)return e.primitiveFail(),null;if(r>b)return e.primitiveFail(),null;if(r>g)return e.primitiveFail(),null;if(a>b)return e.primitiveFail(),null;if(a>g)return e.primitiveFail(),null;if(1>o)return e.primitiveFail(),null;if(o>v)return e.primitiveFail(),null;if(a-r+1>v-o+1)return e.primitiveFail(),null;if(c=e.isMemberOf(s,"KedamaFloatArray"),l=e.isMemberOf(n,"KedamaFloatArray"),c&&l)for(f=s.wordsAsFloat32Array(),d=n.wordsAsFloat32Array(),i=r-1;a-1>=i;i++)1===u[i]&&(f[i]=d[o+i-r]);if(c&&!l)for(f=s.wordsAsFloat32Array(),p=n.words,i=r-1;a-1>=i;i++)1===u[i]&&(f[i]=p[o+i-r]);if(!c&&l)for(h=s.words,d=n.wordsAsFloat32Array(),i=r-1;a-1>=i;i++)1===u[i]&&(y=d[o+i-r]>>>0,h[i]=y);if(!c&&!l)for(h=s.words,p=n.words,i=r-1;a-1>=i;i++)1===u[i]&&(h[i]=p[o+i-r]);e.pop(4)}function Y(){var s,l,f,r,v,m,c,i,d,b,u,o,n,h,p,y,g,k,S;if(n=e.stackObjectValue(0),s=e.stackObjectValue(1),o=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(s)),e.success(e.isWords(o)),e.success(e.isWords(n)),e.failed())return null;if(u=t(s),e.success(u===t(o)),e.success(u===t(n)),e.failed())return null;if(d=e.isMemberOf(s,"WordArray"),b=e.isMemberOf(o,"WordArray"),d&&b){if(!e.isMemberOf(n,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(n,"KedamaFloatArray"))return e.primitiveFail(),null;if(b)if(d)for(k=o.words,g=s.words,S=n.words,i=0;u-1>=i;i++)p=k[i],h=g[i],y=a(p,h),S[i]=y;else for(k=o.words,v=s.wordsAsFloat32Array(),c=n.wordsAsFloat32Array(),i=0;u-1>=i;i++)p=k[i],l=v[i],r=p/l,r=Math.floor(r),c[i]=p-r*l;else if(d)for(m=o.wordsAsFloat32Array(),g=s.words,c=n.wordsAsFloat32Array(),i=0;u-1>=i;i++)f=m[i],h=g[i],r=f/h,r=Math.floor(r),c[i]=f-r*h;else for(m=o.wordsAsFloat32Array(),v=s.wordsAsFloat32Array(),c=n.wordsAsFloat32Array(),i=0;u-1>=i;i++)f=m[i],l=v[i],r=f/l,r=Math.floor(r),c[i]=f-r*l;e.pop(4),e.push(n)}function Z(){var o,c,u,r,d,l,i,h,p,k,f,s,n,v,m,g;if(n=e.stackObjectValue(0),o=e.stackValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(s)),e.success(e.isWords(n)),e.failed())return null;if(f=t(s),e.success(f===t(n)),e.failed())return null;if(p="number"==typeof o,k=e.isMemberOf(s,"WordArray"),p&&k){if(!e.isMemberOf(n,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(n,"KedamaFloatArray"))return e.primitiveFail(),null;if(k)if(p)for(m=s.words,h=o,g=n.words,i=0;f-1>=i;i++)g[i]=a(m[i],h);else for(m=s.words,c=e.floatValueOf(o),l=n.wordsAsFloat32Array(),i=0;f-1>=i;i++)v=m[i],r=v/c,r=Math.floor(r),l[i]=v-r*c;else if(p)for(d=s.wordsAsFloat32Array(),h=o,l=n.wordsAsFloat32Array(),i=0;f-1>=i;i++)u=d[i],r=u/h,r=Math.floor(r),l[i]=u-r*h;else for(d=s.wordsAsFloat32Array(),c=e.floatValueOf(o),l=n.wordsAsFloat32Array(),i=0;f-1>=i;i++)u=d[i],r=u/c,r=Math.floor(r),l[i]=u-r*c;e.pop(4),e.push(n)}function Q(){var n,h,c,o,i,l,p,a,s,r,f,u,d;if(r=e.stackObjectValue(0),n=e.stackObjectValue(1),s=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(s)),e.success(e.isWords(r)),e.failed())return null;if(a=t(n),e.success(a===t(s)),e.success(a===t(r)),e.failed())return null;if(l=e.isMemberOf(n,"WordArray"),p=e.isMemberOf(s,"WordArray"),l&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(l)for(u=s.words,f=n.words,d=r.words,i=0;a-1>=i;i++)d[i]=u[i]-f[i];else for(u=s.words,h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=u[i]-h[i];else if(l)for(c=s.wordsAsFloat32Array(),f=n.words,o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]-f[i];else for(c=s.wordsAsFloat32Array(),h=n.wordsAsFloat32Array(),o=r.wordsAsFloat32Array(),i=0;a-1>=i;i++)o[i]=c[i]-h[i];e.pop(4),e.push(r)}function $(){var s,u,f,a,i,h,c,p,o,n,r,l,d;if(r=e.stackObjectValue(0),s=e.stackValue(1),n=e.stackObjectValue(2),e.failed())return null;if(e.success(e.isWords(n)),e.success(e.isWords(r)),e.failed())return null;if(o=t(n),e.success(o===t(r)),e.failed())return null;if(c="number"==typeof s,p=e.isMemberOf(n,"WordArray"),c&&p){if(!e.isMemberOf(r,"WordArray"))return e.primitiveFail(),null}else if(!e.isMemberOf(r,"KedamaFloatArray"))return e.primitiveFail(),null;if(p)if(c)for(l=n.words,h=s,d=r.words,i=0;o-1>=i;i++)d[i]=l[i]-h;else for(l=n.words,u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=l[i]-u;else if(c)for(f=n.wordsAsFloat32Array(),h=s,a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]-h;else for(f=n.wordsAsFloat32Array(),u=e.floatValueOf(s),a=r.wordsAsFloat32Array(),i=0;o-1>=i;i++)a[i]=f[i]-u;e.pop(4),e.push(r)}function p(i){var e,t;return t=i/.0174532925199433,e=90-t,e>0||(e+=360),e}function te(){var a,o,i,r,n,u,l,s;if(a=e.stackFloatValue(0),i=e.stackValue(1),s=e.stackIntegerValue(2),r=e.stackIntegerValue(3),u=e.stackIntegerValue(4),e.failed())return null;if(!e.isWords(i))return e.primitiveFail(),null;if(l=t(i),!(l>=s&&r>=1&&s>=r))return e.primitiveFail(),null;if(o=i.wordsAsFloat32Array(),e.failed())return null;for(n=r;s>=n;n++)o[n-1]=f(u)*a;e.pop(5)}function ie(){var a,i,r,o,n,u,l,s;if(a=e.stackFloatValue(0),n=e.stackValue(1),s=e.stackIntegerValue(2),i=e.stackIntegerValue(3),u=e.stackIntegerValue(4),e.failed())return null;if(!e.isWords(n))return e.primitiveFail(),null;if(l=t(n),!(l>=s&&i>=1&&s>=i))return e.primitiveFail(),null;if(o=n.words,e.failed())return null;for(r=i;s>=r;r++)o[r-1]=f(u)*a|0;e.pop(5)}function re(){var t,i;return t=e.stackIntegerValue(0),e.failed()?null:(i=f(t),e.failed()?null:(e.pop(2),void e.pushInteger(i)))}function ne(){var i,r,t,n,s,a,o;return r=e.stackFloatValue(0),i=e.stackFloatValue(1),s=e.stackFloatValue(2),n=e.stackFloatValue(3),e.failed()?null:(a=n-i,o=s-r,t=c(a,o),t+=90,t>360&&(t-=360),e.failed()?null:(e.pop(5),void e.pushFloat(t)))}function se(){var r,n,s,a,o,t,i;return n=e.stackFloatValue(0),r=e.stackFloatValue(1),o=e.stackFloatValue(2),a=e.stackFloatValue(3),e.failed()?null:(t=r-a,i=n-o,s=Math.sqrt(t*t+i*i),e.failed()?null:(e.pop(5),void e.pushFloat(s)))}function s(i,o,r,u,n,s,a){var t,e;e=u,0>e&&(1===s&&(e+=n),2===s&&(e=0),3===s&&(e=0-e,t=r[i],3.141592653589793>t?r[i]=3.141592653589793-t:r[i]=9.42477796076938-t)),e>=n&&(1===a&&(e-=n),2===a&&(e=n-1e-6),3===a&&(e=n-1e-6-(e-n),t=r[i],3.141592653589793>t?r[i]=3.141592653589793-t:r[i]=9.42477796076938-t)),o[i]=e}function r(i,a,r,o,t,n,s){var e;e=o,0>e&&(1===n&&(e+=t),2===n&&(e=0),3===n&&(e=0-e,r[i]=6.283185307179586-r[i])),e>=t&&(1===s&&(e-=t),2===s&&(e=t-1e-6),3===s&&(e=t-1e-6-(e-t),r[i]=6.283185307179586-r[i])),a[i]=e}function ue(){var i,c,s,r,a,f,o,h,n,u;if(n=e.stackValue(0),s=e.stackValue(1),o=e.stackValue(2),e.failed())return null;if(!e.isBytes(o))return e.primitiveFail(),null;if(!e.isWords(s))return e.primitiveFail(),null;if(u=t(s),n.isFloat)a=!1;else{if(!e.isWords(n))return e.primitiveFail(),null;if(t(n)!==u)return e.primitiveFail(),null;a=!0}for(f=o.bytes,c=s.wordsAsFloat32Array(),a?h=n.wordsAsFloat32Array():(i=e.floatValueOf(n),i=l(i)),r=0;u-1>=r;r++)1===f[r]&&(a&&(i=h[r],i=l(i)),c[r]=i);return e.failed()?null:void e.pop(3)}function le(i){var t;return e=i,t=e.majorVersion()==be,t===!1?!1:t=e.minorVersion()>=ye}function ce(){var n,s,i,r;return n=e.stackFloatValue(0),i=e.stackValue(1),r=e.stackIntegerValue(2),e.failed()?null:e.isWords(i)?t(i)<r?(e.primitiveFail(),null):(s=i.wordsAsFloat32Array(),s[r-1]=l(n),e.failed()?null:void e.pop(3)):(e.primitiveFail(),null)}function fe(){return!0}function he(){var n,a,i,o,u,l,c,f,h,r;return u=e.stackIntegerValue(0),o=e.stackIntegerValue(1),n=e.stackFloatValue(2),c=e.stackFloatValue(3),i=e.stackValue(4),h=e.stackIntegerValue(5),r=e.stackValue(6),e.failed()?null:e.isWords(r)&&e.isWords(i)?(l=t(r),t(i)!==l?(e.primitiveFail(),null):(f=r.wordsAsFloat32Array(),a=i.wordsAsFloat32Array(),s(h-1,f,a,c,n,o,u),e.failed()?null:void e.pop(7))):(e.primitiveFail(),null)}function pe(){var s,a,o,i,u,l,c,f,h,n;return s=e.stackIntegerValue(0),l=e.stackIntegerValue(1),a=e.stackFloatValue(2),c=e.stackFloatValue(3),i=e.stackValue(4),h=e.stackIntegerValue(5),n=e.stackValue(6),e.failed()?null:e.isWords(n)&&e.isWords(i)?(u=t(n),t(i)!==u?(e.primitiveFail(),null):(f=n.wordsAsFloat32Array(),o=i.wordsAsFloat32Array(),r(h-1,f,o,c,a,l,s),e.failed()?null:void e.pop(7))):(e.primitiveFail(),null)}function de(){var y,h,l,r,n,c,d,k,m,o,p,a,f,v,i,g,b,u;if(p=e.stackIntegerValue(0),d=e.stackIntegerValue(1),y=e.stackFloatValue(2),i=e.stackValue(3),l=e.stackValue(4),u=e.stackValue(5),o=e.stackValue(6),e.failed())return null;if(!e.isBytes(o))return e.primitiveFail(),null;if(!e.isWords(u))return e.primitiveFail(),null;if(!e.isWords(l))return e.primitiveFail(),null;if(i.isFloat)n=!1;else{if(!e.isWords(i))return e.primitiveFail(),null;n=!0,c=e.isMemberOf(i,"WordArray")}if(a=t(u),t(o)!==a)return e.primitiveFail(),null;if(t(l)!==a)return e.primitiveFail(),null;if(n&&t(i)!==a)return e.primitiveFail(),null;for(m=o.bytes,b=u.wordsAsFloat32Array(),h=l.wordsAsFloat32Array(),n?c?g=i.words:v=i.wordsAsFloat32Array():f=e.floatValueOf(i),r=0;a-1>=r;r++)1===m[r]&&(k=n?c?g[r]:v[r]:f,s(r,b,h,k,y,d,p));return e.failed()?null:void e.pop(7)}function me(){var y,h,k,u,n,s,c,p,m,o,a,d,f,v,i,g,b,l;if(y=e.stackIntegerValue(0),d=e.stackIntegerValue(1),h=e.stackFloatValue(2),i=e.stackValue(3),u=e.stackValue(4),l=e.stackValue(5),o=e.stackValue(6),e.failed())return null;if(!e.isBytes(o))return e.primitiveFail(),null;if(!e.isWords(l))return e.primitiveFail(),null;if(!e.isWords(u))return e.primitiveFail(),null;if(i.isFloat)s=!1;else{if(!e.isWords(i))return e.primitiveFail(),null;s=!0,c=e.isMemberOf(i,"WordArray")}if(a=t(l),t(o)!==a)return e.primitiveFail(),null;if(t(u)!==a)return e.primitiveFail(),null;if(s&&t(i)!==a)return e.primitiveFail(),null;for(m=o.bytes,b=l.wordsAsFloat32Array(),k=u.wordsAsFloat32Array(),s?c?g=i.words:v=i.wordsAsFloat32Array():f=e.floatValueOf(i),n=0;a-1>=n;n++)1===m[n]&&(p=s?c?g[n]:v[n]:f,r(n,b,k,p,h,d,y));return e.failed()?null:void e.pop(7)}function ve(){var i,s,k,a,d,n,p,h,u,y,o,r,m,v,f,g,b,l;if(o=e.stackValue(0),l=e.stackValue(1),f=e.stackValue(2),n=e.stackValue(3),a=e.stackValue(4),e.failed())return null;if(!e.isWords(o))return e.primitiveFail(),null;if(!e.isWords(f))return e.primitiveFail(),null;if(!e.isWords(l))return e.primitiveFail(),null;if(r=t(o),0>r)return e.primitiveFail(),null;if(t(f)!==r)return e.primitiveFail(),null;if(t(l)!==r)return e.primitiveFail(),null;if(a.isFloat){if(!n.isFloat)return e.primitiveFail(),null;s=!1}else{if(n.isFloat)return e.primitiveFail(),null;s=!0}if(s){if(t(a)!==r)return e.primitiveFail(),null;if(t(n)!==r)return e.primitiveFail(),null}for(y=o.wordsAsFloat32Array(),v=f.wordsAsFloat32Array(),b=l.wordsAsFloat32Array(),s&&(k=a.wordsAsFloat32Array(),d=n.wordsAsFloat32Array()),s||(p=e.floatValueOf(a),h=e.floatValueOf(n)),i=0;r-1>=i;i++)s&&(p=k[i],h=d[i]),m=p-v[i],g=h-b[i],u=c(m,g),u+=90,u>360&&(u-=360),y[i]=u;return e.failed()?null:(e.pop(6),void e.push(o))}function ke(){var i,s,v,a,d,n,f,c,g,o,r,h,m,u,p,k,l;if(o=e.stackValue(0),l=e.stackValue(1),u=e.stackValue(2),n=e.stackValue(3),a=e.stackValue(4),e.failed())return null;if(!e.isWords(o))return e.primitiveFail(),null;if(!e.isWords(u))return e.primitiveFail(),null;if(!e.isWords(l))return e.primitiveFail(),null;if(r=t(o),0>r)return e.primitiveFail(),null;if(t(u)!==r)return e.primitiveFail(),null;if(t(l)!==r)return e.primitiveFail(),null;if(a.isFloat){if(!n.isFloat)return e.primitiveFail(),null;s=!1}else{if(n.isFloat)return e.primitiveFail(),null;s=!0}if(s){if(t(a)!==r)return e.primitiveFail(),null;if(t(n)!==r)return e.primitiveFail(),null}for(g=o.wordsAsFloat32Array(),m=u.wordsAsFloat32Array(),k=l.wordsAsFloat32Array(),s&&(v=a.wordsAsFloat32Array(),d=n.wordsAsFloat32Array()),s||(f=e.floatValueOf(a),c=e.floatValueOf(n)),i=0;r-1>=i;i++)s&&(f=v[i],c=d[i]),h=f-m[i],p=c-k[i],g[i]=Math.sqrt(h*h+p*p);return e.failed()?null:(e.pop(6),void e.push(o))}function ge(){var b,v,h,p,g,o,u,k,r,s,i,n,d,m,f,l,a,c;if(c=e.stackIntegerValue(0),l=e.stackIntegerValue(1),u=e.stackIntegerValue(2),r=e.stackIntegerValue(3),h=e.stackValue(4),s=e.stackValue(5),e.failed())return null;if(d=t(s),g=t(h),r*u!==d)return e.primitiveFail(),null;if(d*l*c!==g)return e.primitiveFail(),null;for(k=s.words,v=h.words,i=0,n=0,p=0,f=0;u-1>=f;f++){for(a=0;c-1>=a;a++){for(m=0;r-1>=m;m++)for(b=k[i],++i,o=0;l-1>=o;o++)v[p]=b,++p;i=n}n+=r,i=n}e.pop(6)}var be=1,ye=11,e=null,i=0,Oe="KedamaPlugin2 13 November 2014 (e)",o=0,u=0,h=0,d=0;Squeak.registerExternalModule("KedamaPlugin2",{primitiveAddArrays:O,getModuleName:Fe,primitiveMulArrays:D,drawTurtlesInArray:Ae,primitiveGTScalar:M,setScalarHeading:ce,primitiveSubScalar:$,turtleScalarSetY:pe,vectorGetAngleTo:ve,primitiveRemArrays:Y,primitiveLTArrays:_,primitiveAddScalar:I,primPixelsAtXY:g,primitiveMulScalar:T,primSetPixelsAtXY:y,setHeadingArrayFrom:ue,primPixelAtXYPut:k,makeMaskLog:R,primitiveLTScalar:W,scalarGetAngleTo:ne,primitiveOrByteArray:K,primitiveLEArrays:B,primitiveRemScalar:Z,getHeadingArrayInto:Ie,turtlesSetX:de,primitivePredicateReplaceBytes:m,primitiveDivArrays:P,makeMask:ee,primitiveLEScalar:N,kedamaSetRandomSeed:ae,randomIntoIntegerArray:ie,setInterpreter:le,primitivePredicateAtAllPutColor:G,makeTurtlesMap:v,randomIntoFloatArray:te,primUpHill:F,shutdownModule:fe,primitiveDivScalar:C,primitiveGEArrays:j,primitiveNotByteArray:E,randomRange:re,initialiseModule:oe,getScalarHeading:Se,primPixelAtXY:H,primitivePredicateAtAllPutNumber:U,primitiveEQArrays:w,primitiveNEArrays:L,primScalarForward:b,vectorGetDistanceTo:ke,turtlesSetY:me,turtleScalarSetX:he,primTurtlesForward:S,primitiveGEScalar:x,primitiveAndByteArray:A,primitivePredicateReplaceWords:X,primitiveGTArrays:q,primitivePredicateAtAllPutObject:J,primitiveEQScalar:V,primitivePredicateAtAllPutBoolean:z,zoomBitmap:ge,primitiveNEScalar:Ce,scalarGetDistanceTo:se,primitiveSubArrays:Q})}),module("users.bert.SqueakJS.plugins.Klatt").requires("users.bert.SqueakJS.vm").toRun(function(){function Pe(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function Le(e,t){return 0|Math.floor(e/t)}function N(e,t){return e-Le(e,t)*t|0}function _t(){0!==N(v,2)&&(r*=1-t[B],r>0&&(r=0))}function Nt(){var i,r,n,s,e;e=I/f,i=Math.sin(2*h*12.7*e),r=Math.sin(2*h*7.1*e),n=Math.sin(2*h*4.7*e),s=2*t[De]*t[g]/100*(i+r+n),l+=s}function Bt(){0===N(v,2)?l+=t[B]*t[g]*(1-t[C]):l-=t[B]*t[g]*(1-t[C])}function Mt(){l+=(O()-32767)*t[_e]/32768*t[g]}function qt(){r+=(O()-32767)*t[ft]/32768*r,r>0&&(r=0)}function L(s,a,o){var e,r,t,i,n;r=(0-h)/f*o,n=Math.exp(r),i=0-n*n,r=2*h/f*a,t=n*Math.cos(r)*2,e=1-t-i,e=1/e,t=(0-t)*e,i=(0-i)*e,j(s,e),E(s,t),z(s,i)}function Ae(e,t){var i,r;return i=x(e)*t+R(e)*(r=X(e))+K(e)*Fe(e),Ie(e,r),ye(e,t),i}function xt(t){var e;return s>0?(e=Ae(Y,t),e=i(Q,e),e=Ae(G,e),e=i(J,e),s>=8&&(e=i($,e)),s>=7&&(e=i(ee,e)),s>=6&&(e=i(ie,e)),s>=5&&(e=i(ae,e)),s>=4&&(e=i(fe,e)),s>=3&&(e=i(de,e)),s>=2&&(e=i(be,e)),s>=1&&(e=i(Ve,e)),e):0}function xe(t){return e.success(e.isWords(t)),e.failed()?0:t.wordsAsFloat32Array()}function jt(t){return e.success(e.isWords(t)),e.failed()?0:t.wordsAsInt16Array()}function Vt(){return Ft}function wt(){var e;return 0===a?0:(b>p?(e=S*r+F*d,d=r,r=e):(e=V*r-w,r=e),p>=a&&(p=0,Ot()),++p,e)}function n(e){return 32.767*Math.pow(2,(e-87)/6)}function Ct(t){var i;return e.success(22===Pe(t)),e.failed()?!1:(i=e.fetchPointerofObject(0,t),u=xe(i),l=e.fetchFloatofObject(2,t),a=e.fetchIntegerofObject(3,t),p=e.fetchIntegerofObject(4,t),b=e.fetchIntegerofObject(5,t),m=e.fetchIntegerofObject(6,t),S=e.fetchFloatofObject(7,t),F=e.fetchFloatofObject(8,t),r=e.fetchFloatofObject(9,t),d=e.fetchFloatofObject(10,t),V=e.fetchFloatofObject(11,t),w=e.fetchFloatofObject(12,t),A=e.fetchFloatofObject(13,t),T=e.fetchFloatofObject(14,t),y=e.fetchFloatofObject(15,t),v=e.fetchIntegerofObject(16,t),I=e.fetchIntegerofObject(17,t),P=e.fetchIntegerofObject(18,t),s=e.fetchIntegerofObject(19,t),M=e.fetchIntegerofObject(20,t),f=e.fetchIntegerofObject(21,t),e.failed()===!1)}function O(){return P=1309*P+13849&65535}function Pt(){var i,e,t,n;for(e=0,t=r,n=d,i=1;b>=i;i++)e=S*t+F*n,n=t,t=e;0!==e&&(r=r/e*1e4)}function At(e){return i(ge,e)-i(pe,e)+i(ce,e)-i(re,e)+i(te,e)}function It(e){return i(Se,e)+i(ve,e)+i(he,e)+i(ue,e)+i(Z,e)+i(U,e)}function Ot(){t[g]>0?(mt(),v=N(v+1,65535)):(a=1,m=a)}function St(){var i,r,n,t,s;return i=xe(e.stackValue(2)),r=jt(n=e.stackValue(1)),s=e.stackIntegerValue(0),e.failed()?null:(t=e.stackObjectValue(3),Ct(t)?(e.success(2*Pe(n)>=M),e.failed()?null:(vt(i,r,s),bt(t)?void e.pop(3):null)):null)}function k(e,i,r,n,s){var t;return t=Math.exp(e*i),t*((s*(e*e+1)+e)*n-r)+1}function c(i,a,o){var s,e,r,n,t;e=(0-h)/f*o,t=Math.exp(e),n=0-t*t,e=2*h/f*a,r=t*Math.cos(e)*2,s=1-r-n,j(i,s),E(i,r),z(i,n)}function o(e,t,i,r){c(e,t,i),j(e,x(e)*r)}function i(e,r){var t,i;return t=x(e)*r+R(e)*(i=X(e))+K(e)*Fe(e),Ie(e,i),ye(e,t),t}function x(e){return u[5*e-5]}function j(e,t){u[5*e-5]=t}function R(e){return u[5*e-4]}function E(e,t){u[5*e-4]=t}function K(e){return u[5*e-3]}function z(e,t){u[5*e-3]=t}function X(e){return u[5*e-2]}function ye(e,t){u[5*e-2]=t}function Fe(e){return u[5*e-1]}function Ie(e,t){u[5*e-1]=t}function yt(O,b,y){var v,u,s,l,e,c,t,i,m,f,k,g,o,n,p;o=a*O|0,f=o/a,m=y,t=b,0>=t?u=1:(c=(1-f)/t,u=1-c/(Math.exp(c)-1)),e=h*(m+1),v=Math.cos(e),g=Math.sin(e),k=t/f*e*u,p=dt(e,v,g,k),n=e/o,i=Math.exp(p*n),S=2*Math.cos(n)*i,F=0-i*i,d=0,r=i*Math.sin(n),s=Math.exp(-1/(t*a)),l=Math.pow(s,a-o),V=s,w=(1-s)*l/(1-l),Pt()}function bt(O){var c,n,s,o,u,t,f,h,k,g,i;return e.pushRemappableOop(O),e.pushRemappableOop(e.floatObjectOf(l)),e.pushRemappableOop(e.floatObjectOf(S)),e.pushRemappableOop(e.floatObjectOf(F)),e.pushRemappableOop(e.floatObjectOf(r)),e.pushRemappableOop(e.floatObjectOf(d)),e.pushRemappableOop(e.floatObjectOf(V)),e.pushRemappableOop(e.floatObjectOf(w)),e.pushRemappableOop(e.floatObjectOf(A)),e.pushRemappableOop(e.floatObjectOf(T)),f=e.floatObjectOf(y),k=e.popRemappableOop(),u=e.popRemappableOop(),o=e.popRemappableOop(),s=e.popRemappableOop(),i=e.popRemappableOop(),g=e.popRemappableOop(),n=e.popRemappableOop(),c=e.popRemappableOop(),h=e.popRemappableOop(),t=e.popRemappableOop(),e.failed()?!1:(e.storePointerofObjectwithValue(2,t,h),e.storeIntegerofObjectwithValue(3,t,a),e.storeIntegerofObjectwithValue(4,t,p),e.storeIntegerofObjectwithValue(5,t,b),e.storeIntegerofObjectwithValue(6,t,m),e.storePointerofObjectwithValue(7,t,c),e.storePointerofObjectwithValue(8,t,n),e.storePointerofObjectwithValue(9,t,g),e.storePointerofObjectwithValue(10,t,i),e.storePointerofObjectwithValue(11,t,s),e.storePointerofObjectwithValue(12,t,o),e.storePointerofObjectwithValue(13,t,u),e.storePointerofObjectwithValue(14,t,k),e.storePointerofObjectwithValue(15,t,f),e.storeIntegerofObjectwithValue(16,t,v),e.storeIntegerofObjectwithValue(17,t,I),e.storeIntegerofObjectwithValue(18,t,P),e.failed()===!1)}function gt(k){var h,r,a,u,l,e,p,d,m,v,i;t=k,v=.6*n(t[Qe]),i=.6*n(t[Ye]),h=.4*n(t[lt]),a=.15*n(t[ot]),l=.06*n(t[st]),p=.04*n(t[rt]),r=.15*n(t[Me]),u=.06*n(t[at]),e=.04*n(t[nt]),d=.022*n(t[et]),m=.03*n(t[$e]),s>=8&&(f>=16e3?c($,7500,600):s=6),s>=7&&(f>=16e3?c(ee,6500,500):s=6),s>=6&&c(ie,t[we],t[ze]),s>=5&&c(ae,t[Ce],t[Ue]),c(fe,t[D],t[le]),c(de,t[W],t[oe]),c(be,t[_],t[se]),c(Ve,t[Oe],t[ne]),c(Q,t[je],t[me]),c(J,t[qe],t[ke]),L(Y,t[We],t[Ee]),L(G,t[ut],t[Re]),o(Z,t[je],t[me],v),o(U,t[qe],t[ke],i),o(Se,t[Oe],t[ne],h),o(ve,t[_],t[se],a),o(he,t[W],t[oe],l),o(ue,t[D],t[le],p),o(ge,t[_],t[Xe],r),o(pe,t[W],t[He],u),o(ce,t[D],t[Je],e),o(re,t[Ce],t[Ge],d),o(te,t[we],t[Ke],m)}function kt(i){var t;return e=i,t=e.majorVersion()==pt,t===!1?!1:t=e.minorVersion()>=ct}function vt(_,N,B){var P,x,S,V,w,C,d,g,h,r,e,c,v,u,s,j,k,a,F;for(gt(_),l>0?(F=n(t[q]-7),v=n(t[q]),k=.1*n(t[ht])):F=v=k=0,w=.25*n(t[Be]),x=.05*n(t[Ze]),V=.05*n(t[Wt]),d=t[Ne]-3,0>=d&&(d=57),P=n(d),o(H,0,f,P),r=y,h=B,j=M+B-1;j>=h;)r=(O()-32768)/4,r+=.75*y,y=r,p>m&&(r=.5*r),C=w*r,a=wt(),T=a,b>p&&(a+=k*(O()-32768)/4),g=F*a,c=v*a,S=x*r,g+=S,c+=S,e=xt(g),u=c,e+=It(u),u=C+c-A,A=c,e=At(u)-e,e=V*u-e,e=i(H,e),s=e*P|0,-32768>s&&(s=-32768),s>32767&&(s=32767),N[h-1]=s,++h,++I}function mt(){l=t[g],Nt(),Mt(),Bt(),0>l&&(l=0),a=f/l|0,m=a,t[q]>0&&(m>>=1),b=a*t[C]|0,yt(t[C],t[tt],t[it]),qt(),_t()}function dt(n,s,a,o){var r,i,l,u,t,e,c;if(u=k(0,n,s,a,o),u>0)for(t=0,e=1,r=u,i=k(e,n,s,a,o);i>0;)t=e,r=i,e=2*e,i=k(e,n,s,a,o);else for(t=-1,e=0,r=k(t,n,s,a,o),i=u;0>r;)e=t,i=r,t=2*t,r=k(t,n,s,a,o);for(;e-t>Te;)c=(e+t)/2,l=k(c,n,s,a,o),l>0?(t=c,r=l):(e=c,i=l);return(e+t)/2}var pt=1,ct=11,lt=46,Me=34,ot=47,at=35,st=48,nt=36,rt=49,et=37,$e=38,Qe=45,Ze=9,Ye=50,ne=13,se=17,Xe=40,oe=19,He=41,le=21,Je=42,Ue=23,Ge=43,ze=25,Ke=44,me=27,Ee=29,ke=31,Re=33,Wt=39,B=4,Te=1e-4,g=0,Oe=12,_=16,W=18,D=20,Ce=22,we=24,De=1,je=26,We=28,Be=10,qe=30,ut=32,Ne=51,_e=2,h=3.141592653589793,Ve=12,Se=3,be=13,ge=7,ve=4,de=14,pe=8,he=5,fe=15,ce=9,ue=6,ae=16,re=10,ie=17,te=11,ee=18,$=19,tt=7,it=8,Q=20,Z=1,Y=21,C=6,H=24,J=22,U=2,G=23,ft=3,ht=11,q=5,S=0,F=0,V=0,w=0,s=0,t=null,A=0,e=null,Ft="Klatt 3 November 2014 (e)",y=0,m=0,b=0,p=0,v=0,l=0,u=null,I=0,M=0,f=0,P=0,a=0,T=0,r=0,d=0;Squeak.registerExternalModule("Klatt",{setInterpreter:kt,primitiveSynthesizeFrameIntoStartingAt:St,getModuleName:Vt})}),module("users.bert.SqueakJS.plugins.LargeIntegers").requires("users.bert.SqueakJS.vm").toRun(function(){function s(t){return"number"==typeof t?e.classSmallInteger():t.sqClass}function i(e){return e.bytes?e.bytes.length:e.words?4*e.words.length:0}function O(e,t){return 0|Math.floor(e/t)}function c(e,t){return e-O(e,t)*t|0}function m(t,e){return e>31?0:t<<e}function u(t,e){return e>31?0:t>>>e}function Se(v,o,p){var a,h,t,l,f,i,s,d,n;if(1>o||1>p)return e.primitiveFail();if(t=v,s=Math.min(p,Fe(t)),o>s)return!1;if(i=(o-1>>3)+1,a=(s-1>>3)+1,f=c(o-1,8),l=7-c(s-1,8),i===a)return d=m(255,f)&u(255,l),h=r(t,i),0!==(h&d);if(0!==u(r(t,i),f))return!0;for(n=i+1;a-1>=n;n++)if(0!==r(t,n))return!0;return 0!==(255&m(r(t,a),l))?!0:!1}function v(t,r){var n,o,a;return a=e.instantiateClassindexableSize(s(t),r),n=i(t),o=r>n?n:r,q(t.bytes,a.bytes,o),a}function A(i,n){var s,r,t;return"number"==typeof i?(r=i,s=0>r?e.classLargeNegativeInteger():e.classLargePositiveInteger(),t=e.instantiateClassindexableSize(s,n),be(r,t)):t=v(i,n),t}function be(t,n){var i,e,r;for(i=n.bytes,e=1,r=b(t);r>=e;e++)i[e-1]=o(t,e)}function ge(a,r,n,o,s){var e,i,t;for(t=0,i=r-1,e=0;i>=e;e++)t=(t>>>8)+a[e]+n[e],s[e]=255&t;for(i=o-1,e=r;i>=e;e++)t=(t>>>8)+n[e],s[e]=255&t;return t>>>8}function V(r,n,s){var t,i,e;for(e=s-1;e>=0;){if((i=n[e])!==(t=r[e]))return t>i?1:-1;--e}return 0}function q(i,r,n){var t,e;for(t=n-1,e=0;t>=e;e++)r[e]=i[e];return 0}function me(d,k,o,A,I,y){var m,a,s,f,t,n,F,g,b,r,p,i,e,u,S,h,l,v;for(u=k-1,S=y,l=d[u-1],f=1===u?0:d[u-2],p=1;S>=p;p++){if(i=A+1-p,o[i-1]===l)a=255;else for(h=o[i-1],h=(h<<8)+o[i-2],v=c(h,l),a=O(h,l),g=a*f,n=g>>>8,t=255&g,F=3>i?0:o[i-3];;){if(n>v||v===n&&t>F?(--a,f>t?(--n,t=t+256-f):t-=f,b=n>=l):b=!1,!b)break;n-=l}for(r=i-u,s=0,e=1;k>=e;e++)n=d[e-1]*(a>>>8),t=d[e-1]*(255&a),m=o[r-1]-s-(255&t),o[r-1]=255&m,m>>=8,s=n+(t>>>8)-m,++r;if(s>0)for(--a,r=i-u,s=0,e=1;k>=e;e++)s=(s>>>8)+o[r-1]+d[e-1],o[r-1]=255&s,++r;I[y-p]=a}return 0}function g(i,r){var t,e;for(e=r;0===(t=i[e-1]);)if(0===--e)return 0;return I(t)+8*(e-1)}function b(e){return 256>e&&e>-256?1:65536>e&&e>-65536?2:16777216>e&&e>-16777216?3:4}function E(h,o,p,r,l){var s,t,a,e,i,f,n;for(s=h>>3,i=c(h,8),n=s-1,e=0;n>=e;e++)r[e]=0;if(0===i)return S(r,s,l-1,o,0);for(f=8-i,t=0,n=p-1,e=0;n>=e;e++)a=o[e],r[e+s]=255&(t|m(a,i)),t=u(a,f);return 0!==t&&(r[l-1]=t),0}function R(m,u,d,l,n,c,f,r){var t,i,o,s,h,p,a,e;for(p=u-1,h=l-1,s=c-1,o=0,i=0;p>=i;i++){for(e=r[0]+m[i]*d[0],a=e*f&255,e+=a*n[0],t=1;h>=t;t++)e=(e>>>8)+r[t]+m[i]*d[t]+a*n[t],r[t-1]=255&e;for(t=l;s>=t;t++)e=(e>>>8)+r[t]+a*n[t],r[t-1]=255&e;e=(e>>>8)+o,r[s]=255&e,o=e>>>8}for(i=u;s>=i;i++){for(e=r[0],a=e*f&255,e+=a*n[0],t=1;s>=t;t++)e=(e>>>8)+r[t]+a*n[t],r[t-1]=255&e;e=(e>>>8)+o,r[s]=255&e,o=e>>>8}if(0!==o||1!==V(n,r,c))for(e=0,i=0;s>=i;i++)e=e+r[i]-n[i],r[i]=255&e,e>>=8}function L(l,a,f,u,s){var e,r,o,n,t,c,i,h;if(1===a&&0===l[0])return 0;if(1===u&&0===f[0])return 0;for(h=a-1,c=u-1,t=0;h>=t;t++)if(0!==(o=l[t])){for(i=t,n=0,r=0;c>=r;r++)e=f[r],e=e*o+n+s[i],n=e>>>8,s[i]=255&e,++i;s[i]=n}return 0}function o(i,t){return 1>t&&e.primitiveFail(),t>4?0:0>i?255&u(0-i,8*(t-1)):255&u(i,8*(t-1))}function T(a,o,s,n,u,r){var t,i;if(i=s-1,a===C){for(t=0;i>=t;t++)r[t]=o[t]&n[t];for(i=u-1,t=s;i>=t;t++)r[t]=0;return 0}if(a===F){for(t=0;i>=t;t++)r[t]=o[t]|n[t];for(i=u-1,t=s;i>=t;t++)r[t]=n[t];return 0}if(a===P){for(t=0;i>=t;t++)r[t]=o[t]^n[t];for(i=u-1,t=s;i>=t;t++)r[t]=n[t];return 0}return e.primitiveFail()}function S(t,e,i,r,n){return function(){for(var a=i-e+1,s=0;a>s;s++)t[s+e]=r[s+n];return 0}()}function D(p,a,d,o,l){var t,r,i,n,e,f,h,s;if(r=p>>3,e=c(p,8),0===e)return S(o,0,l-1,a,r);for(f=8-e,i=u(a[r],e),s=r+1,h=d-1,t=s;h>=t;t++)n=a[t],o[t-s]=255&(i|m(n,f)),i=u(n,e);return 0!==i&&(o[l-1]=i),0}function ie(s,i,r,a,n){var e,t;for(t=0,e=0;i-1>=e;e++)t=t+r[e]-s[e],n[e]=255&t,t>>=8;for(e=i;a-1>=e;e++)t+=r[e],n[e]=255&t,t>>=8}function I(i){var e,t;return e=i,t=0,65536>e||(e>>>=16,t+=16),256>e||(e>>>=8,t+=8),16>e||(e>>>=4,t+=4),4>e||(e>>>=2,t+=2),2>e||(e>>>=1,++t),t+e}function t(u){var r,n,s,t,a,i;for(i=u,a=0>i?e.classLargeNegativeInteger():e.classLargePositiveInteger(),r=b(i),n=e.instantiateClassindexableSize(a,r),s=n.bytes,t=1;r>=t;t++)s[t-1]=o(i,t);return n}function h(t,o){var r,n,a,u;return n=i(t),0===(u=g(t.bytes,n))?0:(r=u+o+7>>3,a=e.instantiateClassindexableSize(s(t),r),E(o,t.bytes,n,a.bytes,r),a)}function d(t,o,l){var i,u,r,n,a;return a=g(t.bytes,l),u=a+7>>3,n=a-o,0>=n?e.instantiateClassindexableSize(s(t),0):(r=n+7>>3,i=e.instantiateClassindexableSize(s(t),r),D(o,t.bytes,u,i.bytes,r),i)}function w(n,l){var r,h,p,u,d,c,t,a,o,f;return a=i(n),o=i(l),d=s(n),o>=a?(u=n,h=a,f=l,t=o):(u=l,h=o,f=n,t=a),r=e.instantiateClassindexableSize(d,t),p=ge(u.bytes,h,f.bytes,t,r.bytes),p>0&&(c=e.instantiateClassindexableSize(d,t+1),q(r.bytes,c.bytes,t),r=c,r.bytes[t]=p),r}function p(n,a,v){var p,h,o,r,u,d,c,f,m;if("number"==typeof n){if(0>n)return e.primitiveFail();o=t(n)}else{if(s(n)===e.classLargeNegativeInteger())return e.primitiveFail();o=n}if("number"==typeof a){if(0>a)return e.primitiveFail();r=t(a)}else{if(s(a)===e.classLargeNegativeInteger())return e.primitiveFail();r=a}return c=i(o),f=i(r),f>c?(p=c,h=o,u=f,d=r):(p=f,h=r,u=c,d=o),m=e.instantiateClassindexableSize(e.classLargePositiveInteger(),u),T(v,h.bytes,p,d.bytes,u,m.bytes),e.failed()?0:l(m)}function j(r,n){var t,e;return e=i(r),t=i(n),t!==e?t>e?-1:1:V(r.bytes,n.bytes,e)}function x(m,c,k){var v,r,t,s,o,l,f,p,u;return u=i(m),p=i(c),v=k?e.classLargeNegativeInteger():e.classLargePositiveInteger(),f=u-p+1,0>=f?(r=e.instantiateClassindexableSize(e.classArray(),2),e.stObjectatput(r,1,0),e.stObjectatput(r,2,m),r):(l=8-I(n(c,p)),s=h(c,l),s=A(s,a(s)+1),t=h(m,l),a(t)===u&&(t=A(t,u+1)),o=e.instantiateClassindexableSize(v,f),me(s.bytes,a(s),t.bytes,a(t),o.bytes,a(o)),t=d(t,l,a(s)-1),r=e.instantiateClassindexableSize(e.classArray(),2),e.stObjectatput(r,1,o),e.stObjectatput(r,2,t),r)}function a(e){return"number"==typeof e?b(e):i(e)}function W(o,u,c,r){var n,t,s,a;return s=i(o),a=i(u),t=i(c),t>=s&&t>=a&&r>=0&&255>=r?(n=e.instantiateClassindexableSize(e.classLargePositiveInteger(),t),R(o.bytes,s,u.bytes,a,c.bytes,t,r,n.bytes),l(n)):e.primitiveFail()}function B(c,a,p){var u,h,t,o,s,l,n,r;return r=i(c),n=i(a),n>=r?(o=c,t=r,u=a,s=n):(o=a,t=n,u=c,s=r),h=p?e.classLargeNegativeInteger():e.classLargePositiveInteger(),l=e.instantiateClassindexableSize(h,s+t),L(o.bytes,t,u.bytes,s,l.bytes),f(l)}function r(e,t){return t>i(e)?0:n(e,t)}function M(a,o){var m,d,u,h,v,c,p,t,n,f;if(p=s(a)===e.classLargeNegativeInteger(),t=i(a),n=i(o),t===n){for(;t>1&&r(a,t)===r(o,t);)--t;n=t}return n>t||t===n&&r(a,t)<r(o,t)?(d=o,c=n,h=a,m=t,f=p===!1):(d=a,c=t,h=o,m=n,f=p),v=c,u=e.instantiateClassindexableSize(f?e.classLargeNegativeInteger():e.classLargePositiveInteger(),v),ie(h.bytes,m,d.bytes,c,u.bytes),f?y(u):l(u)}function k(){return ye}function Fe(e){return g(e.bytes,i(e))}function N(i){var r,u,t,l,c;if("number"==typeof i)return!0;if(u=a(i),0===u)return!1;if(0===n(i,u))return!1;if(t=4,u>t)return!0;if(t>u)return!1;if(s(i)===e.classLargePositiveInteger())return c=1073741823,n(i,t)>o(c,t);if(l=-1073741824,n(i,t)<o(l,t))return!1;for(r=1;t>=r;r++)if(n(i,r)!==o(l,r))return!0;return!1}function f(t){return s(t)===e.classLargePositiveInteger()?l(t):y(t)}function y(t){var i,e,s,u,c,l;for(e=c=a(t);0!==e&&0===n(t,e);)--e;if(0===e)return 0;if(s=4,s>=e){if(u=-1073741824,s>e||r(t,s)<o(u,s)){for(l=0,i=e;i>=1;i+=-1)l=256*l-n(t,i);return l}for(i=1;s>=i;i++)if(r(t,i)!==o(u,i))return c>e?v(t,e):t;return u}return c>e?v(t,e):t}function l(t){var i,e,s,u,l;for(e=l=a(t);0!==e&&0===n(t,e);)--e;if(0===e)return 0;if(s=4,s>=e&&r(t,s)<=o(1073741823,s)){for(u=0,i=e;i>=1;i+=-1)u=256*u+n(t,i);return u}return l>e?v(t,e):t}function K(){var i,r,n,s,a;return n=e.stackIntegerValue(1),s=e.stackIntegerValue(0),e.success(e.isKindOfInteger(e.stackValue(2))),i=e.stackValue(2),e.failed()?null:(r="number"==typeof i?t(i):i,a=Se(r,n,s)?e.trueObject():e.falseObject(),e.failed()?null:(e.popthenPush(3,a),null))}function z(){var i,r;return e.success(e.isKindOfInteger(e.stackValue(0))),i=e.stackValue(0),e.failed()?null:"number"==typeof i?(r=t(i),e.failed()?null:(e.popthenPush(2,r),null)):e.failed()?null:(e.popthenPush(2,i),null)}function G(){var t;return t=e.trueObject(),e.failed()?null:(e.popthenPush(1,t),null)}function U(){var o,r,n,s,a;return e.success(e.isKindOfInteger(e.stackValue(1))),n=e.stackValue(1),s=e.stackIntegerValue(0),e.failed()?null:(r="number"==typeof n?t(n):n,s>=0?(a=h(r,s),e.failed()?null:(e.popthenPush(3,a),null)):(o=0-s,a=f(d(r,o,i(r))),e.failed()?null:(e.popthenPush(3,a),null)))}function J(){var n,i,s,r,a;return e.success(e.isKindOfInteger(e.stackValue(0))),r=e.stackValue(0),e.success(e.isKindOfInteger(e.stackValue(1))),i=e.stackValue(1),e.failed()?null:(n="number"==typeof i?t(i):i,s="number"==typeof r?t(r):r,a=w(n,s),e.failed()?null:(e.popthenPush(2,a),null))}function H(){var n,s,i,r,a;return e.success(e.isKindOfInteger(e.stackValue(1))),i=e.stackValue(1),e.success(e.isKindOfInteger(e.stackValue(0))),r=e.stackValue(0),e.failed()?null:(n="number"==typeof i?t(i):i,s="number"==typeof r?t(r):r,a=w(n,s),e.failed()?null:(e.popthenPush(3,a),null))}function X(){var t,i,r;return e.success(e.isKindOfInteger(e.stackValue(0))),i=e.stackValue(0),e.success(e.isKindOfInteger(e.stackValue(1))),t=e.stackValue(1),e.failed()?null:(r=p(t,i,C),e.failed()?null:(e.popthenPush(2,r),null))}function Y(){var t,i,r,n;return e.success(e.isKindOfInteger(e.stackValue(2))),t=e.stackValue(2),e.success(e.isKindOfInteger(e.stackValue(1))),i=e.stackValue(1),r=e.stackIntegerValue(0),e.failed()?null:(n=p(t,i,r),e.failed()?null:(e.popthenPush(4,n),null))}function Z(){
var t,i,r;return e.success(e.isKindOfInteger(e.stackValue(0))),i=e.stackValue(0),e.success(e.isKindOfInteger(e.stackValue(1))),t=e.stackValue(1),e.failed()?null:(r=p(t,i,F),e.failed()?null:(e.popthenPush(2,r),null))}function Q(){var r,o,n,s,a;return s=e.stackIntegerValue(0),e.success(e.isKindOfInteger(e.stackValue(1))),n=e.stackValue(1),e.failed()?null:(r="number"==typeof n?t(n):n,s>=0?(a=h(r,s),e.failed()?null:(e.popthenPush(2,a),null)):(o=0-s,a=f(d(r,o,i(r))),e.failed()?null:(e.popthenPush(2,a),null)))}function $(){var r,o,n,s,a;return s=e.stackIntegerValue(0),e.success(e.isKindOfInteger(e.stackValue(1))),n=e.stackValue(1),e.failed()?null:(r="number"==typeof n?t(n):n,s>=0?(a=h(r,s),e.failed()?null:(e.popthenPush(2,a),null)):(o=0-s,a=f(d(r,o,i(r))),e.failed()?null:(e.popthenPush(2,a),null)))}function ee(){var t,i,r;return e.success(e.isKindOfInteger(e.stackValue(0))),i=e.stackValue(0),e.success(e.isKindOfInteger(e.stackValue(1))),t=e.stackValue(1),e.failed()?null:(r=p(t,i,P),e.failed()?null:(e.popthenPush(2,r),null))}function te(){var n,r,s,i,t;return e.success(e.isKindOfInteger(e.stackValue(0))),i=e.stackValue(0),e.success(e.isKindOfInteger(e.stackValue(1))),r=e.stackValue(1),e.failed()?null:"number"==typeof r?"number"==typeof i?(n=r)>(s=i)?(t=1,e.failed()?null:(e.popthenPush(2,t),null)):s>n?(t=-1,e.failed()?null:(e.popthenPush(2,t),null)):(t=0,e.failed()?null:(e.popthenPush(2,t),null)):(t=-1,e.failed()?null:(e.popthenPush(2,t),null)):"number"==typeof i?(t=1,e.failed()?null:(e.popthenPush(2,t),null)):(t=j(r,i),e.failed()?null:(e.popthenPush(2,t),null))}function _(){var n,s,r,i,t;return e.success(e.isKindOfInteger(e.stackValue(1))),r=e.stackValue(1),e.success(e.isKindOfInteger(e.stackValue(0))),i=e.stackValue(0),e.failed()?null:"number"==typeof r?"number"==typeof i?(n=r)>(s=i)?(t=1,e.failed()?null:(e.popthenPush(3,t),null)):s>n?(t=-1,e.failed()?null:(e.popthenPush(3,t),null)):(t=0,e.failed()?null:(e.popthenPush(3,t),null)):(t=-1,e.failed()?null:(e.popthenPush(3,t),null)):"number"==typeof i?(t=1,e.failed()?null:(e.popthenPush(3,t),null)):(t=j(r,i),e.failed()?null:(e.popthenPush(3,t),null))}function re(){var s,r,n,i,a,o;if(e.success(e.isKindOfInteger(e.stackValue(1))),i=e.stackValue(1),a=e.booleanValueOf(e.stackValue(0)),e.success(e.isKindOfInteger(e.stackValue(2))),r=e.stackValue(2),e.failed())return null;if(!N(r))return e.primitiveFail(),null;if(!N(i))return e.primitiveFail(),null;if(s="number"==typeof r?t(r):r,"number"==typeof i){if(0===i)return e.primitiveFail(),null;n=t(i)}else n=i;return o=x(s,n,a),e.failed()?null:(e.popthenPush(3,o),null)}function ne(){var s,n,r,i,a,o;if(e.success(e.isKindOfInteger(e.stackValue(2))),r=e.stackValue(2),e.success(e.isKindOfInteger(e.stackValue(1))),i=e.stackValue(1),a=e.booleanValueOf(e.stackValue(0)),e.failed())return null;if(s="number"==typeof r?t(r):r,"number"==typeof i){if(0===i)return e.primitiveFail(),null;n=t(i)}else n=i;return o=x(s,n,a),e.failed()?null:(e.popthenPush(4,o),null)}function se(){var n,i,s,r,a,o;return e.success(e.isKindOfInteger(e.stackValue(1))),r=e.stackValue(1),a=e.booleanValueOf(e.stackValue(0)),e.success(e.isKindOfInteger(e.stackValue(2))),i=e.stackValue(2),e.failed()?null:(n="number"==typeof i?t(i):i,s="number"==typeof r?t(r):r,o=B(n,s,a),e.failed()?null:(e.popthenPush(3,o),null))}function ae(){var n,s,i,r,a,o;return e.success(e.isKindOfInteger(e.stackValue(2))),i=e.stackValue(2),e.success(e.isKindOfInteger(e.stackValue(1))),r=e.stackValue(1),a=e.booleanValueOf(e.stackValue(0)),e.failed()?null:(n="number"==typeof i?t(i):i,s="number"==typeof r?t(r):r,o=B(n,s,a),e.failed()?null:(e.popthenPush(4,o),null))}function oe(){var n,i,s,r,a;return e.success(e.isKindOfInteger(e.stackValue(0))),r=e.stackValue(0),e.success(e.isKindOfInteger(e.stackValue(1))),i=e.stackValue(1),e.failed()?null:(n="number"==typeof i?t(i):i,s="number"==typeof r?t(r):r,a=M(n,s),e.failed()?null:(e.popthenPush(2,a),null))}function ue(){var n,s,i,r,a;return e.success(e.isKindOfInteger(e.stackValue(1))),i=e.stackValue(1),e.success(e.isKindOfInteger(e.stackValue(0))),r=e.stackValue(0),e.failed()?null:(n="number"==typeof i?t(i):i,s="number"==typeof r?t(r):r,a=M(n,s),e.failed()?null:(e.popthenPush(3,a),null))}function le(){var n,i,t,r;for(i=strlen(k()),r=e.instantiateClassindexableSize(e.classString(),i),n=r.bytes,t=0;i-1>=t;t++)n[t]=k()[t];return e.failed()?null:(e.popthenPush(1,r),null)}function ce(){var s,a,i,o,r,n,u,l;return e.success(e.isKindOfInteger(e.stackValue(2))),r=e.stackValue(2),e.success(e.isKindOfInteger(e.stackValue(1))),n=e.stackValue(1),u=e.stackIntegerValue(0),e.success(e.isKindOfInteger(e.stackValue(3))),i=e.stackValue(3),e.failed()?null:(s="number"==typeof i?t(i):i,a="number"==typeof r?t(r):r,o="number"==typeof n?t(n):n,l=W(s,a,o,u),e.failed()?null:(e.popthenPush(4,l),null))}function fe(){var t,i;return e.success(e.isKindOfInteger(e.stackValue(0))),t=e.stackValue(0),e.failed()?null:"number"==typeof t?e.failed()?null:(e.popthenPush(2,t),null):(i=f(t),e.failed()?null:(e.popthenPush(2,i),null))}function he(){var t,i;return e.success(e.stackValue(0).sqClass===e.classLargeNegativeInteger()),t=e.stackValue(0),e.failed()?null:(i=y(t),e.failed()?null:(e.popthenPush(1,i),null))}function pe(){var t,i;return e.success(e.stackValue(0).sqClass===e.classLargePositiveInteger()),t=e.stackValue(0),e.failed()?null:(i=l(t),e.failed()?null:(e.popthenPush(1,i),null))}function de(i){var t;return e=i,t=e.majorVersion()==ve,t===!1?!1:t=e.minorVersion()>=ke}function n(e,t){var i;return(i=e.bytes)[t-1]}var ve=1,ke=11,C=0,e=null,ye="LargeIntegers v1.5 (e)",F=1,P=2;Squeak.registerExternalModule("LargeIntegers",{primDigitAddWith:H,primDigitBitShiftMagnitude:$,primGetModuleName:le,primDigitBitLogicWithOp:Y,primCheckIfCModuleExists:G,primDigitCompare:te,primDigitMultiplyNegative:se,primDigitBitShift:Q,primNormalizePositive:pe,primDigitSubtractWith:ue,_primDigitBitShift:U,primDigitMultiplyWithNegative:ae,primDigitSubtract:oe,primDigitDivNegative:re,primNormalizeNegative:he,primDigitBitOr:Z,primMontgomeryTimesModulo:ce,primDigitBitAnd:X,primDigitDivWithNegative:ne,setInterpreter:de,primNormalize:fe,primDigitBitXor:ee,primDigitCompareWith:_,primDigitAdd:J,getModuleName:k,primAsLargeInteger:z,primAnyBitFromTo:K})}),module("users.bert.SqueakJS.plugins.Matrix2x3Plugin").requires("users.bert.SqueakJS.vm").toRun(function(){function u(t){return"number"==typeof t?e.classSmallInteger():t.sqClass}function f(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function v(){return A}function s(t){return e.failed()?null:e.isWords(t)&&6===f(t)?t.wordsAsFloat32Array():(e.primitiveFail(),null)}function a(s){var i,t;return e.failed()?null:u(s)!==e.classPoint()?e.primitiveFail():(t=e.fetchPointerofObject(0,s),i="number"==typeof t,i||t.isFloat?(n=i?t:e.floatValueOf(t),t=e.fetchPointerofObject(1,s),i="number"==typeof t,i||t.isFloat?void(r=i?t:e.floatValueOf(t)):e.primitiveFail()):e.primitiveFail())}function k(e,t,i){var r,n,s,a,o,u;r=e[0]*t[0]+e[1]*t[3],n=e[0]*t[1]+e[1]*t[4],s=e[0]*t[2]+e[1]*t[5]+e[2],a=e[3]*t[0]+e[4]*t[3],o=e[3]*t[1]+e[4]*t[4],u=e[3]*t[2]+e[4]*t[5]+e[5],i[0]=r,i[1]=n,i[2]=s,i[3]=a,i[4]=o,i[5]=u}function l(s){var a,l,c,o,u;return o=n-s[2],u=r-s[5],a=s[0]*s[4]-s[1]*s[3],0===a?e.primitiveFail():(a=1/a,l=o*s[4]-s[1]*u,c=s[0]*u-o*s[3],t=l*a,void(i=c*a))}function c(e){t=n*e[0]+r*e[1]+e[2],i=n*e[3]+r*e[4]+e[5]}function o(e){return e>=-1073741824&&1073741823>=t}function S(){var t,i,r,n;return r=s(n=e.stackObjectValue(0)),i=s(e.stackObjectValue(1)),t=s(e.stackObjectValue(2)),e.failed()?null:(k(t,i,r),void e.popthenPush(3,n))}function F(){var t;return a(e.stackObjectValue(0)),t=s(e.stackObjectValue(1)),e.failed()?null:(l(t),void(e.failed()||p(2)))}function O(){var S,g,k,v,d,o,p,c,b,y,m;return k=e.stackObjectValue(0),m=e.stackObjectValue(1),v=s(e.stackObjectValue(2)),e.failed()?null:u(m)!==u(k)?e.primitiveFail():e.isPointers(m)?2!==f(m)?e.primitiveFail():(a(e.fetchPointerofObject(0,m)),e.failed()?null:(b=n,y=r,l(v),p=d=t,c=o=i,a(e.fetchPointerofObject(1,m)),e.failed()?null:(S=n,g=r,l(v),p=Math.min(p,t),d=Math.max(d,t),c=Math.min(c,i),o=Math.max(o,i),n=S,r=y,l(v),p=Math.min(p,t),d=Math.max(d,t),c=Math.min(c,i),o=Math.max(o,i),n=b,r=g,l(v),p=Math.min(p,t),d=Math.max(d,t),c=Math.min(c,i),o=Math.max(o,i),e.failed()||(k=h(k,p,c,d,o)),void(e.failed()||e.popthenPush(3,k))))):e.primitiveFail()}function I(){var t;return t=s(e.stackObjectValue(0)),e.failed()?null:(e.pop(1),void e.pushBool(1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]))}function P(){var t;return t=s(e.stackObjectValue(0)),e.failed()?null:(e.pop(1),void e.pushBool(1===t[0]&&0===t[1]&&0===t[3]&&1===t[4]))}function d(){var t;return a(e.stackObjectValue(0)),t=s(e.stackObjectValue(1)),e.failed()?null:(c(t),void p(2))}function m(){var S,g,k,v,d,o,p,l,b,y,m;return k=e.stackObjectValue(0),m=e.stackObjectValue(1),v=s(e.stackObjectValue(2)),e.failed()?null:u(m)!==u(k)?e.primitiveFail():e.isPointers(m)?2!==f(m)?e.primitiveFail():(a(e.fetchPointerofObject(0,m)),e.failed()?null:(b=n,y=r,c(v),p=d=t,l=o=i,a(e.fetchPointerofObject(1,m)),e.failed()?null:(S=n,g=r,c(v),p=Math.min(p,t),d=Math.max(d,t),l=Math.min(l,i),o=Math.max(o,i),n=S,r=y,c(v),p=Math.min(p,t),d=Math.max(d,t),l=Math.min(l,i),o=Math.max(o,i),n=b,r=g,c(v),p=Math.min(p,t),d=Math.max(d,t),l=Math.min(l,i),o=Math.max(o,i),k=h(k,p,l,d,o),void(e.failed()||e.popthenPush(3,k))))):e.primitiveFail()}function p(r){return t+=.5,i+=.5,o(t)&&o(i)?void e.popthenPush(r,e.makePointwithxValueyValue(0|t,0|i)):e.primitiveFail()}function h(p,l,h,f,c){var u,r,a,s,n,i,t;return s=l+.5,o(s)?(r=f+.5,o(r)?(n=h+.5,o(n)?(a=c+.5,o(a)?(e.pushRemappableOop(p),i=e.makePointwithxValueyValue(0|s,0|n),e.pushRemappableOop(i),u=e.makePointwithxValueyValue(0|r,0|a),i=e.popRemappableOop(),t=e.popRemappableOop(),e.storePointerofObjectwithValue(0,t,i),e.storePointerofObjectwithValue(1,t,u),t):e.primitiveFail()):e.primitiveFail()):e.primitiveFail()):e.primitiveFail()}function g(i){var t;return e=i,t=e.majorVersion()==b,t===!1?!1:t=e.minorVersion()>=y}var b=1,y=11,e=null,n=0,r=0,t=0,i=0,A="Matrix2x3Plugin 3 November 2014 (e)";Squeak.registerExternalModule("Matrix2x3Plugin",{primitiveInvertPoint:F,primitiveInvertRectInto:O,primitiveIsIdentity:I,primitiveComposeMatrix:S,setInterpreter:g,primitiveTransformRectInto:m,primitiveIsPureTranslation:P,getModuleName:v,primitiveTransformPoint:d})}),module("users.bert.SqueakJS.plugins.MiscPrimitivePlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function g(e,t){return 0|Math.floor(e/t)}function c(e,t){return e-g(e,t)*t|0}function n(t,e){return e>31?0:t>>>e}function i(i,r,t){var e;for(e=0;3>=e;e++)r[t+e-1]=255&n(i,8*(3-e));return t+4}function t(t,r,e){return 223>=t?(r[e-1]=t,e+1):7935>=t?(r[e-1]=(t>>8)+224,r[e]=c(t,256),e+2):(r[e-1]=255,i(t,r,e+1))}function s(){return b}function a(){var l,n,s,a,o,u,t,i,r;if(l=e.stackValue(3),n=e.stackBytes(2),s=e.stackBytes(1),a=e.stackBytes(0),e.failed())return null;for(i=n.length,r=s.length,t=1;t<=Math.min(i,r);t++)if(o=a[n[t-1]],u=a[s[t-1]],o!==u)return u>o?e.failed()?null:(e.popthenPush(4,1),null):e.failed()?null:(e.popthenPush(4,3),null);return i===r?e.failed()?null:(e.popthenPush(4,2),null):r>i?e.failed()?null:(e.popthenPush(4,1),null):e.failed()?null:(e.popthenPush(4,3),null)}function o(){var p,u,a,h,r,n,s,l,f,c,o;if(p=e.stackValue(2),u=e.stackInt32Array(1),a=e.stackBytes(0),e.failed())return null;for(c=u.length,r=t(c,a,1),s=1;c>=s;){for(o=u[s-1],l=255&o,h=(o>>>8&255)===l&&(o>>>16&255)===l&&(o>>>24&255)===l,n=s;c>n&&o===u[n];)++n;if(n>s)h?(r=t(4*(n-s+1)+1,a,r),a[r-1]=l,++r):(r=t(4*(n-s+1)+2,a,r),r=i(o,a,r)),s=n+1;else if(h)r=t(5,a,r),a[r-1]=l,++r,++s;else{for(;c>n&&u[n-1]!==u[n];)++n;for(n===c&&++n,r=t(4*(n-s)+3,a,r),f=s;n-1>=f;f++)r=i(u[f-1],a,r);s=n}}return e.failed()?null:(e.popthenPush(3,r-1),null)}function u(){var a,r,n,t,s,i;if(a=e.stackValue(2),r=e.stackBytes(1),n=e.stackUint16Array(0),e.failed())return null;for(s=r.length,t=1;s>=t;t++)i=r[t-1],i>127?n[t-1]=i-256<<8:n[t-1]=i<<8;return e.failed()?null:void e.pop(2)}function l(){var d,o,a,h,n,l,i,f,r,t,s,c,u,p;if(d=e.stackValue(3),o=e.stackInt32Array(2),a=e.stackBytes(1),h=e.stackIntegerValue(0),e.failed())return null;for(r=h,f=a.length,s=1,p=o.length+1;f>=r;){if(n=a[r-1],++r,!(223>=n))if(254>=n)n=256*(n-224)+a[r-1],++r;else for(n=0,t=1;4>=t;t++)n=(n<<8)+a[r-1],++r;if(u=n>>>2,s+u>p)return e.primitiveFail(),null;if(l=3&n,1===l)for(i=a[r-1],++r,i|=i<<8,i|=i<<16,t=1;u>=t;t++)o[s-1]=i,++s;if(2===l){for(i=0,t=1;4>=t;t++)i=i<<8|a[r-1],++r;for(t=1;u>=t;t++)o[s-1]=i,++s}if(3===l)for(c=1;u>=c;c++){for(i=0,t=1;4>=t;t++)i=i<<8|a[r-1],++r;o[s-1]=i,++s}}return e.failed()?null:void e.pop(3)}function r(){var a,i,r,s,t,n;if(a=e.stackValue(3),i=e.stackBytes(2),r=e.stackBytes(1),s=e.stackIntegerValue(0),e.failed())return null;if(256!==r.length)return e.failed()?null:(e.popthenPush(4,0),null);for(t=s,n=i.length;n>=t&&0===r[i[t-1]];)++t;return t>n?e.failed()?null:(e.popthenPush(4,0),null):e.failed()?null:(e.popthenPush(4,t),null)}function f(){var o,t,n,a,s,i,r;if(o=e.stackValue(4),t=e.stackBytes(3),n=e.stackBytes(2),a=e.stackIntegerValue(1),s=e.stackBytes(0),e.failed())return null;if(0===t.length)return e.failed()?null:(e.popthenPush(5,0),null);for(r=a;r<=n.length-t.length+1;r++)for(i=1;s[n[r+i-1-1]]===s[t[i-1]];){if(i===t.length)return e.failed()?null:(e.popthenPush(5,r),null);++i}return e.failed()?null:(e.popthenPush(5,0),null)}function h(){var a,r,i,n,t,s;if(a=e.stackValue(3),r=e.stackIntegerValue(2),i=e.stackBytes(1),n=e.stackIntegerValue(0),e.failed())return null;for(s=i.length,t=n;s>=t;t++)if(i[t-1]===r)return e.failed()?null:(e.popthenPush(4,t),null);return e.failed()?null:(e.popthenPush(4,0),null)}function p(){var o,r,s,a,t,n,i;if(o=e.stackValue(2),r=e.stackBytes(1),s=e.stackIntegerValue(0),e.failed())return null;for(a=r.length,t=268435455&s,i=1;a>=i;i++)t+=r[i-1],n=16383&t,t=9741*n+16384*(9741*(t>>>14)+101*n&16383)&268435455;return e.failed()?null:(e.popthenPush(3,t),null)}function d(){var a,i,r,n,s,t;if(a=e.stackValue(4),i=e.stackBytes(3),r=e.stackIntegerValue(2),n=e.stackIntegerValue(1),s=e.stackBytes(0),e.failed())return null;for(t=r;n>=t;t++)i[t-1]=s[i[t-1]];return e.failed()?null:void e.pop(4)}function m(i){var t;return e=i,t=e.majorVersion()==v,t===!1?!1:t=e.minorVersion()>=k}var v=1,k=11,e=null,b="MiscPrimitivePlugin 3 November 2014 (e)";Squeak.registerExternalModule("MiscPrimitivePlugin",{primitiveConvert8BitSigned:u,primitiveCompareString:a,primitiveTranslateStringWithTable:d,primitiveStringHash:p,primitiveCompressToByteArray:o,primitiveFindSubstring:f,primitiveIndexOfAsciiInString:h,setInterpreter:m,primitiveDecompressFromByteArray:l,getModuleName:s,primitiveFindFirstInString:r})}),module("users.bert.SqueakJS.plugins.ScratchPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function r(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function t(e,t){return 0|Math.floor(e/t)}function n(e,i){return e-t(e,i)*i|0}function s(p,h,f,c,u){var l,r,i,e,a,o,s;return r=t(f,60),l=n(f,60),e=(1e3-c)*u,a=(1e3-t(c*l,60))*u,o=(1e3-t(c*(60-l),60))*u,s=t(1e3*u,3922),e=t(e,3922),a=t(a,3922),o=t(o,3922),0===r&&(i=(s<<16)+(o<<8)+e),1===r&&(i=(a<<16)+(s<<8)+e),2===r&&(i=(e<<16)+(s<<8)+o),3===r&&(i=(e<<16)+(a<<8)+s),4===r&&(i=(o<<16)+(e<<8)+s),5===r&&(i=(s<<16)+(e<<8)+a),0===i&&(i=1),p[h]=i,0}function l(t){return e.success(e.isWordsOrBytes(t)),e.failed()?0:t.wordsAsFloat64Array()}function i(t){return e.success(e.isWords(t)),e.failed()?0:t.words}function d(){return C}function a(r,n,a,o,s){var i,e;return e=s-o,0===e?0:(i=r===s?t(60*(n-a),e):n===s?120+t(60*(a-r),e):240+t(60*(r-n),e),0>i?i+360:i)}function o(e,t,i){var s,r,a,o,n;return 0===e?t:0===t?e:(r=1024-i,o=r*(e>>>16&255)+i*(t>>>16&255)>>10,a=r*(e>>>8&255)+i*(t>>>8&255)>>10,s=r*(255&e)+i*(255&t)>>10,n=(o<<16)+(a<<8)+s,0===n&&(n=1),n)}function u(l,c,h,u,f){var a,r,s,t,i,e,n;return t=c>>>10,-1>t||t>=u?0:(e=h>>>10,-1>e||e>=f?0:(i=1023&c,-1===t&&(t=0,i=0),t===u-1&&(i=0),n=1023&h,-1===e&&(e=0,n=0),e===f-1&&(n=0),r=e*u+t,s=16777215&l[r],i>0&&(s=o(s,16777215&l[r+1],i)),0===n?s:(r=(e+1)*u+t,a=16777215&l[r],i>0&&(a=o(a,16777215&l[r+1],i)),o(s,a,n))))}function c(){var f,c,l,h,b,g,m,n,y,p,k,u,v,d,o,a,s;if(m=e.stackValue(2),p=e.stackValue(1),o=e.stackIntegerValue(0),g=i(m),y=i(p),d=r(m),e.success(r(p)===d),e.failed())return null;for(b=t(d,o),s=1;b-2>=s;s++)for(a=1;o-2>=a;a++){for(n=v=h=f=0,l=-1;1>=l;l++)for(c=-1;1>=c;c++)u=16777215&g[(s+l)*o+(a+c)],0!==u&&(v+=u>>>16&255,h+=u>>>8&255,f+=255&u,++n);k=0===n?0:(t(v,n)<<16)+(t(h,n)<<8)+t(f,n),y[s*o+a]=k}return e.pop(3),0}function f(){var l,u,c,g,f,S,v,n,o,k,p,h,d,b,y,m;if(v=e.stackValue(2),p=e.stackValue(1),y=e.stackIntegerValue(0),S=i(v),m=r(v),k=i(p),e.success(r(p)===m),e.failed())return null;for(f=0;m-1>=f;f++)h=16777215&S[f],0!==h&&(d=h>>>16&255,c=h>>>8&255,l=255&h,n=o=d,c>n&&(n=c),l>n&&(n=l),o>c&&(o=c),o>l&&(o=l),g=a(d,c,l,o,n),b=0===n?0:t(1e3*(n-o),n),u=t(1e3*n,255),u+=10*y,u>1e3&&(u=1e3),0>u&&(u=0),s(k,f,g,b,u));return e.pop(3),0}function h(){var l,p,s,c,o,u,n,f,a,h,i,d=0,m=0;if(a=e.stackValue(2),s=e.stackValue(1),c=e.stackIntegerValue(0),e.success(e.isWords(a)),e.success(e.isWords(s)),l=t(2*r(a),c),h=2*r(s),e.success(h>=l),e.failed())return null;for(f=a.wordsAsInt16Array(),p=s.wordsAsInt16Array(),o=1;l>=o;o++){for(n=0,u=1;c>=u;u++)i=f[d++],0>i&&(i=0-i),i>n&&(n=i);p[m++]=n}return e.pop(3),0}function p(){var v,l,f,n,m,c,h,u,o,p,d,a,s,r,t;if(h=e.stackValue(7),u=e.stackIntegerValue(6),c=e.stackIntegerValue(5),d=e.stackValue(4),a=e.stackIntegerValue(3),p=e.stackIntegerValue(2),l=e.stackIntegerValue(1),f=e.stackIntegerValue(0),m=i(h),o=i(d),e.success(a>l+2*u),e.success(p>f+2*c),e.failed())return null;for(t=0;c-1>=t;t++)for(v=(f+2*t)*a+l,r=0;u-1>=r;r++)s=m[r+t*u],n=v+2*r,o[n]=s,o[n+1]=s,o[n+a]=s,o[n+a+1]=s;return e.pop(8),0}function w(){var o,t,n,u,l,i,s,a=0,c=0;if(i=e.stackValue(2),t=e.stackValue(1),u=e.booleanValueOf(e.stackValue(0)),e.success(e.isWords(i)),e.success(e.isWords(t)),s=r(i),e.success(r(t)>=s>>1),e.failed())return null;for(l=i.wordsAsInt16Array(),o=t.wordsAsInt16Array(),u&&a++,n=1;s>=n;n++)o[c++]=l[a],a+=2;return e.pop(3),0}function m(){var v,c,a,f,h,o,O,m,F,k,I,S,d,y,b,g,p,n,l,s;if(m=e.stackValue(3),k=e.stackValue(2),n=e.stackIntegerValue(1),S=e.stackIntegerValue(0),O=i(m),F=i(k),p=r(m),e.success(r(k)===p),e.failed())return null;for(o=t(p,n),c=n>>1,a=o>>1,o=t(p,n),c=n>>1,a=o>>1,y=S/100,l=0;n-1>=l;l++)for(s=0;o-1>=s;s++)f=(l-c)/c,h=(s-a)/a,d=Math.pow(Math.sqrt(f*f+h*h),y),1>=d?(v=Math.atan2(h,f),b=1024*(c+d*Math.cos(v)*c)|0,g=1024*(a+d*Math.sin(v)*a)|0):(b=1024*l,g=1024*s),I=u(O,b,g,n,o),F[s*n+l]=I;return e.pop(4),0}function v(){var n,f,k,c,h,p,u,l,y,o,S,b,v,t,s,r,d,m,g,a;if(l=i(e.stackValue(11)),o=e.stackIntegerValue(10),y=e.stackIntegerValue(9),S=i(e.stackValue(8)),v=e.stackIntegerValue(7),b=e.stackIntegerValue(6),d=e.stackIntegerValue(5),m=e.stackIntegerValue(4),h=e.stackIntegerValue(3),p=e.stackIntegerValue(2),c=e.stackIntegerValue(1),f=e.stackIntegerValue(0),e.success(d>=0&&m>=0),e.success(o>=d+2*c),e.success(y>=m+2*f),e.success(h>=0&&p>=0),e.success(v>=h+c),e.success(b>=p+f),e.failed())return null;for(a=0;f-1>=a;a++)for(r=o*(m+2*a)+d,k=v*(p+a)+h,g=0;c-1>=g;g++)t=l[r],s=16711680&t,u=65280&t,n=255&t,t=l[r+1],s+=16711680&t,u+=65280&t,n+=255&t,t=l[r+o],s+=16711680&t,u+=65280&t,n+=255&t,t=l[r+o+1],s+=16711680&t,u+=65280&t,n+=255&t,S[k]=s>>>2&16711680|(u>>>2&65280|n>>>2),r+=2,++k;return e.pop(12),0}function k(){var S,r,d,n,s,a,y,m,b,u,F,g,p,f,h,k,c,l,o,v,t;if(m=i(e.stackValue(11)),u=e.stackIntegerValue(10),b=e.stackIntegerValue(9),F=i(e.stackValue(8)),p=e.stackIntegerValue(7),g=e.stackIntegerValue(6),l=e.stackIntegerValue(5),o=e.stackIntegerValue(4),s=e.stackIntegerValue(3),a=e.stackIntegerValue(2),n=e.stackIntegerValue(1),r=e.stackIntegerValue(0),e.success(l>=0&&o>=0),e.success(u>=l+2*n),e.success(b>=o+2*r),e.success(s>=0&&a>=0),e.success(p>=s+n),e.success(g>=a+r),e.failed())return null;for(t=0;r-1>=t;t++)for(c=u*(o+2*t)+l,d=p*(a+t)+s,v=0;n-1>=v;v++)f=m[c],h=m[c+u+1],k=(16711680&f)+(16711680&h)>>>1&16711680,y=(65280&f)+(65280&h)>>>1&65280,S=(255&f)+(255&h)>>>1,F[d]=k|(y|S),c+=2,++d;return e.pop(12),0}function g(){var f,p,l,m,h,F,k,o,u,y,v,d,b,c,S,g;if(k=e.stackValue(2),v=e.stackValue(1),S=e.stackIntegerValue(0),F=i(k),g=r(k),y=i(v),e.success(r(v)===g),e.failed())return null;for(h=0;g-1>=h;h++)d=16777215&F[h],0!==d&&(b=d>>>16&255,l=d>>>8&255,f=255&d,o=u=b,l>o&&(o=l),f>o&&(o=f),u>l&&(u=l),u>f&&(u=f),p=t(1e3*o,255),c=0===o?0:t(1e3*(o-u),o),110>p&&(p=110,c=1e3),90>c&&(c=90),m=110===p||90===c?0:a(b,l,f,u,o),m=n(m+S+36e7,360),s(y,h,m,c,p));return e.pop(3),0}function b(){var a,n,o,l,s,c,f;return n=e.stackValue(3),s=e.stackIntegerValue(2),c=e.stackIntegerValue(1),f=e.stackIntegerValue(0),a=i(n),l=r(n),e.failed()?null:(o=u(a,c,f,s,t(l,s)),e.pop(5),e.pushInteger(o),0)}function y(){var l,g,c,b,f,S,v,n,u,k,p,h,d,o,y,m;if(v=e.stackValue(2),p=e.stackValue(1),y=e.stackIntegerValue(0),S=i(v),m=r(v),k=i(p),e.success(r(p)===m),e.failed())return null;for(f=0;m-1>=f;f++)h=16777215&S[f],2>h||(d=h>>>16&255,c=h>>>8&255,l=255&h,n=u=d,c>n&&(n=c),l>n&&(n=l),u>c&&(u=c),u>l&&(u=l),g=t(1e3*n,255),o=0===n?0:t(1e3*(n-u),n),o>0&&(b=a(d,c,l,u,n),o+=10*y,o>1e3&&(o=1e3),0>o&&(o=0),s(k,f,b,o,g)));return e.pop(3),0}function S(){var m,y,A,h,o,c,P,S,I,f,d,O,F,s,u,a,l,n,p,b,g,k,v,C,w;if(A=e.stackValue(5),h=e.stackIntegerValue(4),y=e.stackIntegerValue(3),I=e.stackValue(2),d=e.stackIntegerValue(1),S=e.stackIntegerValue(0),e.success(r(A)===h*y),e.success(r(I)===d*S),m=i(A),P=i(I),e.failed())return null;for(o=c=0,C=t(1024*h,d),w=t(1024*y,S),F=0;S-1>=F;F++){for(o=0,O=0;d-1>=O;O++)b=(1024-(1023&o))*(1024-(1023&c)),g=(1023&o)*(1024-(1023&c)),k=(1024-(1023&o))*(1023&c),v=(1023&o)*(1023&c),n=(c>>>10)*h+(o>>>10),s=m[n],u=h-1>o>>>10?m[n+1]:s,y-1>c>>>10&&(n+=h),a=m[n],l=h-1>o>>>10?m[n+1]:a,p=0,0===s&&(s=u,p+=b),0===u&&(u=s,p+=g),0===a&&(a=l,p+=k),0===l&&(l=a,p+=v),0===s&&(s=a,u=l),0===a&&(a=s,l=u),f=0,5e5>p&&(n=b*(s>>>16&255)+g*(u>>>16&255)+k*(a>>>16&255)+v*(l>>>16&255),f=(n>>>20&255)<<16,n=b*(s>>>8&255)+g*(u>>>8&255)+k*(a>>>8&255)+v*(l>>>8&255),f|=(n>>>20&255)<<8,n=b*(255&s)+g*(255&u)+k*(255&a)+v*(255&l),f|=n>>>20&255,0===f&&(f=1)),P[F*d+O]=f,o+=C;c+=w}return e.pop(6),0}function F(){var _,a,x,B,u,D,S,P,y,v,F,k,A,g,b,p,f,I,j,c,O,M,V,C,W,m,q,w,d,N,o,h,s,T,L;if(j=e.stackValue(5),V=e.stackValue(4),s=e.stackIntegerValue(3),I=i(j),M=i(V),x=r(j),q=e.stackIntegerValue(2),_=e.stackValue(1),B=e.stackValue(0),a=l(_),u=l(B),e.success(r(V)===x),e.failed())return null;for(p=t(x,s),d=Math.random(),D=n(d,q)-1,w=0;D/2-1>=w;w++)for(d=Math.random(),T=n(d,s),d=Math.random(),L=n(d,p),d=Math.random(),W=n(d,8),g=-4;4>=g;g++)for(b=-4;4>=b;b++)P=g*g+b*b,25>P&&P>0&&(y=T+g|0,F=L+b|0,y>0&&F>0&&p>F&&s>y&&(a[F*s+y]=W*(1-P/25)));for(A=1;s-2>=A;A++)for(S=1;p-2>=S;S++)o=S*s+A,a[o]=(u[o+1]+u[o-1]+u[o+s]+u[o-s]+u[o-1-s]/2+u[o-1+s]/2+u[o+1-s]/2+u[o+1+s]/2)/4-a[o],a[o]=.9*a[o];for(m=0;s*p>=m;m++)N=u[m],u[m]=a[m],a[m]=N;for(c=0;p-1>=c;c++)for(f=0;s-1>=f;f++)f>1&&s-1>f&&c>1&&p-1>c?(h=c*s+f,v=64*(a[h]-a[h-1]+(a[h+1]-a[h])),k=(a[h]-a[h-s]+(a[h+s]-a[h]))/64,2>v&&(v=-2),v>2&&(v=2),2>k&&(k=-2),k>2&&(k=2),O=(c+k)*s+(f+v)|0,C=s*p>O&&O>=0?I[O]:I[f+c*s]):C=I[f+c*s],M[f+c*s]=C;return e.pop(6),0}function O(){var F,s,n,O,k,w,c,f,y,m,C,v,V,g,A,h,I,d,p,S,b,P,a,l,o;if(v=e.stackValue(3),g=e.stackValue(2),a=e.stackIntegerValue(1),w=e.stackIntegerValue(0),C=i(v),V=i(g),b=r(v),e.success(r(g)===b),e.failed())return null;for(m=t(b,a),s=a>>1,n=m>>1,n>s?(h=s,d=n/s,p=1):(h=n,d=1,p=s>n?s/n:1),P=-3.141592653589793*w/180,I=h*h,l=0;a-1>=l;l++)for(o=0;m-1>=o;o++)c=d*(l-s),f=p*(o-n),k=c*c+f*f,I>k&&(y=1-Math.sqrt(k)/h,F=P*(y*y),S=Math.sin(F),O=Math.cos(F),A=u(C,1024*((O*c-S*f)/d+s)|0,1024*((S*c+O*f)/p+n)|0,a,m),V[a*o+l]=A);return e.pop(4),0}function I(i){var t;return e=i,t=e.majorVersion()==A,t===!1?!1:t=e.minorVersion()>=P}var A=1,P=11,e=null,C="ScratchPlugin 3 November 2014 (e)";Squeak.registerExternalModule("ScratchPlugin",{primitiveCondenseSound:h,getModuleName:d,primitiveFisheye:m,primitiveWaterRipples1:F,primitiveHalfSizeDiagonal:k,primitiveScale:S,primitiveDoubleSize:p,setInterpreter:I,primitiveWhirl:O,primitiveBlur:c,primitiveBrightnessShift:f,primitiveHalfSizeAverage:v,primitiveSaturationShift:y,primitiveHueShift:g,primitiveInterpolate:b,primitiveExtractChannel:w})}),module("users.bert.SqueakJS.plugins.SoundGenerationPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function u(e,t){return 0|Math.floor(e/t)}function t(e,t){return e-u(e,t)*t|0}function h(){return v}function m(){var r,o,d,k,m,f,u,s,i,l,h,a,n,c,v,p,g,b,y;if(r=e.stackValue(3),o=e.stackInt16Array(2),d=e.stackIntegerValue(1),k=e.stackIntegerValue(0),b=e.fetchInt32ArrayofObject(7,r),y=e.fetchInt32ArrayofObject(8,r),g=e.fetchIntegerofObject(9,r),c=e.fetchIntegerofObject(10,r),n=e.fetchIntegerofObject(11,r),v=e.fetchInt16ArrayofObject(12,r),p=e.fetchInt16ArrayofObject(13,r),e.failed())return null;for(l=d;d+k-1>=l;l++){for(m=f=0,a=1;g>=a;a++)u=n-b[a-1],1>u&&(u+=c),h=y[a-1],m+=h*v[u-1],f+=h*p[u-1];s=2*l-1,i=o[s-1]+(m>>15),i>32767&&(i=32767),-32767>i&&(i=-32767),o[s-1]=i,v[n-1]=i,++s,i=o[s-1]+(f>>15),i>32767&&(i=32767),-32767>i&&(i=-32767),o[s-1]=i,p[n-1]=i,n=t(n,c)+1}return e.failed()?null:(e.storeIntegerofObjectwithValue(11,r,n),void e.pop(3))}function n(){var i,k,c,F,y,b,A,l,O,I,r,p,f,d,m,n,v,o,g,a,s,h,u,S;if(i=e.stackValue(5),k=e.stackIntegerValue(4),c=e.stackInt16Array(3),F=e.stackIntegerValue(2),y=e.stackIntegerValue(1),b=e.stackIntegerValue(0),a=e.fetchIntegerofObject(3,i),s=e.fetchIntegerofObject(4,i),h=e.fetchIntegerofObject(5,i),d=e.fetchIntegerofObject(7,i),S=e.fetchInt16ArrayofObject(8,i),u=e.fetchIntegerofObject(9,i),n=e.fetchIntegerofObject(10,i),v=e.fetchIntegerofObject(11,i),m=e.fetchIntegerofObject(14,i),o=e.fetchIntegerofObject(15,i),g=e.fetchIntegerofObject(16,i),e.failed())return null;for(A=0!==m&&0!==g,O=F+k-1,f=F;O>=f;f++)p=a*S[n>>15]>>15,A?(I=m*S[o>>15],o=t(o+g,u),0>o&&(o+=u),n=t(n+v+I,u),0>n&&(n+=u)):n=t(n+v,u),y>0&&(l=2*f-1,r=c[l-1]+(p*y>>15),r>32767&&(r=32767),-32767>r&&(r=-32767),c[l-1]=r),b>0&&(l=2*f,r=c[l-1]+(p*b>>15),r>32767&&(r=32767),-32767>r&&(r=-32767),c[l-1]=r),0!==s&&(a+=s,(s>0&&a>=h||0>s&&h>=a)&&(a=h,s=0));return d-=k,e.failed()?null:(e.storeIntegerofObjectwithValue(3,i,a),e.storeIntegerofObjectwithValue(4,i,s),e.storeIntegerofObjectwithValue(7,i,d),e.storeIntegerofObjectwithValue(10,i,n),e.storeIntegerofObjectwithValue(15,i,o),void e.pop(5))}function s(){var t,I,c,b,m,k,S,F,u,x,q,j,h,v,O,r,s,P,l,A,p,V,C,y,o,w,g,n,a,d;if(t=e.stackValue(5),I=e.stackIntegerValue(4),c=e.stackInt16Array(3),b=e.stackIntegerValue(2),m=e.stackIntegerValue(1),k=e.stackIntegerValue(0),n=e.fetchIntegerofObject(3,t),a=e.fetchIntegerofObject(4,t),d=e.fetchIntegerofObject(5,t),l=e.fetchIntegerofObject(7,t),C=e.fetchIntegerofObject(8,t),p=e.fetchInt16ArrayofObject(10,t),y=e.fetchInt16ArrayofObject(11,t),A=e.fetchIntegerofObject(16,t),V=e.fetchIntegerofObject(17,t),g=e.fetchIntegerofObject(18,t),o=e.fetchIntegerofObject(19,t),w=e.fetchIntegerofObject(20,t),e.failed())return null;for(x=p!==y,S=m*n>>15,F=k*n>>15,u=2*b-1,q=b+I-1,P=b;q>=P;P++){if(s=(o+=w)>>9,s>V&&l>C&&(s=(o-=g)>>9),(v=s+1)>A){if(s>A)return l=0,e.failed()?null:(e.storeIntegerofObjectwithValue(3,t,n),e.storeIntegerofObjectwithValue(4,t,a),e.storeIntegerofObjectwithValue(7,t,l),e.storeIntegerofObjectwithValue(19,t,o),e.popthenPush(6,null),null);v=0===g?s:(o-g>>9)+1}h=o&f,O=j=p[s-1]*(i-h)+p[v-1]*h>>9,x&&(O=y[s-1]*(i-h)+y[v-1]*h>>9),m>0&&(r=c[u-1]+(S*j>>15),r>32767&&(r=32767),-32767>r&&(r=-32767),c[u-1]=r),++u,k>0&&(r=c[u-1]+(F*O>>15),r>32767&&(r=32767),-32767>r&&(r=-32767),c[u-1]=r),++u,0!==a&&(n+=a,(a>0&&n>=d||0>a&&d>=n)&&(n=d,a=0),S=m*n>>15,F=k*n>>15)}return l-=I,e.failed()?null:(e.storeIntegerofObjectwithValue(3,t,n),e.storeIntegerofObjectwithValue(4,t,a),e.storeIntegerofObjectwithValue(7,t,l),e.storeIntegerofObjectwithValue(19,t,o),void e.pop(5))}function a(){var t,m,u,S,d,y,b,a,F,i,k,r,o,l,v,f,h,O,g,s,n,c;if(t=e.stackValue(5),m=e.stackIntegerValue(4),u=e.stackInt16Array(3),S=e.stackIntegerValue(2),d=e.stackIntegerValue(1),y=e.stackIntegerValue(0),s=e.fetchIntegerofObject(3,t),n=e.fetchIntegerofObject(4,t),c=e.fetchIntegerofObject(5,t),v=e.fetchIntegerofObject(7,t),f=e.fetchInt16ArrayofObject(8,t),h=e.fetchIntegerofObject(9,t),O=e.fetchIntegerofObject(10,t),g=e.fetchIntegerofObject(11,t),e.failed())return null;for(F=S+m-1,o=r=h,l=S;F>=l;l++)r=o+O,r>=g&&(r=p+(r-g)),b=f[(o>>15)-1]+f[(r>>15)-1]>>1,f[(o>>15)-1]=b,k=b*s>>15,o=r,d>0&&(a=2*l-1,i=u[a-1]+(k*d>>15),i>32767&&(i=32767),-32767>i&&(i=-32767),u[a-1]=i),y>0&&(a=2*l,i=u[a-1]+(k*y>>15),i>32767&&(i=32767),-32767>i&&(i=-32767),u[a-1]=i),0!==n&&(s+=n,(n>0&&s>=c||0>n&&c>=s)&&(s=c,n=0));return h=r,v-=m,e.failed()?null:(e.storeIntegerofObjectwithValue(3,t,s),e.storeIntegerofObjectwithValue(4,t,n),e.storeIntegerofObjectwithValue(7,t,v),e.storeIntegerofObjectwithValue(9,t,h),void e.pop(5))}function o(){var t,h,o,v,k,b,a,F,l,g,i,p,c,m,u,S,O,y,r,s,n,f;if(t=e.stackValue(5),h=e.stackIntegerValue(4),o=e.stackInt16Array(3),v=e.stackIntegerValue(2),k=e.stackIntegerValue(1),b=e.stackIntegerValue(0),s=e.fetchIntegerofObject(3,t),n=e.fetchIntegerofObject(4,t),f=e.fetchIntegerofObject(5,t),m=e.fetchIntegerofObject(7,t),S=e.fetchInt16ArrayofObject(8,t),O=e.fetchIntegerofObject(10,t),r=e.fetchIntegerofObject(11,t),u=e.fetchIntegerofObject(12,t),y=e.fetchIntegerofObject(13,t),e.failed())return null;for(F=v+h-1,l=v,c=u+(r>>>16);O>=c&&F>=l;)p=S[c-1]*s>>15,k>0&&(a=2*l-1,i=o[a-1]+(p*k>>15),i>32767&&(i=32767),-32767>i&&(i=-32767),o[a-1]=i),b>0&&(a=2*l,i=o[a-1]+(p*b>>15),i>32767&&(i=32767),-32767>i&&(i=-32767),o[a-1]=i),0!==n&&(s+=n,(n>0&&s>=f||0>n&&f>=s)&&(s=f,n=0)),r+=y,r>=d&&(g=r>>>16,u+=g,r-=g<<16),c=u+(r>>>16),++l;return m-=h,e.failed()?null:(e.storeIntegerofObjectwithValue(3,t,s),e.storeIntegerofObjectwithValue(4,t,n),e.storeIntegerofObjectwithValue(7,t,m),e.storeIntegerofObjectwithValue(11,t,r),e.storeIntegerofObjectwithValue(12,t,u),void e.pop(5))}function r(i){var t;return e=i,t=e.majorVersion()==l,t===!1?!1:t=e.minorVersion()>=c}var l=1,c=11,f=511,i=512,p=32768,d=536870912,e=null,v="SoundGenerationPlugin 3 November 2014 (e)";Squeak.registerExternalModule("SoundGenerationPlugin",{primitiveMixFMSound:n,primitiveMixSampledSound:o,setInterpreter:r,getModuleName:h,primitiveApplyReverb:m,primitiveMixPluckedSound:a,primitiveMixLoopedSampledSound:s})}),module("users.bert.SqueakJS.plugins.StarSqueakPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function t(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function r(e,t){return 0|Math.floor(e/t)}function a(t,e){return 0>e?-31>e?0:t>>>0-e:e>31?0:t<<e}function i(t){return e.success(e.isWords(t)),e.failed()?0:t.words}function n(){return f}function s(){var S,s,y,k,h,p,u,b,g,l,d,m,v,n,o,f,a,c;if(l=e.stackValue(4),k=e.stackValue(3),n=e.stackIntegerValue(2),u=e.stackIntegerValue(1),s=e.stackIntegerValue(0),g=i(l),y=i(k),e.success(t(l)===t(k)),e.success(t(l)===n*u),e.failed())return null;for(S=(2*s+1)*(2*s+1),a=0;u-1>=a;a++)for(m=a-s,0>m&&(m=0),p=a+s,p>=u&&(p=u-1),o=0;n-1>=o;o++){for(d=o-s,0>d&&(d=0),h=o+s,h>=n&&(h=n-1),v=0,c=m;p>=c;c++)for(b=c*n,f=d;h>=f;f++)v+=g[b+f];y[a*n+o]=r(v,S)}e.pop(5)}function h(){var r,n,s,a,o;if(s=e.stackValue(1),a=e.stackIntegerValue(0),n=i(s),o=t(s),e.failed())return null;for(r=0;o-1>=r;r++)n[r]=n[r]*a>>>10;e.pop(2)}function o(){var F,d,c,k,u,v,n,g,p,o,l,b,y,S,m,s,f,h;if(m=e.stackValue(6),c=e.stackValue(5),s=e.stackIntegerValue(4),k=e.stackIntegerValue(3),n=e.stackIntegerValue(2),p=e.stackIntegerValue(1),b=e.stackIntegerValue(0),y=i(m),F=i(c),e.success(t(c)===s*k),e.success(t(c)===t(m)*n*n),e.failed())return null;for(o=0,(4&p)>0&&(o+=65536),(2&p)>0&&(o+=256),(1&p)>0&&++o,S=-1,h=0;h<=r(k,n)-1;h++)for(f=0;f<=r(s,n)-1;f++)for(u=a(y[++S],b),u>255&&(u=255),g=0>=u?1:u*o,v=(h*s+f)*n,l=v;v+(n-1)*s>=l;l+=s)for(d=l;l+n-1>=d;d++)F[d]=g;e.pop(7)}function u(i){var t;return e=i,t=e.majorVersion()==l,t===!1?!1:t=e.minorVersion()>=c}var l=1,c=11,e=null,f="StarSqueakPlugin 3 November 2014 (e)";
Squeak.registerExternalModule("StarSqueakPlugin",{primitiveDiffuseFromToWidthHeightDelta:s,primitiveEvaporateRate:h,setInterpreter:u,primitiveMapFromToWidthHeightPatchSizeRgbFlagsShift:o,getModuleName:n})}),module("users.bert.SqueakJS.plugins.ZipPlugin").requires("users.bert.SqueakJS.vm").toRun(function(){function M(t){return"number"==typeof t?e.classSmallInteger():t.sqClass}function i(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function k(e){return e.bytes?e.bytes.length:e.words?4*e.words.length:0}function Pe(e,t){return 0|Math.floor(e/t)}function J(e,t){return e-Pe(e,t)*t|0}function S(t,e){return e>31?0:t<<e}function Oe(t,e){return e>31?0:t>>>e}function Fe(t,i,n){var e;if(r[t+n]!==r[i+n])return 0;if(r[t+n-1]!==r[i+n-1])return 0;if(r[t]!==r[i])return 0;if(r[t+1]!==r[i+1])return 1;for(e=2;V>e&&r[t+e]===r[i+e];)++e;return e}function ye(l,h,p){var n,a,e,t,o,f,i,u,d;if(m>l)return!1;if(s>=v)return!0;for(a=!1,e=m;l>=e;){if(a||(i=R(e,c-1,e,h,p),j(e),o=65535&i,t=i>>>16),i=R(e+1,t,o,h,p),d=65535&i,u=i>>>16,t>=u&&t>=c){for(n=ve(t,e-o),f=1;t-1>=f;f++)j(++e);a=!1,++e}else n=ke(r[e]),++e,l>=e&&!n&&(j(e),a=!0,o=d,t=u);if(n)return m=e,!0}return m=e,!1}function be(t){var e;for(e=M(t);!e.isNil&&e.classInstSize()>=13;)e=e.superclass();return e.isNil?!1:(n=e.classInstSize(),!0)}function z(i){var e;for(e=M(i);!e.isNil&&e.classInstSize()>=7;)e=e.superclass();return e.isNil?!1:(t=e.classInstSize(),!0)}function ke(e){return C[s]=e,I[s]=0,A[e]++,++s,s===v||0===(4095&s)&&W()}function ve(t,e){var i,r;return C[s]=t-c,I[s]=e,r=G[t-c],A[r]++,i=257>e?b[e-1]:b[256+(e-1>>>7)],q[i]++,++s,++h,s===v||0===(4095&s)&&W()}function R(e,s,p,h,f){var n,u,a,r,o,i,t;if(t=s<<16|p,s>=V)return t;if(i=y[B(e+c-1)],a=e-i,!(a>0&&F>a))return t;for(u=h,o=e>F?e-F:0,n=s;;){if(r=Fe(e,i,n),e+r>l&&(r=l-e),r===c&&e-i>F>>2&&(r=c-1),r>n){if(t=r<<16|i,n=r,n>=V)return t;if(n>f)return t}if(!(--u>0))return t;if(i=w[i&N],o>=i)return t}}function he(){return Ae}function j(e){var t;d=B(e+c-1),t=y[d],y[d]=e,w[e&N]=t}function fe(a){var n;if(!(e.isPointers(a)&&i(a)>=15))return!1;if(n=e.fetchPointerofObject(0,a),!e.isBytes(n))return!1;if(0===t){if(!z(a))return!1;if(i(a)<t+5)return t=0,!1}return r=n.bytes,p=k(n),l=e.fetchIntegerofObject(1,a),u=e.fetchIntegerofObject(2,a),n=e.fetchPointerofObject(t+0,a),e.isWords(n)&&i(n)===ge?(y=n.words,n=e.fetchPointerofObject(t+1,a),e.isWords(n)&&i(n)===me?(w=n.words,d=e.fetchIntegerofObject(t+2,a),m=e.fetchIntegerofObject(t+3,a),n=e.fetchPointerofObject(t+5,a),e.isBytes(n)?(v=i(n),C=n.bytes,n=e.fetchPointerofObject(t+6,a),e.isWords(n)&&i(n)>=v?(I=n.words,n=e.fetchPointerofObject(t+7,a),e.isWords(n)&&i(n)===se?(A=n.words,n=e.fetchPointerofObject(t+8,a),e.isWords(n)&&i(n)===ne?(q=n.words,s=e.fetchIntegerofObject(t+9,a),h=e.fetchIntegerofObject(t+10,a),!e.failed()):!1):!1):!1):!1):!1):!1}function ue(n){var s;if(0===t){if(!z(n))return!1;if(i(n)<t+3)return t=0,!1}return e.isPointers(n)&&i(n)>=t+3?(s=e.fetchPointerofObject(0,n),e.isBytes(s)?(r=s.bytes,p=k(s),l=e.fetchIntegerofObject(1,n),u=e.fetchIntegerofObject(2,n),o=e.fetchIntegerofObject(t+1,n),a=e.fetchIntegerofObject(t+2,n),!e.failed()):e.primitiveFail()):!1}function g(i,t){if(!(t>=0&&S(1,i)>t))return e.primitiveFail();for(o|=S(t,a),a+=i;a>=8&&p>l;)r[l]=255&o,++l,o>>>=8,a-=8}function ae(){var r,n,a,i,o;return 3!==e.methodArgumentCount()?e.primitiveFail():(n=e.stackIntegerValue(0),r=e.stackIntegerValue(1),a=e.stackIntegerValue(2),i=e.stackObjectValue(3),e.failed()?null:fe(i)?(o=ye(a,r,n),e.failed()||(e.storeIntegerofObjectwithValue(t+2,i,d),e.storeIntegerofObjectwithValue(t+3,i,m),e.storeIntegerofObjectwithValue(t+9,i,s),e.storeIntegerofObjectwithValue(t+10,i,h)),void(e.failed()||(e.pop(4),e.pushBool(o)))):e.primitiveFail())}function ie(){var s,a,t,r,n,o;if(2!==e.methodArgumentCount())return e.primitiveFail();if(s=e.stackIntegerValue(0),r=e.stackObjectValue(1),e.failed())return null;if(!e.isWords(r))return e.primitiveFail();for(o=i(r),n=r.wordsAsInt32Array(),t=0;o-1>=t;t++)a=n[t],a>=s?n[t]=a-s:n[t]=0;e.pop(2)}function te(){var s,t;if(2!==e.methodArgumentCount())return e.primitiveFail();if(s=e.stackValue(0),!e.isWords(s))return e.primitiveFail();if(D=s.words,T=i(s),s=e.stackValue(1),!e.isWords(s))return e.primitiveFail();if(E=s.words,K=i(s),t=e.stackValue(2),!e.isPointers(t))return e.primitiveFail();if(0===n){if(!be(t))return e.primitiveFail();if(i(t)<n+8)return n=0,e.primitiveFail()}return i(t)<n+8?e.primitiveFail():(u=e.fetchIntegerofObject(2,t),O=e.fetchIntegerofObject(n+0,t),o=e.fetchIntegerofObject(n+1,t),a=e.fetchIntegerofObject(n+2,t),f=e.fetchIntegerofObject(n+4,t),P=e.fetchIntegerofObject(n+5,t),e.failed()?null:(--u,--f,--P,s=e.fetchPointerofObject(0,t),e.isBytes(s)?(r=s.bytes,p=k(s),s=e.fetchPointerofObject(n+3,t),e.isBytes(s)?(U=s.bytes,Ie(),void(e.failed()||(e.storeIntegerofObjectwithValue(2,t,u+1),e.storeIntegerofObjectwithValue(n+0,t,O),e.storeIntegerofObjectwithValue(n+1,t,o),e.storeIntegerofObjectwithValue(n+2,t,a),e.storeIntegerofObjectwithValue(n+4,t,f+1),e.pop(2)))):e.primitiveFail()):e.primitiveFail()))}function ee(){var t,u,l,s,a,c,i,o,r,n;if(4!==e.methodArgumentCount())return e.primitiveFail();if(s=e.stackObjectValue(0),n=e.stackIntegerValue(1),r=e.stackIntegerValue(2),t=e.positive32BitValueOf(e.stackValue(3)),e.failed())return 0;if(!(e.isBytes(s)&&n>=r&&r>0))return e.primitiveFail();if(c=k(s),!(c>=n))return e.primitiveFail();for(l=s.bytes,--r,--n,i=65535&t,o=t>>>16&65535,a=r;n>=a;a++)u=l[a],i=J(i+u,65521),o=J(o+i,65521);t=(o<<16)+i,e.popthenPush(5,e.positive32BitIntegerFor(t))}function $(){var a,n,t,s,o,i,r;if(4!==e.methodArgumentCount())return e.primitiveFail();if(n=e.stackObjectValue(0),r=e.stackIntegerValue(1),i=e.stackIntegerValue(2),t=e.positive32BitValueOf(e.stackValue(3)),e.failed())return 0;if(!(e.isBytes(n)&&r>=i&&i>0))return e.primitiveFail();if(o=k(n),!(o>=r))return e.primitiveFail();for(a=n.bytes,--i,--r,s=i;r>=s;s++)t=Ce[255&(t^a[s])]^t>>>8;e.popthenPush(5,e.positive32BitIntegerFor(t))}function Q(){var r,s,u,c,t,f;return 4!==e.methodArgumentCount()?e.primitiveFail():(s=e.stackObjectValue(0),c=e.stackObjectValue(1),r=e.stackObjectValue(2),u=e.stackObjectValue(3),t=e.stackObjectValue(4),e.failed()?null:ue(t)&&e.isPointers(s)&&i(s)>=2&&e.isPointers(c)&&i(c)>=2&&e.isPointers(u)&&i(u)>=3&&e.isPointers(r)&&i(r)>=3?(f=X(u,r,c,s),e.failed()||(e.storeIntegerofObjectwithValue(1,t,l),e.storeIntegerofObjectwithValue(n+1,t,o),e.storeIntegerofObjectwithValue(n+2,t,a)),void(e.failed()||(e.pop(5),e.pushInteger(f)))):e.primitiveFail())}function X(h,d,P,O){var r,s,C,A,S,F,o,a,I,m,u,n,y,v,t,f;if(t=e.fetchPointerofObject(0,h),n=e.fetchIntegerofObject(1,h),u=e.fetchIntegerofObject(2,h),!(u>=n&&e.isBytes(t)&&u<=k(t)))return e.primitiveFail();if(I=t.bytes,t=e.fetchPointerofObject(0,d),!(e.isWords(t)&&u<=i(t)&&e.fetchIntegerofObject(1,d)===n&&e.fetchIntegerofObject(2,d)===u))return e.primitiveFail();if(C=t.words,t=e.fetchPointerofObject(0,P),!e.isWords(t))return e.primitiveFail();if(m=i(t),y=t.words,t=e.fetchPointerofObject(1,P),!e.isWords(t)||m!==i(t))return e.primitiveFail();if(v=t.words,t=e.fetchPointerofObject(0,O),!e.isWords(t))return e.primitiveFail();if(S=i(t),A=t.words,t=e.fetchPointerofObject(1,O),!e.isWords(t)||S!==i(t))return e.primitiveFail();for(F=t.words,g(0,0),f=0;u>n&&p>l+4;)if(a=I[n],s=C[n],++n,0===s){if(++f,!(m>a))return e.primitiveFail();g(y[a],v[a])}else{if(f=f+a+c,!(256>a))return e.primitiveFail();if(r=G[a],!(m>r))return e.primitiveFail();if(g(y[r],v[r]),o=ce[r-257],0!==o&&(a-=Z[r-257],g(o,a)),--s,!(32768>s))return e.primitiveFail();if(r=256>s?b[s]:b[256+(s>>>7)],!(S>r))return e.primitiveFail();g(A[r],F[r]),o=le[r],0!==o&&(s-=Y[r],g(o,s))}return e.failed()?null:(e.storeIntegerofObjectwithValue(1,h,n),e.storeIntegerofObjectwithValue(1,d,n),f)}function H(i){var t;return e=i,t=e.majorVersion()==re,t===!1?!1:t=e.minorVersion()>=oe}function W(){var e;return s===v?!0:0!==(4095&s)?!1:s>=10*h?!1:(e=s-h,h>=e?!1:h>=4*e)}function pe(e){return(d<<5^e)&de}function B(e){return pe(r[e])}function L(s,o){var a,t,r,n,i;if(t=s[0]>>>24,t>_)return e.primitiveFail(),0;for(n=2;;){if(a=x(t),r=n+a-1,r>=o)return e.primitiveFail(),0;if(i=s[r],0===(1056964608&i))return i;if(n=65535&i,t=i>>>24&255,t>_)return e.primitiveFail(),0}return 0}function Ie(){var s,c,t,i,n,l,h,d,m,v,e;for(l=p-1;l>u&&P>=f;)if(d=o,h=a,m=f,e=L(E,K),256>e)r[++u]=e;else{if(256===e)return O&=Se,0;if(t=(e>>>16)-1,n=65535&e,t>0&&(n+=x(t)),e=L(D,T),t=e>>>16,s=65535&e,t>0&&(s+=x(t)),u+n>=l)return o=d,a=h,f=m,0;for(c=u,v=u-s,i=1;n>=i;i++)r[c+i]=r[v+i];u+=n}}function x(e){for(var t,i;e>a;)i=U[++f],o+=S(i,a),a+=8;return t=o&S(1,e)-1,o=Oe(o,e),a-=e,t}var re=1,oe=11,de=32767,ge=32768,F=32768,ne=30,se=286,V=258,c=3,N=32767,me=32768,_=16,Se=1,e=null,Ae="ZipPlugin 3 November 2014 (e)",n=0,t=0,Y=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],Z=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],o=0,a=0,m=0,r=null,p=0,Ce=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],D=null,T=0,b=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],q=null,I=null,le=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ce=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],y=null,w=null,d=0,E=null,K=0,s=0,A=null,v=0,C=null,h=0,G=[257,258,259,260,261,262,263,264,265,265,266,266,267,267,268,268,269,269,269,269,270,270,270,270,271,271,271,271,272,272,272,272,273,273,273,273,273,273,273,273,274,274,274,274,274,274,274,274,275,275,275,275,275,275,275,275,276,276,276,276,276,276,276,276,277,277,277,277,277,277,277,277,277,277,277,277,277,277,277,277,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284],l=0,u=0,U=null,P=0,f=0,O=0;Squeak.registerExternalModule("ZipPlugin",{primitiveZipSendBlock:Q,primitiveUpdateAdler32:ee,primitiveUpdateGZipCrc32:$,primitiveDeflateUpdateHashTable:ie,setInterpreter:H,getModuleName:he,primitiveDeflateBlock:ae,primitiveInflateDecompressBlock:te})});var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var n,i,r,u,l,a,s,o="",t=0;for(e=LZString.compress(e);t<2*e.length;)t%2==0?(n=e.charCodeAt(t/2)>>8,i=255&e.charCodeAt(t/2),r=t/2+1<e.length?e.charCodeAt(t/2+1)>>8:NaN):(n=255&e.charCodeAt((t-1)/2),(t+1)/2<e.length?(i=e.charCodeAt((t+1)/2)>>8,r=255&e.charCodeAt((t+1)/2)):i=r=NaN),t+=3,u=n>>2,l=(3&n)<<4|i>>4,a=(15&i)<<2|r>>6,s=63&r,isNaN(i)?a=s=64:isNaN(r)&&(s=64),o=o+LZString._keyStr.charAt(u)+LZString._keyStr.charAt(l)+LZString._keyStr.charAt(a)+LZString._keyStr.charAt(s);return o},decompressFromBase64:function(e){if(null==e)return"";var t,a,o,u,h,c,r,n,s="",f=0,i=0,l=LZString._f;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<e.length;)h=LZString._keyStr.indexOf(e.charAt(i++)),c=LZString._keyStr.indexOf(e.charAt(i++)),r=LZString._keyStr.indexOf(e.charAt(i++)),n=LZString._keyStr.indexOf(e.charAt(i++)),a=h<<2|c>>4,o=(15&c)<<4|r>>2,u=(3&r)<<6|n,f%2==0?(t=a<<8,64!=r&&(s+=l(t|o)),64!=n&&(t=u<<8)):(s+=l(t|a),64!=r&&(t=o<<8),64!=n&&(s+=l(t|u))),f+=3;return LZString.decompress(s)},compressToUTF16:function(n){if(null==n)return"";var s,e,t,i="",a=0,r=LZString._f;for(n=LZString.compress(n),s=0;s<n.length;s++)switch(e=n.charCodeAt(s),a++){case 0:i+=r((e>>1)+32),t=(1&e)<<14;break;case 1:i+=r(t+(e>>2)+32),t=(3&e)<<13;break;case 2:i+=r(t+(e>>3)+32),t=(7&e)<<12;break;case 3:i+=r(t+(e>>4)+32),t=(15&e)<<11;break;case 4:i+=r(t+(e>>5)+32),t=(31&e)<<10;break;case 5:i+=r(t+(e>>6)+32),t=(63&e)<<9;break;case 6:i+=r(t+(e>>7)+32),t=(127&e)<<8;break;case 7:i+=r(t+(e>>8)+32),t=(255&e)<<7;break;case 8:i+=r(t+(e>>9)+32),t=(511&e)<<6;break;case 9:i+=r(t+(e>>10)+32),t=(1023&e)<<5;break;case 10:i+=r(t+(e>>11)+32),t=(2047&e)<<4;break;case 11:i+=r(t+(e>>12)+32),t=(4095&e)<<3;break;case 12:i+=r(t+(e>>13)+32),t=(8191&e)<<2;break;case 13:i+=r(t+(e>>14)+32),t=(16383&e)<<1;break;case 14:i+=r(t+(e>>15)+32,(32767&e)+32),a=0}return i+r(t+32)},decompressFromUTF16:function(n){if(null==n)return"";for(var t,e,i="",a=0,s=0,r=LZString._f;s<n.length;){switch(e=n.charCodeAt(s)-32,a++){case 0:t=e<<1;break;case 1:i+=r(t|e>>14),t=(16383&e)<<2;break;case 2:i+=r(t|e>>13),t=(8191&e)<<3;break;case 3:i+=r(t|e>>12),t=(4095&e)<<4;break;case 4:i+=r(t|e>>11),t=(2047&e)<<5;break;case 5:i+=r(t|e>>10),t=(1023&e)<<6;break;case 6:i+=r(t|e>>9),t=(511&e)<<7;break;case 7:i+=r(t|e>>8),t=(255&e)<<8;break;case 8:i+=r(t|e>>7),t=(127&e)<<9;break;case 9:i+=r(t|e>>6),t=(63&e)<<10;break;case 10:i+=r(t|e>>5),t=(31&e)<<11;break;case 11:i+=r(t|e>>4),t=(15&e)<<12;break;case 12:i+=r(t|e>>3),t=(7&e)<<13;break;case 13:i+=r(t|e>>2),t=(3&e)<<14;break;case 14:i+=r(t|e>>1),t=(1&e)<<15;break;case 15:i+=r(t|e),a=0}s++}return LZString.decompress(i)},compress:function(d){if(null==d)return"";var i,r,p,c={},f={},l="",h="",n="",o=2,m=3,s=2,a="",e=0,t=0,u=LZString._f;for(p=0;p<d.length;p+=1)if(l=d.charAt(p),Object.prototype.hasOwnProperty.call(c,l)||(c[l]=m++,f[l]=!0),h=n+l,Object.prototype.hasOwnProperty.call(c,h))n=h;else{if(Object.prototype.hasOwnProperty.call(f,n)){if(n.charCodeAt(0)<256){for(i=0;s>i;i++)e<<=1,15==t?(t=0,a+=u(e),e=0):t++;for(r=n.charCodeAt(0),i=0;8>i;i++)e=e<<1|1&r,15==t?(t=0,a+=u(e),e=0):t++,r>>=1}else{for(r=1,i=0;s>i;i++)e=e<<1|r,15==t?(t=0,a+=u(e),e=0):t++,r=0;for(r=n.charCodeAt(0),i=0;16>i;i++)e=e<<1|1&r,15==t?(t=0,a+=u(e),e=0):t++,r>>=1}o--,0==o&&(o=Math.pow(2,s),s++),delete f[n]}else for(r=c[n],i=0;s>i;i++)e=e<<1|1&r,15==t?(t=0,a+=u(e),e=0):t++,r>>=1;o--,0==o&&(o=Math.pow(2,s),s++),c[h]=m++,n=String(l)}if(""!==n){if(Object.prototype.hasOwnProperty.call(f,n)){if(n.charCodeAt(0)<256){for(i=0;s>i;i++)e<<=1,15==t?(t=0,a+=u(e),e=0):t++;for(r=n.charCodeAt(0),i=0;8>i;i++)e=e<<1|1&r,15==t?(t=0,a+=u(e),e=0):t++,r>>=1}else{for(r=1,i=0;s>i;i++)e=e<<1|r,15==t?(t=0,a+=u(e),e=0):t++,r=0;for(r=n.charCodeAt(0),i=0;16>i;i++)e=e<<1|1&r,15==t?(t=0,a+=u(e),e=0):t++,r>>=1}o--,0==o&&(o=Math.pow(2,s),s++),delete f[n]}else for(r=c[n],i=0;s>i;i++)e=e<<1|1&r,15==t?(t=0,a+=u(e),e=0):t++,r>>=1;o--,0==o&&(o=Math.pow(2,s),s++)}for(r=2,i=0;s>i;i++)e=e<<1|1&r,15==t?(t=0,a+=u(e),e=0):t++,r>>=1;for(;;){if(e<<=1,15==t){a+=u(e);break}t++}return a},decompress:function(d){if(null==d)return"";if(""==d)return null;var v,f,l,i,n,r,t,s,a=[],o=4,u=4,h=3,c="",m="",p=LZString._f,e={string:d,val:d.charCodeAt(0),position:32768,index:1};for(f=0;3>f;f+=1)a[f]=f;for(i=0,r=Math.pow(2,2),t=1;t!=r;)n=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),i|=(n>0?1:0)*t,t<<=1;switch(v=i){case 0:for(i=0,r=Math.pow(2,8),t=1;t!=r;)n=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),i|=(n>0?1:0)*t,t<<=1;s=p(i);break;case 1:for(i=0,r=Math.pow(2,16),t=1;t!=r;)n=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),i|=(n>0?1:0)*t,t<<=1;s=p(i);break;case 2:return""}for(a[3]=s,l=m=s;;){if(e.index>e.string.length)return"";for(i=0,r=Math.pow(2,h),t=1;t!=r;)n=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),i|=(n>0?1:0)*t,t<<=1;switch(s=i){case 0:for(i=0,r=Math.pow(2,8),t=1;t!=r;)n=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),i|=(n>0?1:0)*t,t<<=1;a[u++]=p(i),s=u-1,o--;break;case 1:for(i=0,r=Math.pow(2,16),t=1;t!=r;)n=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),i|=(n>0?1:0)*t,t<<=1;a[u++]=p(i),s=u-1,o--;break;case 2:return m}if(0==o&&(o=Math.pow(2,h),h++),a[s])c=a[s];else{if(s!==u)return null;c=l+l.charAt(0)}m+=c,a[u++]=l+c.charAt(0),o--,l=c,0==o&&(o=Math.pow(2,h),h++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=LZString);
//# sourceMappingURL=squeak.min.js.map